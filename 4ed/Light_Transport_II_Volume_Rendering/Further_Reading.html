
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="icon" href="/favicon.ico?v=2" /> <!-- force refresh -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="../pbrstyle.css">
  <link rel="stylesheet" href="/fontawesome-free-5.15.3-web/css/all.css">

<script async src="https://cse.google.com/cse.js?cx=22a43cef261a245ea"></script>  <script src="/react.min.js"></script>
  <script src="/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/bootstrap.min.css">

  <title>Further Reading</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand bg-light navbar-light">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Light_Transport_II_Volume_Rendering.html">Light Transport II: Volume Rendering</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">Further Reading</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Light_Transport_II_Volume_Rendering/Scattering_from_Layered_Materials.html">(Previous: Scattering from Layered Materials)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<h2>Further Reading</h2><p>


</p>
<p>Lommel (<a href="#cite:Lommel1889">1889</a>) first derived the equation of transfer.  Not
only did he derive this equation, but he also solved it in some
simplified cases in order to estimate reflection functions from real-world
surfaces (including marble and paper), and he compared his solutions to
measured reflectance data from these surfaces.  The equation of transfer
was independently found by Khvolson (<a href="#cite:Khvolson1890">1890</a>) soon
afterward; see Mishchenko (<a href="#cite:Mishchenko2013">2013</a>) for a history of
early work in the area.

</p>
<p>Seemingly unaware of Lommel&rsquo;s work, Schuster (<a href="#cite:Schuster05">1905</a>) was
the next researcher in radiative transfer to consider the effect of
multiple scattering.  He used the term <em>self-illumination</em> to describe
the fact that each part of the medium is illuminated by every other part of
the medium, and he derived differential equations that described reflection
from a slab along the normal direction, assuming the presence of isotropic
scattering. The conceptual framework that he developed remains essentially
unchanged in the field of radiative transfer.

</p>
<p>Soon thereafter, Schwarzschild (<a href="#cite:Schwarzschild06">1906</a>) introduced the
concept of radiative equilibrium, and Jackson (<a href="#cite:Jackson10">1910</a>)
expressed Schuster&rsquo;s equation in integral form, also noting that &ldquo;the
obvious physical mode of solution is Liouville&rsquo;s method of successive
substitutions&rdquo; (i.e., a Neumann series solution).  Finally, King
(<a href="#cite:King13">1913</a>) completed the rediscovery of the equation of transfer
by expressing it in the general integral form.  

</p>
<p>Books by Chandrasekhar (<a href="#cite:Chandrasekhar60">1960</a>), Preisendorfer
(<a href="#cite:Preisendorfer65">1965</a>, <a href="#cite:Preisendorfer76">1976</a>), and van de Hulst
(<a href="#cite:vanDeHulst80">1980</a>) cover volume light transport in depth.  D&rsquo;Eon&rsquo;s
book (<a href="#cite:dEon2016">2016</a>) extensively discusses scattering problems,
including both analytic and Monte Carlo solutions, and contains many
references to related work in other fields.

</p>
<p>The equation of transfer was introduced to graphics by Kajiya and Von
Herzen (<a href="#cite:Kajiya84">1984</a>).  Arvo (<a href="#cite:Arvo93a">1993</a>) made essential
connections between previous formalizations of light transport in graphics
and the equation of transfer as well as to the field of radiative transfer in general.
Pauly et&nbsp;al. (<a href="#cite:Pauly00">2000</a>) derived the generalization
of the path integral form of the light transport equation for the
volume-scattering case; see also Chapter 3 of Jakob&rsquo;s Ph.D.&nbsp;thesis
(<a href="#cite:Jakob2013">2013</a>) for a full derivation.

</p>
<p>
The integral null-scattering volume light transport equation was derived by
Galtier et&nbsp;al. (<a href="#cite:Galtier2013">2013</a>) in the field of radiative transfer;

Eymet et&nbsp;al. (<a href="#cite:Eymet2013">2013</a>) described the generalization to include
scattering from surfaces.  This approach was introduced to graphics by
Nov&aacute;k et&nbsp;al. (<a href="#cite:Novak2014">2014</a>).  Miller
et&nbsp;al. (<a href="#cite:Miller2019">2019</a>) derived its path integral form, which made
it possible to apply powerful variance reduction techniques based on
multiple importance sampling.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x3-VolumetricPathTracing"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x3-VolumetricPathTracing"></span><h4>Volumetric Path Tracing</h4><p>


</p>
<p>von Neumann&rsquo;s original description of the Monte Carlo algorithm was in the
context of neutron transport problems (<a href="#cite:Ulam1947">Ulam et al. 1947</a>); his technique
included the algorithm for sampling distances from an exponential
distribution (our Equation&nbsp;(<a href="../Sampling_Algorithms/Sampling_1D_Functions.html#eq:exponential-sampling-distance">A.17</a>)),
uniformly sampling 3D directions via uniform sampling of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg> (as
implemented in <a href="../Sampling_Algorithms/Sampling_Multidimensional_Functions.html#SampleUniformSphere"><tt>SampleUniformSphere()</tt></a>), and randomly choosing among
scattering events as described in
Section&nbsp;<a href="../Light_Transport_II_Volume_Rendering/The_Equation_of_Transfer.html#sec:volumetric-path-tracing-deriv">14.1.2</a>.

</p>
<p>Rushmeier (<a href="#cite:Rushmeier88">1988</a>) was the first to use Monte Carlo to
solve the volumetric light transport equation in a general setting.

</p>
<p>Szirmay-Kalos et&nbsp;al. (<a href="#cite:SzirmayKalos05">2005</a>) precomputed interactions
between sample points in the medium in order to more quickly compute
multiple scattering.  Kulla and Fajardo (<a href="#cite:Kulla2012">2012</a>) proposed a
specialized sampling technique that is effective for light sources inside
participating media.  (This technique was first introduced in the field of
neutron transport by Kalli and Cashwell (<a href="#cite:Kalli1977">1977</a>).)
Georgiev et&nbsp;al. (<a href="#cite:Georgiev2013">2013</a>) made the
observation that incremental path sampling can generate particularly bad
paths in participating media. They proposed new multi-vertex sampling
methods that better account for all the relevant terms in the equation
of transfer.

</p>
<p>Sampling direct illumination from lights at points inside media surrounded
by an interface is challenging; traditional direct lighting algorithms are
not applicable at points inside the medium, as refraction through the
interface will divert the shadow ray&rsquo;s path.  Walter
et&nbsp;al. (<a href="#cite:Walter2009">2009</a>) considered this problem and developed
algorithms to efficiently find paths to lights accounting for this
refraction.  More recent work on this topic was done by Holzschuch
(<a href="#cite:Holzschuch2015">2015</a>) and Koerner et&nbsp;al. (<a href="#cite:Koerner2016">2016</a>).
Weber et&nbsp;al. (<a href="#cite:Weber2017">2017</a>) developed an approach for more
effectively sampling direct lighting in forward scattering media by
allowing multiple scattering events along the path to the light.

</p>
<p>Szirmay-Kalos
et&nbsp;al. (<a href="#cite:SzirmayKalos2017">2017</a>) first showed the use of the integral
null-scattering volume light transport equation for rendering scattering
inhomogeneous media. Kutz et&nbsp;al. (<a href="#cite:Kutz2017">2017</a>) subsequently applied
it to efficient rendering of spectral media and Szirmay-Kalos
et&nbsp;al. (<a href="#cite:SzirmayKalos2018">2018</a>) developed improved algorithms for
sampling multiple scattering.  After deriving the path integral
formulation, Miller et&nbsp;al. (<a href="#cite:Miller2019">2019</a>) used it to show the effectiveness of combining a
variety of sampling techniques using multiple importance scattering,
including bidirectional path tracing.

</p>
<p>

</p>
<p>The visual appearance of high-albedo objects like clouds is striking, but
many bounces may be necessary for good results.  Wrenninge
et&nbsp;al. (<a href="#cite:Wrenninge2013">2013</a>) described an approximation where after
the first few bounces, the scattering coefficient, the attenuation coefficient
for shadow rays, and the eccentricity of the phase function are all
progressively reduced.

Kallweit
et&nbsp;al. (<a href="#cite:Kallweit2017">2017</a>) applied neural networks to store precomputed
multiple scattering solutions for use in rendering highly scattering
clouds.

</p>
<p>Pegoraro et&nbsp;al. (<a href="#cite:Pegoraro08">2008b</a>) developed a Monte Carlo sampling
approach for rendering participating media that used information from
previous samples to guide future sampling.  More recent work in volumetric
path guiding by Herholz et&nbsp;al. applied product sampling based on the phase
function and an approximation to the light distribution in the medium
(<a href="#cite:Herholz2019">Herholz et al. 2019</a>).  Wrenninge and Villemin (<a href="#cite:Wrenninge2020">2020</a>)
developed a volumetric product sampling approach based on adapting the
majorant to account for important regions of the integrand and then
randomly selecting among candidate samples based on weights that account
for factors beyond transmittance.
Villeneuve et al. (<a href="#cite:Villeneuve2021">2021</a>) have
also developed algorithms for product sampling in media, accounting for the
surface normal at area light sources, transmittance along the ray, and the
phase function.

</p>
<p>Volumetric emission is not handled efficiently by the <a href="../Light_Transport_II_Volume_Rendering/Volume_Scattering_Integrators.html#VolPathIntegrator"><tt>VolPathIntegrator</tt></a>,
as there is no specialized sampling technique to account for it.  Villemin
and Hery (<a href="#cite:Villemin2013">2013</a>) precomputed tabularized CDFs for
sampling volumetric emission, and Simon et&nbsp;al. (<a href="#cite:Simon2017">2017</a>)
developed further improvements, including integrating emission along rays
and using the sampled point in the volume solely to determine the initial
sampling direction, which gives better results in dense media.

</p>
<p>The one-dimensional volumetric light transport algorithms implemented in
<a href="../Light_Transport_II_Volume_Rendering/Scattering_from_Layered_Materials.html#LayeredBxDF"><tt>LayeredBxDF</tt></a> are based on Guo et&nbsp;al.&rsquo;s approach
(<a href="#cite:Guo2018">2018</a>).

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x3-OtherLightTransportAlgorithms"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x3-OtherLightTransportAlgorithms"></span><h4>Other Light Transport Algorithms</h4><p>


</p>
<p>Blinn (<a href="#cite:Blinn82">1982b</a>) first used basic volume scattering algorithms
for computer graphics.  Rushmeier and Torrance (<a href="#cite:Rushmeier87">1987</a>)
used finite-element methods for rendering participating media.  Other early
work in volume scattering for computer graphics includes work by Max
(<a href="#cite:Max86">1986</a>); Nishita, Miyawaki, and Nakamae (<a href="#cite:Nishita87">1987</a>);
Bhate and Tokuta&rsquo;s approach based on spherical harmonics (<a href="#cite:Bhate92">Bhate and Tokuta 1992</a>),
and Blasi et al.&rsquo;s two-pass Monte Carlo algorithm, where the first pass
shoots energy from the lights and stores it in a grid and the second pass
does final rendering using the grid to estimate illumination at points in
the scene (<a href="#cite:Blasi93">Blasi et&nbsp;al. 1993</a>).  Glassner (<a href="#cite:Glassner:PODIS">1995</a>) provided
a thorough overview of this topic and early applications of it in graphics,
and Max&rsquo;s survey article (Max&nbsp;<a href="#cite:Max95">1995</a>) also covers early work
well.  See Cerezo et&nbsp;al. (<a href="#cite:Cerezo05">2005</a>) for an extensive survey of
approaches to rendering participating media up through 2005.

</p>
<p>One important application of volume scattering algorithms in computer
graphics has been simulating atmospheric scattering.  Work in this area
includes early papers by Klassen (<a href="#cite:Klassen87">1987</a>) and Preetham
et&nbsp;al. (<a href="#cite:Preetham99">1999</a>), who introduced a physically rigorous and
computationally efficient atmospheric and sky-lighting model.  Haber
et&nbsp;al.&nbsp;(<a href="#cite:Haber2005">2005</a>) described a model for twilight, and
Ho<span>&#353;</span>ek and Wilkie (<a href="#cite:Hosek2012">2012</a>, <a href="#cite:Hosek2013">2013</a>) developed
a comprehensive model for sky- and sunlight.  Bruneton evaluated the
accuracy and efficiency of a number of models for atmospheric scattering
(<a href="#cite:Bruneton2017">Bruneton 2017</a>).  A sophisticated model that accurately
accounts for polarization, observers at arbitrary altitudes, and the effect of
atmospheric scattering for objects at finite distances was recently
introduced by Wilkie et al. (<a href="#cite:Wilkie2021">2021</a>).

</p>
<p>Jarosz et&nbsp;al. (<a href="#cite:Jarosz:radiancecache">2008a</a>) first extended the
principles of irradiance caching to participating media.  Marco
et&nbsp;al. (<a href="#cite:Marco2018">2018</a>) described a state-of-the-art algorithm for
volumetric radiance caching based on Schwarzhaupt et&nbsp;al.&rsquo;s surface-based
second-order derivatives (<a href="#cite:Schwarzhaupt12">Schwarzhaupt et al. 2012</a>).

</p>
<p>
Jensen and Christensen (<a href="#cite:Jensen98">1998</a>) were the first to generalize
the photon-mapping algorithm to participating media.  Knaus and Zwicker
(<a href="#cite:Knaus2011">2011</a>) showed how to render participating media using
stochastic progressive photon mapping (SPPM).
Jarosz et&nbsp;al. (<a href="#cite:Jarosz08">2008b</a>) had the important insight that
expressing the scattering integral over a beam through the medium as the
measurement to be evaluated could make photon mapping&rsquo;s rate of convergence
much higher than if a series of point photon estimates was instead taken
along each ray.  Section&nbsp;5.6 of Hachisuka&rsquo;s thesis
(<a href="#cite:Hachisuka2011">2011</a>) and Jarosz et&nbsp;al. (<a href="#cite:Jarosz2011a">2011a</a>,
<a href="#cite:Jarosz2011b">2011b</a>) showed how to apply this approach
progressively. For another representation, see Jakob
et&nbsp;al. (<a href="#cite:Jakob2011">2011</a>), who fit a sum of anisotropic Gaussians to
the equilibrium radiance distribution in participating media.

</p>
<p>Many of the other bidirectional light transport algorithms discussed in the
&ldquo;Further Reading&rdquo; section of Chapter&nbsp;<a href="../Light_Transport_I_Surface_Reflection.html#chap:light-transport">13</a> also have
generalizations to account for participating media.  See also Jarosz&rsquo;s
thesis (<a href="#cite:Jarosz2008">2008</a>), which has extensive background on this
topic and includes a number of important contributions.


</p>
<p>

</p>
<p>Some researchers have had success in deriving closed-form expressions
that describe scattering along unoccluded ray segments in participating
media; these approaches can be substantially more efficient than
integrating over a series of point samples.  See Sun
et&nbsp;al. (<a href="#cite:Sun05">2005</a>), Pegoraro and Parker (<a href="#cite:Pegoraro09">2009</a>), and
Pegoraro et&nbsp;al. (<a href="#cite:Pegoraro09etal">2009</a>, <a href="#cite:Pegoraro2010">2010</a>,
<a href="#cite:Pegoraro2011">2011</a>) for examples of such methods.  (Remarkably,
Pegoraro and collaborators&rsquo; work provides a closed-form expression for
scattering from a point light source along a ray passing through
homogeneous participating media with anisotropic phase functions.)

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x3-SubsurfaceScattering"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x3-SubsurfaceScattering"></span><h4>Subsurface Scattering</h4><p>


</p>
<p>Subsurface scattering models based on volumetric light transport were
first introduced to graphics by Hanrahan and
Krueger (<a href="#cite:Hanrahan93">1993</a>), although their approach did not attempt to
simulate light that entered the object at points other than at the point
being shaded.  Dorsey et&nbsp;al. (<a href="#cite:Dorsey99">1999</a>) applied photon maps to
simulating subsurface scattering that did include this effect, and Pharr
and Hanrahan (<a href="#cite:Pharr00">2000</a>) introduced an approach based on computing
BSSRDFs for arbitrary scattering media with an integral over the medium&rsquo;s
depth.

</p>
<p>

</p>
<p>The <em>diffusion approximation</em> has been shown to be an effective way to
model highly scattering media for rendering.  It was first introduced to
graphics by Kajiya and Von Herzen (<a href="#cite:Kajiya84">1984</a>), though Stam
(<a href="#cite:Stam95">1995</a>) was the first to clearly identify many of its
advantages for rendering.

</p>
<p>A solution of the diffusion approximation based on dipoles was developed by
Farrell et&nbsp;al. (<a href="#cite:Farrell92">1992</a>); that approach was applied to BSSRDF
modeling for rendering by Jensen et&nbsp;al. (<a href="#cite:Jensen01">2001b</a>).  Subsequent
work by Jensen and Buhler (<a href="#cite:Jensen02">2002</a>) improved the efficiency of
that method.  A more accurate solution based on <em>photon beam
diffusion</em> was developed by Habel et&nbsp;al. (<a href="#cite:Habel2013">2013</a>).  (The
online edition of this book includes the implementation of a BSSRDF model
based on photon beam diffusion as well as many more references to related
work.)

</p>
<p>

</p>
<p>

</p>
<p>

</p>
<p>
Rendering realistic human skin is a challenging problem; this problem has
driven the development of a number of new methods for rendering subsurface
scattering after the initial dipole work as issues of modeling the layers
of skin and computing more accurate simulations of scattering between
layers have been addressed.  For a good overview of these issues, see
Igarashi et&nbsp;al.&rsquo;s (<a href="#cite:Igarashi07">2007</a>) survey on the scattering
mechanisms inside skin and approaches for measuring and rendering skin.
Notable research in this area includes papers by Donner and Jensen
(<a href="#cite:Donner06a">2006</a>), d&rsquo;Eon et&nbsp;al. (<a href="#cite:dEon07">2007</a>), Ghosh
et&nbsp;al. (<a href="#cite:Ghosh08">2008</a>), and Donner et&nbsp;al. (<a href="#cite:Donner08">2008</a>).
Donner&rsquo;s thesis includes a discussion of the importance of accurate
spectral representations for high-quality skin rendering (Donner
<a href="#cite:DonnerPhD">2006</a>, Section&nbsp;8.5).  See Gitlina
et&nbsp;al. (<a href="#cite:Gitlina2020">2020</a>) for recent work in the measurement of the
scattering properties of skin and fitting it to a BSSRDF model.

</p>
<p>An alternative to BSSRDF-based approaches to subsurface scattering is to
apply the same volumetric Monte Carlo path-tracing techniques that are used
for other scattering media.  This approach is increasingly used in
production (<a href="#cite:Chiang2016:subsurf">Chiang et&nbsp;al. 2016b</a>).  See Wrenninge et
al. (<a href="#cite:Wrenninge2017">2017</a>) for a discussion of such a model designed
for artistic control and expressiveness.

</p>
<p>K<span>&#345;</span>iv&aacute;nek and d&rsquo;Eon introduced the theory of zero-variance random
walks for path-traced subsurface scattering, applying Dwivedi&rsquo;s sampling
technique (<a href="#cite:Dwivedi1982a">1982a</a>; <a href="#cite:Dwivedi1982b">1982b</a>) to guide paths
to stay close to the surface while maintaining an unbiased estimator
(<a href="#cite:Krivanek2014:zerovar">K<span>&#345;</span>iv&aacute;nek and d&rsquo;Eon 2014</a>).  Meng et&nbsp;al. (<a href="#cite:Meng2016">2016</a>) developed
further improvements to this approach, including strategies that handle
back-lit objects more effectively.  More recent work on zero-variance
theory by d&rsquo;Eon and K<span>&#345;</span>iv&aacute;nek (<a href="#cite:dEon2020">2020</a>) includes improved
results with isotropic scattering and new sampling schemes that further
reduce variance.

</p>
<p>Leonard et al. (<a href="#cite:Leonard2021">2021</a>) applied machine learning to subsurface
scattering, training conditional variational auto-encoders to sample
scattering, to model absorption probabilities,
and to sample the positions of ray paths in
spherical regions.  They then used these capabilities to implement an
efficient sphere-tracing algorithm.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x3-Generalizations"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x3-Generalizations"></span><h4>Generalizations</h4><p>


</p>
<p>Moon et&nbsp;al. (<a href="#cite:Moon07">2007</a>) made the important observation that some of
the assumptions underlying the use of the equation of transfer&mdash;that the
scattering particles in the medium are not too close together so that
scattering events can be considered to be statistically
independent&mdash;are not in fact true for interesting scenes that include small
crystals, ice, or piles of many small glass objects.  They developed a new
light transport algorithm for these types of <em>discrete random media</em>
based on composing precomputed scattering solutions.  (See also concurrent
work by Lee and O&rsquo;Sullivan (<a href="#cite:Lee2007">2007</a>) on composing scattering solutions.)
Further work on
rendering such materials was done by M&uuml;ller
et&nbsp;al. (<a href="#cite:Muller2016">2016</a>), Guo et&nbsp;al. (<a href="#cite:Guo2019">2019</a>), and
Zhang and Zhao (<a href="#cite:Zhang2020:multiscale">2020</a>).

</p>
<p><em>Non-exponential</em> media have distributions of interactions that are
not described by an exponential distribution.  They arise from media that
have correlation in the distribution of their particles.  The assumption of
uncorrelated media that we adopted in Chapter&nbsp;<a href="../Volume_Scattering.html#chap:volume-scattering">11</a>
and have used throughout this chapter
can immediately be understood to be at minimum not quite right by
considering the fact that there must be a minimum distance between any two
particles; thus, the distribution cannot be perfectly uncorrelated.  In
practice, media with even more significant correlations are common; a
variety of physical effects that lead to them are described by Bitterli
et&nbsp;al. (<a href="#cite:Bitterli2018">2018b</a>).  Both d&rsquo;Eon (<a href="#cite:dEon2018">2018</a>) and
Jarabo et&nbsp;al. (<a href="#cite:Jarabo2018">2018a</a>) developed generalizations of the
equation of transfer that allow non-exponential media. Bitterli
et&nbsp;al. (<a href="#cite:Bitterli2018">2018b</a>) presented a more general path integral form
of it that maintains reciprocity and allows heterogeneous media.

</p>
<p>Jakob et&nbsp;al. (<a href="#cite:Jakobetal2010">2010</a>) derived a generalized transfer
equation that describes scattering by distributions of oriented
particles. They proposed a <em>microflake</em> scattering model as a specific
example of a particle distribution (where a microflake is the volumetric
analog of a microfacet on a surface) and showed a number of ways of solving
this equation based on Monte Carlo, finite elements, and a dipole
model. More recently, Heitz et&nbsp;al. (<a href="#cite:Heitz2015a">2015</a>) derived a
generalized microflake distribution, which is considerably more efficient
to sample and evaluate. Their model quantifies the local scattering
properties using projected areas observed from different directions, which
adds a well-defined notion of volumetric level of detail.  Zhao
et&nbsp;al. (<a href="#cite:Zhao2016:downsample">2016</a>) and Loubet and Neyret (<a href="#cite:Loubet2018">2018</a>)
developed techniques for downsampling microflake distributions while still
maintaining their visual appearance.

</p>
<p>The equation of transfer assumes that the index of refraction of a medium
will only change at discrete boundaries, though many actual media have
continuously varying indices of refraction.  Ament
et&nbsp;al. (<a href="#cite:Ament2014">2014</a>) derived a variant of the equation of transfer
that allows for this case and applied photon mapping to render images with
it.  Pediredla et&nbsp;al. (<a href="#cite:Pediredla2020">2020</a>) further investigated this
topic and developed an unbiased rendering algorithm for such media based on
path tracing.

</p>
<p>Handling fluorescence in the context of volumetric scattering introduces a
number of complexities discussed by Mojz&iacute;k
et&nbsp;al. (<a href="#cite:Mojzik2018">2018</a>), who also derived a fluorescence-aware
sampling algorithm.

</p>
<p></p>
<h3>References</h3>
<ol style="list-style: none;">
<li class="bibitem" id="cite:Ament2014">Ament, M., C.&nbsp;Bergmann, and D.&nbsp;Weiskopf. 2014.
Refractive radiative transfer equation.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
2014)</em>&nbsp;<em>33</em>&thinsp;(2), 17:1&ndash;22.
</li>

<li class="bibitem" id="cite:Arvo93a">Arvo, J. 1993.
Transfer equations in global illumination.
In <em>Global Illumination, SIGGRAPH &rsquo;93 Course Notes</em>, Volume&nbsp;42,
1:1&ndash;30.
</li>

<li class="bibitem" id="cite:Bhate92">Bhate, N., and A.&nbsp;Tokuta. 1992.
Photorealistic volume rendering of media with directional scattering.
In <em>Proceedings of the Third Eurographics Rendering Workshop</em>,
  227&ndash;45.
</li>

<li class="bibitem" id="cite:Bitterli2018">Bitterli, B., S.&nbsp;Ravichandran, T.&nbsp;M&uuml;ller, M.&nbsp;Wrenninge, J.&nbsp;Nov&aacute;k, S.&nbsp;Marschner, and W.&nbsp;Jarosz. 2018b.
A radiative transfer framework for non-exponential media.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>37</em>&thinsp;(6), 225:1&ndash;17.
</li>

<li class="bibitem" id="cite:Blasi93">Blasi, P., B.&nbsp;L. Sa&euml;c, and C.&nbsp;Schlick. 1993.
A rendering algorithm for discrete volume density objects.
<em>Computer Graphics Forum (Proceedings of Eurographics
  &rsquo;93)</em>&nbsp;<em>12</em>&thinsp;(3), 201&ndash;10.
</li>

<li class="bibitem" id="cite:Blinn82">Blinn, J.&nbsp;F. 1982b.
Light reflection functions for simulation of clouds and dusty
  surfaces.
<em>Computer Graphics</em>&nbsp;<em>16</em>&thinsp;(3), 21&ndash;29.
</li>

<li class="bibitem" id="cite:Bruneton2017">Bruneton, E. 2017.
A qualitative and quantitative evaluation of 8 clear sky models.
<em>IEEE Transactions on Visualization and Computer
Graphics</em>&nbsp;<em>23</em>&thinsp;(12), 2641&ndash;55.
</li>

<li class="bibitem" id="cite:Cerezo05">Cerezo, E., F.&nbsp;Perez-Cazorla, X.&nbsp;Pueyo, F.&nbsp;Seron, and F.&nbsp;Sillion. 2005.
A survey on participating media rendering techniques. 
<em>The Visual Computer</em>&nbsp;<em>21</em>&thinsp;(5), 303&ndash;28.
</li>

<li class="bibitem" id="cite:Chandrasekhar60">Chandrasekhar, S. 1960.
<em>Radiative Transfer</em>.
New York: Dover Publications.
Originally published by Oxford University Press, 1950.
</li>

<li class="bibitem" id="cite:Chiang2016:subsurf">Chiang, M.&nbsp;J.-Y., P.&nbsp;Kutz, and B.&nbsp;Burley. 2016b.
Practical and controllable subsurface scattering for production path tracing.
<em>ACM SIGGRAPH 2016 Talks</em>, 49:1&ndash;2.
</li>

<li class="bibitem" id="cite:dEon2016">d&rsquo;Eon, E. 2016.
<em>A Hitchhiker&rsquo;s Guide to Multiple Scattering</em>.
<a href="http://www.eugenedeon.com/hitchhikers">http://www.eugenedeon.com/hitchhikers</a>.
</li>

<li class="bibitem" id="cite:dEon2018">d&rsquo;Eon, E. 2018.
A reciprocal formulation of non-exponential radiative transfer. 1: Sketch
and motivation.
arXiv:1803.03259 [physics.comp-ph].
</li>

<li class="bibitem" id="cite:dEon2020">d&rsquo;Eon, E., and J.&nbsp;K<span>&#345;</span>iv&aacute;nek. 2020.
Zero-variance theory for efficient subsurface scattering.
<em>SIGGRAPH 2020 Course: Advances in Monte Carlo rendering: The legacy
of Jaroslav K<span>&#345;</span>iv&aacute;nek</em>, 3:1&ndash;366.
</li>

<li class="bibitem" id="cite:dEon07">d&rsquo;Eon, E., D.&nbsp;Luebke, and E.&nbsp;Enderton. 2007.
Efficient rendering of human skin.
In <em>Rendering Techniques 2007: 18th Eurographics Workshop on Rendering</em>,
147&ndash;58.
</li>

<li class="bibitem" id="cite:DonnerPhD">Donner, C. 2006.
Towards realistic image synthesis of scattering materials.
Ph.D. thesis, University of California, San Diego.
</li>

<li class="bibitem" id="cite:Donner06a">Donner, C., and H.&nbsp;W. Jensen. 2006.
A spectral BSSRDF for shading human skin.
<em>Rendering Techniques 2006: 17th Eurographics Workshop on Rendering</em>,
409&ndash;17.
</li>

<li class="bibitem" id="cite:Donner08">Donner, C., T.&nbsp;Weyrich, E.&nbsp;d&rsquo;Eon, R.&nbsp;Ramamoorthi, and S.&nbsp;Rusinkiewicz. 2008.
A layered, heterogeneous reflectance model for acquiring and rendering
human skin.
<em>ACM Transactions on Graphics (Proceedings of ACM SIGGRAPH Asia
2008)</em>&nbsp;<em>27</em>&thinsp;(5), 140:1&ndash;12.
</li>

<li class="bibitem" id="cite:Dorsey99">Dorsey, J., A.&nbsp;Edelman, J.&nbsp;Legakis, H.&nbsp;W. Jensen, and H.&nbsp;K. Pedersen. 1999.
Modeling and rendering of weathered stone.
In <em>Proceedings of SIGGRAPH &rsquo;99</em>, Computer Graphics Proceedings,
  Annual Conference Series, 225&ndash;34.
</li>

<li class="bibitem" id="cite:Dwivedi1982a">Dwivedi, S. 1982a.
A new importance biasing scheme for deep-penetration Monte Carlo.
<em>Annals of Nuclear Energy</em>&nbsp;<em>9</em>&thinsp;(7), 359&ndash;68.
</li>

<li class="bibitem" id="cite:Dwivedi1982b">Dwivedi, S. R. 1982b.
Zero variance biasing schemes for Monte Carlo calculations of neutron and radiation transport.
<em>Nuclear Science and Engineering</em>&nbsp;<em>80</em>&thinsp;(1), 172&ndash;78.
</li>

<li class="bibitem" id="cite:Eymet2013">Eymet, V., D.&nbsp;Poitou, M.&nbsp;Galtier, M.&nbsp;El-Hafi, G.&nbsp;Terr&eacute;e, and
R.&nbsp;Fournier. 2013.
Null-collision meshless Monte-Carlo&mdash;Application to the validation
of fast radiative transfer solvers embedded in combustion
simulators.
<em>Journal of Quantitative Spectroscopy and Radiative
Transfer</em>&nbsp;<em>129</em>, 145&ndash;57.
</li>

<li class="bibitem" id="cite:Farrell92">Farrell, T., M.&nbsp;Patterson, and B.&nbsp;Wilson. 1992.
A diffusion theory model of spatially resolved, steady-state diffuse
reflectance for the noninvasive determination of tissue optical
properties <em>in vivo</em>.
<em>Med. Phys.</em>&nbsp;<em>19</em>&thinsp;(4), 879&ndash;88.
</li>

<li class="bibitem" id="cite:Galtier2013">Galtier, M., S.&nbsp;Blanco, C.&nbsp;Caliot, C.&nbsp;Coustet, J.&nbsp;Dauchet, M.&nbsp;El Hafi,
V.&nbsp;Eymet, R.&nbsp;Fournier, J.&nbsp;Gautrais, A.&nbsp;Khuong, B.&nbsp;Piaud, and
G.&nbsp;Terr&eacute;e. 2013.
Integral formulation of null-collision Monte Carlo algorithms.
<em>Journal of Quantitative Spectroscopy and Radiative
Transfer</em>&nbsp;<em>125</em>, 57&ndash;68.
</li>

<li class="bibitem" id="cite:Gamboa2020">Gamboa, L.&nbsp;E., A.&nbsp;Gruson, and D.&nbsp;Nowrouzezahrai. 2020.
An efficient transport estimator for complex layered materials.
<em>Computer Graphics Forum</em>&nbsp;<em>39</em>&thinsp;(2), 363&ndash;71.
</li>

<li class="bibitem" id="cite:Georgiev2013">Georgiev, I., J.&nbsp;K<span>&#345;</span>iv&aacute;nek, T.&nbsp;Hachisuka, D.&nbsp;Nowrouzezahrai,
and W.&nbsp;Jarosz. 2013.
Joint importance sampling of low-order volumetric scattering.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH Asia
2013)</em>&nbsp;<em>32</em>&thinsp;(6), 164:1&ndash;14.
</li>

<li class="bibitem" id="cite:Ghosh08">Ghosh, A., T.&nbsp;Hawkins, P.&nbsp;Peers, S.&nbsp;Frederiksen, and P.&nbsp;Debevec.  2008.
Practical modeling and acquisition of layered facial reflectance.
<em>ACM Transactions on Graphics (Proceedings of ACM SIGGRAPH Asia
2008)</em>&nbsp;<em>27</em>&thinsp;(5),
139:1&ndash;10.
</li>

<li class="bibitem" id="cite:Gitlina2020">Gitlina, Y., G.&nbsp;C.&nbsp;Guarnera, D.&nbsp;D.&nbsp;Singh, J.&nbsp;Hansen, A.&nbsp;Lattas, D.&nbsp;Pai, and
A.&nbsp;Ghosh. 2020.
Practical measurement and reconstruction of spectral skin reflectance. 
<em>Computer Graphics Forum</em>&nbsp;<em>39</em>&thinsp;(4), 75&ndash;89.
</li>

<li class="bibitem" id="cite:Glassner:PODIS">Glassner, A. 1995.
<em>Principles of Digital Image Synthesis</em>. San Francisco:
Morgan Kaufmann.
</li>

<li class="bibitem" id="cite:Guo2019">Guo, J., Y.&nbsp;Chen, B.&nbsp;Hu, L.-Q.&nbsp;Yan, Y.&nbsp;Guo, and Y.&nbsp;Liu. 2019.
Fractional Gaussian fields for modeling and rendering of spatially-correlated media.
<em>ACM Transactions on Graphics (Proceedings of
SIGGRAPH)</em>&nbsp;<em>38</em>&thinsp;(4), 45:1&ndash;13.
</li>

<li class="bibitem" id="cite:Guo2018">Guo, Y., M.&nbsp;Ha<span>&#353;</span>an, and S.&nbsp;Zhao. 2018.
Position-free Monte Carlo simulation for arbitrary layered BSDFs.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>37</em>&thinsp;(6), 279:1&ndash;14.
</li>

<li class="bibitem" id="cite:Habel2013">Habel, R., P.&nbsp;H.&nbsp;Christensen, and W.&nbsp;Jarosz. 2013.
Photon beam diffusion: A hybrid Monte Carlo method for subsurface scattering.
<em>Computer Graphics Forum (Proceedings of the 2013 Eurographics Symposium on
Rendering)</em>&nbsp;<em>32</em>&thinsp;(4), 27&ndash;37.
</li>

<li class="bibitem" id="cite:Haber2005">Haber, J., M.&nbsp;Magnor, and H.-P.&nbsp;Seidel. 2005.
Physically-based simulation of twilight phenomena.
<em>ACM Transactions on Graphics</em>&nbsp;<em>24</em>&thinsp;(4), 1353&ndash;73.
</li>

<li class="bibitem" id="cite:Hachisuka2011">Hachisuka, T. 2011b.
Robust light transport simulation using progressive density estimation.
Ph.D. thesis, University of California, San Diego.
</li>

<li class="bibitem" id="cite:Hanrahan93">Hanrahan, P., and W.&nbsp;Krueger. 1993.
Reflection from layered surfaces due to subsurface scattering.
<em>Computer Graphics (SIGGRAPH &rsquo;93 Proceedings)</em>, 165&ndash;74.
</li>

<li class="bibitem" id="cite:Heitz2015a">Heitz, E., J.&nbsp;Dupuy, C.&nbsp;Crassin, and C.&nbsp;Dachsbacher. 2015.
The SGGX microflake distribution.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
2015)</em>&nbsp;<em>34</em>&thinsp;(4), 48:1&ndash;11.
</li>

<li class="bibitem" id="cite:Herholz2019">Herholz, S., Y.&nbsp;Zhao, O.&nbsp;Elek, D.&nbsp;Nowrouzezahrai, H.&nbsp;P.&nbsp;A.&nbsp;Lensch, and J.&nbsp;K<span>&#345;</span>iv&aacute;nek. 2019.
Volume path guiding based on zero-variance random walk theory.
<em>ACM Transactions on Graphics (Proceedings of
 SIGGRAPH)</em>&nbsp;<em>38</em>&thinsp;(3), 25:1&ndash;19.
</li>

<li class="bibitem" id="cite:Hosek2012">Ho<span>&#353;</span>ek, L., and A.&nbsp;Wilkie. 2012.
An analytic model for full spectral sky-dome radiance.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH 2012)</em>&nbsp;<em>31</em>&thinsp;(4),
95:1&ndash;9.
</li>

<li class="bibitem" id="cite:Hosek2013">Ho<span>&#353;</span>ek, L., and A.&nbsp;Wilkie. 2013.
Adding a solar-radiance function to the Ho<span>&#353;</span>ek&ndash;Wilkie skylight model.
<em>IEEE Computer Graphics and Applications</em>&nbsp;<em>33</em>&thinsp;(3), 44&ndash;52.
</li>

<li class="bibitem" id="cite:Holzschuch2015">Holzschuch, N. 2015.
Accurate computation of single scattering in participating media with refractive boundaries.
<em>Computer Graphics Forum</em>&nbsp;<em>34</em>&thinsp;(6), 48&ndash;59.
</li>

<li class="bibitem" id="cite:Igarashi07">Igarashi, T., K.&nbsp;Nishino, and S.&nbsp;K. Nayar. 2007.
The appearance of human skin: A survey.
<em>Foundations and Trends in Computer Graphics and Vision</em>&nbsp;<em>3</em>&thinsp;(1), 1&ndash;95.
</li>

<li class="bibitem" id="cite:Jackson10">Jackson, W.&nbsp;H. 1910.
The solution of an integral equation occurring in the theory of
  radiation.
<em>Bulletin of the American Mathematical Society</em>&nbsp;<em>16</em>,
  473&ndash;75.
</li>

<li class="bibitem" id="cite:Jakob2013">Jakob, W. 2013.
Light transport on path-space manifolds.
Ph.D. thesis, Cornell University.
</li>

<li class="bibitem" id="cite:Jakobetal2010">Jakob, W., A.&nbsp;Arbree, J.&nbsp;T.&nbsp;Moon, K.&nbsp;Bala, and M.&nbsp;Steve. 2010.
A radiative transfer framework for rendering materials with anisotropic structure.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH 2010)</em>&nbsp;<em>29</em>&thinsp;(4), 53:1&ndash;13.
</li>

<li class="bibitem" id="cite:Jakob2011">Jakob, W., C.&nbsp;Regg, and W.&nbsp;Jarosz. 2011.
Progressive expectation-maximization for hierarchical volumetric photon mapping.
<em>Computer Graphics Forum (Proceedings of the 2011 Eurographics Symposium on
Rendering)</em>&nbsp;<em>30</em>&thinsp;(4), 1287&ndash;97.
</li>

<li class="bibitem" id="cite:Jarabo2018">Jarabo, A., C.&nbsp;Aliaga, and D.&nbsp;Gutierrez. 2018a.
A radiative transfer framework for spatially-correlated materials.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH)</em>&nbsp;<em>37</em>&thinsp;(4).
</li>

<li class="bibitem" id="cite:Jarosz2008">Jarosz, W. 2008.
Efficient Monte Carlo methods for light transport in scattering media.
Ph.D. thesis, UC San Diego.
</li>

<li class="bibitem" id="cite:Jarosz:radiancecache">Jarosz, W., C.&nbsp;Donner, M.&nbsp;Zwicker, and H.&nbsp;W.&nbsp;Jensen. 2008a.
Radiance caching for participating media.
<em>ACM Transactions on Graphics</em>&nbsp;<em>27</em>&thinsp;(1), 7:1&ndash;11.
</li>

<li class="bibitem" id="cite:Jarosz2011a">Jarosz, W., D.&nbsp;Nowrouzezahrai, I.&nbsp;Sadeghi, and H.&nbsp;W. Jensen. 2011a.
A comprehensive theory of volumetric radiance estimation using photon
points and beams.
<em>ACM Transactions on Graphics</em>&nbsp;<em>30</em>&thinsp;(1), 5:1&ndash;19.
</li>

<li class="bibitem" id="cite:Jarosz2011b">Jarosz, W., D.&nbsp;Nowrouzezahrai, R.&nbsp;Thomas, P.-P.&nbsp;Sloan, and
M.&nbsp;Zwicker. 2011b.
Progressive photon beams.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH Asia
2011)</em>&nbsp;<em>30</em>&thinsp;(6), 181:1&ndash;12.
</li>

<li class="bibitem" id="cite:Jarosz08">Jarosz, W., M.&nbsp;Zwicker, and H.&nbsp;W. Jensen. 2008b.
The beam radiance estimate for volumetric photon mapping.
<em>Computer Graphics Forum (Proceedings of Eurographics
2008)</em>&nbsp;<em>27</em>&thinsp;(2), 557&ndash;66.
</li>

<li class="bibitem" id="cite:Jensen02">Jensen, H.&nbsp;W., and J.&nbsp;Buhler. 2002.
A rapid hierarchical rendering technique for translucent materials.
<em>ACM Transactions on Graphics</em>&nbsp;<em>21</em>&thinsp;(3), 576&ndash;81.
</li>

<li class="bibitem" id="cite:Jensen98">Jensen, H.&nbsp;W., and P.&nbsp;H. Christensen. 1998.
Efficient simulation of light transport in scenes with participating
  media using photon maps.
In <em>SIGGRAPH &rsquo;98 Conference Proceedings</em>, Annual
  Conference Series, 311&ndash;20.
</li>

<li class="bibitem" id="cite:Jensen01">Jensen, H.&nbsp;W., S.&nbsp;R. Marschner, M.&nbsp;Levoy, and P.&nbsp;Hanrahan. 2001b.
A practical model for subsurface light transport.
In <em>Proceedings of ACM SIGGRAPH 2001</em>, Computer Graphics
  Proceedings, Annual Conference Series, 511&ndash;18.
</li>

<li class="bibitem" id="cite:Krivanek2014:zerovar">K<span>&#345;</span>iv&aacute;nek, J., and E.&nbsp;d&rsquo;Eon. 2014.
A zero-variance-based sampling scheme for Monte Carlo subsurface scattering.
<em>SIGGRAPH 2014 Talks,</em> 66:1.
</li>

<li class="bibitem" id="cite:Kajiya84">Kajiya, J.&nbsp;T., and B.&nbsp;P.&nbsp;Von Herzen. 1984.
Ray tracing volume densities.
In <em>Computer Graphics (Proceedings of SIGGRAPH &rsquo;84)</em>, Volume&nbsp;18,
  165&ndash;74.
</li>

<li class="bibitem" id="cite:Kalli1977">Kalli, H.&nbsp;J., and E.&nbsp;D.&nbsp;Cashwell. 1977.
Evaluation of three Monte Carlo estimation schemes for flux at a point.
<em>LA-6865-MS</em>, Los Alamos National Laboratory.
</li>

<li class="bibitem" id="cite:Kallweit2017">Kallweit, S., T.&nbsp;M&uuml;ller, B.&nbsp;McWilliams, M.&nbsp;Gross, and J.&nbsp;Nov&aacute;k. 2017.
Deep scattering: Rendering atmospheric clouds with radiance-predicting neural networks.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>36</em>&thinsp;(6), 231:1&ndash;11.
</li>

<li class="bibitem" id="cite:Khvolson1890">Khvolson, O.&nbsp;D. 1890.
Grundz&uuml;ge einer matematischen Theorie der inneren Diffusion
  des Lichtes.
<em>Izv. Peterburg. Academii Nauk</em>&nbsp;<em>33</em>, 221&ndash;65.
</li>

<li class="bibitem" id="cite:King13">King, L.&nbsp;V. 1913.
On the scattering and absorption of light in gaseous media, with
  applications to the intensity of sky radiation.
<em>Philosophical Transactions of the Royal Society of London.
  Series A. Mathematical and Physical Sciences</em>&nbsp;<em>212</em>, 375&ndash;433.
</li>

<li class="bibitem" id="cite:Klassen87">Klassen, R.&nbsp;V. 1987.
Modeling the effect of the atmosphere on light.
<em>ACM Transactions on Graphics</em>&nbsp;<em>6</em>&thinsp;(3), 215&ndash;37.
</li>

<li class="bibitem" id="cite:Knaus2011">Knaus, C., and M.&nbsp;Zwicker. 2011.
Progressive photon mapping: A probabilistic approach.
<em>ACM Transactions on Graphics</em>&nbsp;<em>30</em>&thinsp;(3), 25:1&ndash;13.
</li>

<li class="bibitem" id="cite:Koerner2016">Koerner, D., J.&nbsp;Nov&aacute;k, P.&nbsp;Kutz, R.&nbsp;Habel, and W.&nbsp;Jarosz. 2016.
Subdivision next-event estimation for path-traced subsurface scattering.
<em>Eurographics Symposium on Rendering&mdash;Experimental Ideas and
Implementations</em>, 91&ndash;96.
</li>

<li class="bibitem" id="cite:Kulla2012">Kulla, C., and M.&nbsp;Fajardo. 2012.
Importance sampling techniques for path tracing in participating media.
<em>Computer Graphics Forum (Proceedings of the 2012 Eurographics
Symposium on Rendering)</em>&nbsp;<em>31</em>&thinsp;(4), 1519&ndash;28.
</li>

<li class="bibitem" id="cite:Kutz2017">Kutz, P., R.&nbsp;Habel, Y.&nbsp;K.&nbsp;Li, and J.&nbsp;Nov&aacute;k. 2017.
Spectral and decomposition tracking for rendering heterogeneous volumes.
<em>ACM Transactions on Graphics</em>&nbsp;<em>36</em>&thinsp;(4), 111:1&ndash;16.
</li>

<li class="bibitem" id="cite:Lee2007">Lee, R., and C.&nbsp;O&rsquo;Sullivan. 2007.
Accelerated light propagation through participating media.
<em>Proceedings of the Sixth Eurographics / IEEE VGTC Conference on
Volume Graphics</em>, 17&ndash;23.
</li>

<li class="bibitem" id="cite:Leonard2021">Leonard, L., K.&nbsp;H&ouml;hlein, and R.&nbsp;Westermann. 2021.
Learning multiple-scattering solutions for sphere-tracing of volumetric subsurface effects.
<em>Computer Graphics Forum (Proceedings of Eurographics)</em>&nbsp;<em>40</em>&thinsp;(2),
165&ndash;78.
</li>

<li class="bibitem" id="cite:Lommel1889">Lommel, E. 1889.
Die Photometrie der diffusen Zur&uuml;ckwerfung.
<em>Annalen der Physik</em>&nbsp;<em>36</em>, 473&ndash;502.
</li>

<li class="bibitem" id="cite:Loubet2018">Loubet, G., and F.&nbsp;Neyret. 2018.
A new microflake model with microscopic self-shadowing for accurate volume downsampling.
<em>Computer Graphics Forum</em>&nbsp;<em>37</em>&thinsp;(2), 111&ndash;21.
</li>

<li class="bibitem" id="cite:Muller2016">M&uuml;ller, T., M.&nbsp;Papas, M.&nbsp;Gross, W.&nbsp;Jarosz, and J.&nbsp;Nov&aacute;k. 2016.
Efficient rendering of heterogeneous polydisperse granular media.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>35</em>&thinsp;(6), 168:1&ndash;14.
</li>

<li class="bibitem" id="cite:Marco2018">Marco, J., A.&nbsp;Jarabo, W.&nbsp;Jarosz, and D.&nbsp;Gutierrez. 2018.
Second-order occlusion-aware volumetric radiance caching.
<em>ACM Transactions on Graphics</em>&nbsp;<em>37</em>&thinsp;(2), 20:1&ndash;14.
</li>

<li class="bibitem" id="cite:Max95">Max, N. L. 1995.
Optical models for direct volume rendering.
<em>IEEE Transactions on Visualization and Computer Graphics</em>&nbsp;<em>1</em>&thinsp;(2),
99&ndash;108.
</li>

<li class="bibitem" id="cite:Max86">Max, N.&nbsp;L. 1986.
Atmospheric illumination and shadows.
In <em>Computer Graphics (Proceedings of SIGGRAPH &rsquo;86)</em>, Volume&nbsp;20,
  117&ndash;24.
</li>

<li class="bibitem" id="cite:Meng2016">Meng, J., J.&nbsp;Hanika, and C.&nbsp;Dachsbacher. 2016.
Improving the Dwivedi sampling scheme.
<em>Computer Graphics Forum</em>&nbsp;<em>35</em>&thinsp;(4), 37&ndash;44.
</li>

<li class="bibitem" id="cite:Miller2019">Miller, B., I.&nbsp;Georgiev, and W.&nbsp;Jarosz. 2019.
A null-scattering path integral formulation of light transport.
<em>ACM Transactions on Graphics (Proceedings of
SIGGRAPH)</em>&nbsp;<em>38</em>&thinsp;(4), 1&ndash;13.
</li>

<li class="bibitem" id="cite:Mishchenko2013">Mishchenko, M.&nbsp;I. 2013.
125 years of radiative transfer: Enduring triumphs and persisting misconceptions.
<em>AIP Conference Proceedings</em>&nbsp;<em>1531</em>&thinsp;(11), 11&ndash;18.
</li>

<li class="bibitem" id="cite:Mojzik2018">Mojz&iacute;k, M., A.&nbsp;Fichet, and A.&nbsp;Wilkie. 2018.
Handling fluorescence in a uni-directional spectral path tracer.
<em>Computer Graphics Forum</em>&nbsp;<em>37</em>&thinsp;(4), 77&ndash;94.
</li>

<li class="bibitem" id="cite:Moon07">Moon, J., B.&nbsp;Walter, and S.&nbsp;Marschner. 2007.
Rendering discrete random media using precomputed scattering solutions.
<em>Rendering Techniques 2007: 18th Eurographics Workshop on Rendering</em>,
231&ndash;42.
</li>

<li class="bibitem" id="cite:Nishita87">Nishita, T., Y.&nbsp;Miyawaki, and E.&nbsp;Nakamae. 1987.
A shading model for atmospheric scattering considering luminous
  intensity distribution of light sources.
In <em>Computer Graphics (Proceedings of SIGGRAPH &rsquo;87)</em>, Volume&nbsp;21,
  303&ndash;10.
</li>

<li class="bibitem" id="cite:Novak2014">Nov&aacute;k, J., A.&nbsp;Selle, and W.&nbsp;Jarosz. 2014.
Residual ratio tracking for estimating attenuation in participating media.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH Asia
2014)</em>&nbsp;<em>33</em>&thinsp;(6), 179:1&ndash;11.
</li>

<li class="bibitem" id="cite:Pauly00">Pauly, M., T.&nbsp;Kollig, and A.&nbsp;Keller. 2000.
Metropolis light transport for participating media.
In <em>Rendering Techniques 2000: 11th Eurographics Workshop on
  Rendering</em>, 11&ndash;22.
</li>

<li class="bibitem" id="cite:Pediredla2020">Pediredla, A., Y.&nbsp;K.&nbsp;Chalmiani, M.&nbsp;G.&nbsp;Scopelliti, M.&nbsp;Chamanzar, S.&nbsp;Narasimhan, and I.&nbsp;Gkioulekas. 2020.
Path tracing estimators for refractive radiative transfer.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>39</em>&thinsp;(6), 241:1&ndash;15.
</li>

<li class="bibitem" id="cite:Pegoraro09">Pegoraro, V., and S.&nbsp;Parker. 2009.
An analytical solution to single scattering in homogeneous participating
media.
<em>Computer Graphics Forum (Proceedings of Eurographics 2009)</em>&nbsp;<em>28</em>&thinsp;(2),
329&ndash;35.
</li>

<li class="bibitem" id="cite:Pegoraro08">Pegoraro, V., I.&nbsp;Wald, and S.&nbsp;Parker. 2008b.
Sequential Monte Carlo adaptation in low-anisotropy participating media.
<em>Computer Graphics Forum (Proceedings of the 2008 Eurographics Symposium on
Rendering)</em>&nbsp;<em>27</em>&thinsp;(4),
1097&ndash;104.
</li>

<li class="bibitem" id="cite:Pegoraro2011">Pegoraro, V., M.&nbsp;Schott, and P.&nbsp;Slusallek. 2011.
A mathematical framework for efficient closed-form single scattering.
In <em>Proceedings of Graphics Interface 2011</em>, 151&ndash;58.
</li>

<li class="bibitem" id="cite:Pegoraro2010">Pegoraro, V., M.&nbsp;Schott, and S.&nbsp;G.&nbsp;Parker. 2010.
A closed-form solution to single scattering for general phase functions and
light distributions.
<em>Computer Graphics Forum (Proceedings of the 2010 Eurographics
Symposium on Rendering)</em>&nbsp;<em>29</em>&thinsp;(4), 1365&ndash;74.
</li>

<li class="bibitem" id="cite:Pegoraro09etal">Pegoraro, V., M.&nbsp;Schott, and S.&nbsp;Parker. 2009.
An analytical approach to single scattering for anisotropic media and light
distributions.
In <em>Proceedings of Graphics Interface 2009</em>, 71&ndash;77.
</li>

<li class="bibitem" id="cite:Pharr00">Pharr, M., and P.&nbsp;M. Hanrahan. 2000.
Monte Carlo evaluation of non-linear scattering equations for
  subsurface reflection.
In <em>Proceedings of ACM SIGGRAPH 2000</em>, Computer Graphics
  Proceedings, Annual Conference Series, 75&ndash;84.
</li>

<li class="bibitem" id="cite:Preetham99">Preetham, A.&nbsp;J., P.&nbsp;S. Shirley, and B.&nbsp;E. Smits. 1999.
A practical analytic model for daylight.
In <em>Proceedings of SIGGRAPH &rsquo;99</em>, Computer Graphics Proceedings,
  Annual Conference Series, 91&ndash;100.
</li>

<li class="bibitem" id="cite:Preisendorfer65">Preisendorfer, R.&nbsp;W. 1965.
<em>Radiative Transfer on Discrete Spaces</em>.
Oxford: Pergamon Press.
</li>

<li class="bibitem" id="cite:Preisendorfer76">Preisendorfer, R.&nbsp;W. 1976.
<em>Hydrologic Optics</em>.
Honolulu, Hawaii: U.S. Department of Commerce, National Oceanic and
  Atmospheric Administration.
</li>

<li class="bibitem" id="cite:Rushmeier88">Rushmeier, H.&nbsp;E. 1988.
Realistic image synthesis for scenes with radiatively
  participating media.
Ph.D. thesis, Cornell University.
</li>

<li class="bibitem" id="cite:Rushmeier87">Rushmeier, H.&nbsp;E., and K.&nbsp;E. Torrance. 1987.
The zonal method for calculating light intensities in the presence of
  a participating medium.
In <em>Computer Graphics (Proceedings of SIGGRAPH &rsquo;87)</em>, Volume&nbsp;21,
  293&ndash;302.
</li>

<li class="bibitem" id="cite:Schuster05">Schuster, A. 1905.
Radiation through a foggy atmosphere.
<em>Astrophysical Journal</em>&nbsp;<em>21</em>&thinsp;(1), 1&ndash;22.
</li>

<li class="bibitem" id="cite:Schwarzhaupt12">Schwarzhaupt, J., H.&nbsp;W. Jensen, and W. Jarosz. 2012.
Practical Hessian-based error control for irradiance caching.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH Asia)</em>&nbsp;<em>31</em>&thinsp;(6), 193:1&ndash;10.
</li>

<li class="bibitem" id="cite:Schwarzschild06">Schwarzschild, K. 1906.
On the equilibrium of the sun&rsquo;s atmosphere (Nachrichten von der
  Koniglichen Gesellschaft der Wissenschaften zu Gottigen).
<em>G&ouml;ttinger Nachrichten</em>&nbsp;<em>195</em>, 41&ndash;53.
</li>

<li class="bibitem" id="cite:Simon2017">Simon, F., J.&nbsp;Hanika, T.&nbsp;Zirr, and C.&nbsp;Dachsbacher. 2017.
Line integration for rendering heterogeneous emissive volumes.
<em>Computer Graphics Forum</em>&nbsp;<em>36</em>&thinsp;(4), 101&ndash;10.
</li>

<li class="bibitem" id="cite:Stam95">Stam, J. 1995.
Multiple scattering as a diffusion process.
In <em>Rendering Techniques (Proceedings of the Eurographics Rendering
Workshop)</em>,  41&ndash;50.
</li>

<li class="bibitem" id="cite:Sun05">Sun, B., R.&nbsp;Ramamoorthi, S.&nbsp;Narasimhan, and S.&nbsp;Nayar. 2005.
A practical analytic single scattering model for real time rendering.
<em>ACM Transactions on Graphics</em>&nbsp;<em>24</em>&thinsp;(3),  1040&ndash;49.
</li>

<li class="bibitem" id="cite:SzirmayKalos2017">Szirmay-Kalos, L., I.&nbsp;Georgiev, M.&nbsp;Magdics, B.&nbsp;Moln&aacute;r, and D.&nbsp;L&eacute;gr&aacute;dy. 2017.
Unbiased light transport estimators for inhomogeneous participating media.
<em>Computer Graphics Forum</em>&nbsp;<em>36</em>&thinsp;(2), 9&ndash;19.
</li>

<li class="bibitem" id="cite:SzirmayKalos2018">Szirmay-Kalos, L., M.&nbsp;Magdics, and M.&nbsp;Sbert. 2018.
Multiple scattering in inhomogeneous participating media using Rao-Blackwellization and control variates.
<em>Computer Graphics Forum</em>&nbsp;<em>37</em>&thinsp;(2), 63&ndash;74.
</li>

<li class="bibitem" id="cite:SzirmayKalos05">Szirmay-Kalos, L., M.&nbsp;Sbert, and T.&nbsp;Umenhoffer. 2005.
Real-time multiple scattering in participating media with illumination networks.
<em>Rendering Techniques 2005: 16th Eurographics Workshop on Rendering</em>,
277&ndash;82.
</li>

<li class="bibitem" id="cite:Ulam1947">Ulam, S., R.&nbsp;D.&nbsp;Richtmyer, and J.&nbsp;von Neumann. 1947.
Statistical methods in neutron diffusion.
<em></em> Los Alamos Scientific Laboratory Report LAMS-551.
</li>

<li class="bibitem" id="cite:vanDeHulst80">van de Hulst, H.&nbsp;C. 1980.
<em>Multiple Light Scattering</em>.
New York: Academic Press.
</li>

<li class="bibitem" id="cite:Villemin2013">Villemin, R., and C.&nbsp;Hery. 2013.
Practical illumination from flames.
<em>Journal of Computer Graphics Techniques (JCGT)</em>&nbsp;<em>2</em>&thinsp;(2), 142&ndash;55.
</li>

<li class="bibitem" id="cite:Villeneuve2021">Villeneuve, K., A.&nbsp;Gruson, I.&nbsp;Georgiev, and D.&nbsp;Nowrouzezahrai. 2021.
Practical product sampling for single scattering in media.
<em>Proceedings of the Eurographics Symposium on Rendering</em>, 55&ndash;60.
</li>

<li class="bibitem" id="cite:Walter2009">Walter, B., S.&nbsp;Zhao, N.&nbsp;Holzschuch, and K.&nbsp;Bala. 2009.
Single scattering in refractive media with triangle mesh boundaries.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH 2009)</em>&nbsp;<em>28</em>&thinsp;(3),
92:1&ndash;8.
</li>

<li class="bibitem" id="cite:Weber2017">Weber, P., J.&nbsp;Hanika, and C.&nbsp;Dachsbacher. 2017.
Multiple vertex next event estimation for lighting in dense, forward-scattering media.
<em>Computer Graphics Forum</em>&nbsp;<em>36</em>&thinsp;(2), 21&ndash;30.
</li>

<li class="bibitem" id="cite:Wilkie2021">Wilkie, A., P.&nbsp;Vevoda, T.&nbsp;Bashford-Rogers, L.&nbsp;Ho<span>&#353;</span>ek, T.&nbsp;Iser, M.&nbsp;Kol&aacute;<span>&#345;</span>ov&aacute;, T.&nbsp;Rittig, and J.&nbsp;K<span>&#345;</span>iv&aacute;nek. 2021.
A fitted radiance and attenuation model for realistic atmospheres.
<em>ACM Transactions on Graphics (Proceedings of
SIGGRAPH)</em>&nbsp;<em>40</em>&thinsp;(4), 135:1&ndash;14.
</li>

<li class="bibitem" id="cite:Wrenninge2020">Wrenninge, M., and R.&nbsp;Villemin. 2020.
Product importance sampling of the volume rendering equation using virtual
density segments.
<em>Pixar Technical Memo #20-01</em>.
</li>

<li class="bibitem" id="cite:Wrenninge2013">Wrenninge, M., C.&nbsp;Kulla, and V.&nbsp;Lundqvist. 2013.
Oz: The great and volumetric.
In <em>ACM SIGGRAPH 2013 Talks</em>, 46:1.
</li>

<li class="bibitem" id="cite:Wrenninge2017">Wrenninge, M., R.&nbsp;Villemin, and C.&nbsp;Hery. 2017.
Path traced subsurface scattering using anisotropic phase functions and non-exponential free flights.
<em>Pixar Technical Memo #17-07</em>.
</li>

<li class="bibitem" id="cite:Zhang2020:multiscale">Zhang, C., and S.&nbsp;Zhao. 2020.
Multi-scale appearance modeling of granular materials with continuously varying grain properties.
<em>Computer Graphics Forum</em>&nbsp;<em>39</em>&thinsp;(4).
</li>

<li class="bibitem" id="cite:Zhao2016:downsample">Zhao, S., L.&nbsp;Wu, F.&nbsp;Durand, and R.&nbsp;Ramamoorthi. 2016.
Downsampling scattering parameters for rendering anisotropic media.
<em>ACM Transactions on Graphics</em>&nbsp;<em>35</em>&thinsp;(6), 166:1&ndash;11.
</li>

</ol>
<p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md bg-light navbar-light">
<div class="container-fluid">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>,<br>
<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">&copy; 2004-2023</a> Matt Pharr, Wenzel Jakob, and Greg Humphreys.
<a href="https://github.com/mmp/pbr-book-website/"><span class="fab fa-github"></span></a><br>
Purchase a printed copy: <a href="https://www.amazon.com/Physically-Based-Rendering-fourth-Implementation/dp/0262048027?keywords=physically+based+rendering+4th+edition&qid=1671730412&sprefix=physically+based%!C(MISSING)aps%!C(MISSING)145&sr=8-1&linkCode=ll1&tag=pharr-20&linkId=81a816d90f0c7e872617f1f930a51fd6&language=en_US&ref_=as_li_ss_tl"><span class="fab fa-amazon"></span></a>
<a href="https://mitpress.mit.edu/9780262048026/physically-based-rendering/"><img src="/mitpress.png" width=10 height=16></a>
</span>
</div>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Light_Transport_II_Volume_Rendering/Exercises.html">Light Transport II: Volume Rendering / Exercises</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
