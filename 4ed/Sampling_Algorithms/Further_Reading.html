
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="icon" href="/favicon.ico?v=2" /> <!-- force refresh -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="../pbrstyle.css">
  <link rel="stylesheet" href="/fontawesome-free-5.15.3-web/css/all.css">

<script async src="https://cse.google.com/cse.js?cx=22a43cef261a245ea"></script>  <script src="/react.min.js"></script>
  <script src="/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/bootstrap.min.css">

  <title>Further Reading</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand bg-light navbar-light">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Sampling_Algorithms.html">Sampling Algorithms</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">Further Reading</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Sampling_Algorithms/Sampling_Multidimensional_Functions.html">(Previous: Sampling Multidimensional Functions)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<h2>Further Reading</h2><p>


</p>
<p>Rejection sampling was developed by von Neumann (<a href="#cite:vonNeumann1951">1951</a>)
shortly after the Monte Carlo method was invented.

</p>
<p>The alias method was introduced by Walker (<a href="#cite:Walker1974">1974</a>,
<a href="#cite:Walker1977">1977</a>).  The algorithm that we have implemented to generate
alias tables in the <a href="../Sampling_Algorithms/The_Alias_Method.html#AliasTable"><tt>AliasTable</tt></a> class is due to Vose
(<a href="#cite:Vose1991">1991</a>).  See Schwarz&rsquo;s article (<a href="#cite:Schwarz11">2011</a>) for
extensive information about implementing alias tables and related
techniques.

</p>
<p>A number of algorithms for reservoir sampling were described by Vitter
(<a href="#cite:Vitter1985">1985</a>), though he credits the basic algorithm we outlined
at the start of Section&nbsp;<a href="../Sampling_Algorithms/Reservoir_Sampling.html#sec:reservoir-sampling">A.2</a> to Alan Waterman.  The
weighted reservoir sampling algorithm in <tt>pbrt</tt>&rsquo;s
<a href="../Sampling_Algorithms/Reservoir_Sampling.html#WeightedReservoirSampler"><tt>WeightedReservoirSampler</tt></a> class is due to Chao (<a href="#cite:Chao1982">1982</a>).

</p>
<p>

</p>
<p>The square to disk mapping in Section&nbsp;<a href="../Sampling_Algorithms/Sampling_Multidimensional_Functions.html#sec:unit-disk-sample">A.5.1</a> was
described by Shirley and Chiu (<a href="#cite:Shirley97">1997</a>).  The implementation
here benefits by observations in Shirley&rsquo;s 2011 blog
by Dave Cline and the commenter &ldquo;franz&rdquo; that the logic could
be simplified considerably from the original algorithm
(Shirley&nbsp;<a href="#cite:Shirley2011">2011</a>).  Articles by Shirley and collaborators
describe a number of useful recipes for warping uniform random numbers to
useful distributions for rendering (<a href="#cite:Shirley92">Shirley 1992</a>; <a href="#cite:Shirley2019">Shirley et al. 2019</a>).

</p>
<p>The summed-area table data structure was introduced by Crow
(<a href="#cite:Crow84">1984</a>).  Its use for efficiently sampling arbitrary rectangluar regions of
images was demonstrated by Bitterli et al. (<a href="#cite:Bitterli2015">2015</a>).

</p>
<p>A number of additional sampling techniques have been developed for
tabularized multidimensional distributions.  Steigleder and McCool
(<a href="#cite:SteiglederMcCool03">2003</a>) linearized 2D and higher dimensional
domains into 1D using a Hilbert curve and then sampled using 1D samples
over the 1D domain, which 
still maintains desirable stratification properties of the sampling
distribution thanks to the spatial coherence preserving properties of the
Hilbert curve. McCool and Harwood (<a href="#cite:McCool97">1997</a>) as well as Clarberg
et&nbsp;al. (<a href="#cite:Clarberg05">2005</a>) described an approach for sampling images
based on quadtrees that repeatedly transforms uniform sample values until
they match a target distribution.

</p>
<p>Lawrence et&nbsp;al. (<a href="#cite:Lawrence05">2005</a>) described an adaptive
representation for tabularized CDFs, where the CDF is approximated with a
piecewise-linear function with fewer, irregularly spaced vertices
than the given CDF.  This approach can substantially reduce
storage requirements and improve lookup efficiency, taking advantage of the
fact that large ranges of the CDF may be efficiently approximated with a
single linear function.

</p>
<p>The time spent searching the CDF when sampling from a tabularized
distribution can be reduced with auxiliary data structures.  Chen and Asau
(<a href="#cite:Chen1974">1974</a>) suggested the <em>guide table method</em>, where an
additional array of offsets into the table gives a starting point for the
search.  Cline et&nbsp;al. (<a href="#cite:Cline09">2009</a>) introduced this approach to
graphics and also presented a method based on approximating the inverse CDF
as a piecewise-linear function of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.037ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 446.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">xi Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D709" d="M446 592c0 -31 -64 -31 -89 -31c-23 0 -46 0 -64 22c-75 -37 -111 -114 -111 -170c0 -19 4 -52 30 -78c37 12 66 12 84 12c39 0 82 -2 82 -27c0 -31 -63 -31 -93 -31c-21 0 -51 0 -88 13c-84 -42 -123 -129 -123 -170c0 -42 30 -71 75 -89l60 -24c21 -7 41 -15 61 -23 l61 -23c11 -5 48 -23 48 -71c0 -49 -42 -107 -104 -107c-56 0 -109 36 -109 48c0 4 2 11 10 11c4 0 5 -1 11 -5c11 -8 44 -32 88 -32c31 0 49 30 49 53c0 29 -20 36 -35 43c-59 23 -61 23 -121 47c-75 28 -84 32 -116 65c-2 3 -29 31 -29 79c0 36 22 130 131 202l13 10 c-47 27 -65 69 -65 106c0 77 68 157 175 187c-1 4 -7 19 -7 39c0 3 0 49 18 49c7 0 12 -5 12 -13c0 0 -5 -23 -5 -37c0 -17 2 -24 5 -33c26 5 50 5 63 5c39 0 83 -1 83 -27zM420 591c-18 5 -22 6 -56 6c-11 0 -32 0 -48 -5c11 -9 23 -9 42 -9c44 0 54 5 62 8zM352 319 c-18 5 -22 6 -57 6c-12 0 -34 0 -57 -6c18 -8 27 -8 50 -8c46 0 56 4 64 8Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="0" y="0"></use>
</g>
</svg>, thus enabling constant-time
lookups at a cost of some accuracy.
Binder and Keller (<a href="#cite:Binder2020">2020</a>) presented algorithms
for building and sampling from tabularized distributions that run
efficiently on GPUs.
Another innovative approach to sampling from such CDFs was described by
Morrical and Zellmann (<a href="#cite:Morrical2021">2021</a>), who showed how hardware
ray tracing capabilities could be used for this task.
Vitsas et al. (<a href="#cite:Vitsas2021">2021</a>)
fit Gaussian mixture models to the sampling distribution of clear sky
environment maps and showed a significant reduction in memory use with a
sampling algorithm that does not require table search.

</p>
<p>Arithmetic coding offers another interesting way to approach sampling from
distributions (MacKay&nbsp;<a href="#cite:MacKay03">2003</a>, p.&nbsp;118;
Piponi&nbsp;<a href="#cite:Piponi12">2012</a>). If we have a discrete set of probabilities
from which we would like to generate samples, one way to approach the problem is to
encode the CDF as a binary tree where each node splits the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.91ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2114.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1724" y="0"></use>
</g>
</svg> interval
at some point and where, given a random sample <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.037ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 446.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">xi Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D709" d="M446 592c0 -31 -64 -31 -89 -31c-23 0 -46 0 -64 22c-75 -37 -111 -114 -111 -170c0 -19 4 -52 30 -78c37 12 66 12 84 12c39 0 82 -2 82 -27c0 -31 -63 -31 -93 -31c-21 0 -51 0 -88 13c-84 -42 -123 -129 -123 -170c0 -42 30 -71 75 -89l60 -24c21 -7 41 -15 61 -23 l61 -23c11 -5 48 -23 48 -71c0 -49 -42 -107 -104 -107c-56 0 -109 36 -109 48c0 4 2 11 10 11c4 0 5 -1 11 -5c11 -8 44 -32 88 -32c31 0 49 30 49 53c0 29 -20 36 -35 43c-59 23 -61 23 -121 47c-75 28 -84 32 -116 65c-2 3 -29 31 -29 79c0 36 22 130 131 202l13 10 c-47 27 -65 69 -65 106c0 77 68 157 175 187c-1 4 -7 19 -7 39c0 3 0 49 18 49c7 0 12 -5 12 -13c0 0 -5 -23 -5 -37c0 -17 2 -24 5 -33c26 5 50 5 63 5c39 0 83 -1 83 -27zM420 591c-18 5 -22 6 -56 6c-11 0 -32 0 -48 -5c11 -9 23 -9 42 -9c44 0 54 5 62 8zM352 319 c-18 5 -22 6 -57 6c-12 0 -34 0 -57 -6c18 -8 27 -8 50 -8c46 0 56 4 64 8Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="0" y="0"></use>
</g>
</svg>, we determine
which sample value it corresponds to by traversing the tree until we reach
the leaf node for its sample value. Ideally, we would like leaf
nodes that represent higher probabilities to be higher up in the tree, so that
it takes fewer traversal steps to find them (and thus those more
frequently generated samples can be found more quickly). Looking at the
problem from this perspective, it can be shown that the optimal structure
of such a tree is given by Huffman coding, which is normally used for
compression.

</p>
<p></p>
<h3>References</h3>
<ol style="list-style: none;">
<li class="bibitem" id="cite:Binder2020">Binder, N., and A.&nbsp;Keller. 2020.
Massively parallel construction of radix tree forests for the efficient sampling of discrete or piecewise constant probability distributions.
<em>Monte Carlo and Quasi-Monte Carlo Methods (MCQMC 2018)</em>. arXiv:
1902.05942 [cs].
</li>

<li class="bibitem" id="cite:Bitterli2015">Bitterli, B., J.&nbsp;Nov&aacute;k, and W.&nbsp;Jarosz. 2015.
Portal-masked environment map sampling. 
<em>Computer Graphics Forum (Proceedings of the 2015
Eurographics Symposium on Rendering)</em>&nbsp;<em>34</em>&thinsp;(4), 13&ndash;19.
</li>

<li class="bibitem" id="cite:Chao1982">Chao, M.&nbsp;T. 1982.
A general purpose unequal probability sampling plan.
<em>Biometrika</em>&nbsp;<em>69</em>&thinsp;(3), 653&ndash;56.
</li>

<li class="bibitem" id="cite:Chen1974">Chen, H.&nbsp;C., and Y.&nbsp;Asau. 1974.
On generating random variates from an empirical distribution.
<em>AIIE Transactions</em>&nbsp;<em>6</em>&thinsp;(2), 163&ndash;66.
</li>

<li class="bibitem" id="cite:Clarberg05">Clarberg, P., W.&nbsp;Jarosz, T.&nbsp;Akenine-M&ouml;ller, and H.&nbsp;W. Jensen. 2005.
Wavelet importance sampling: Efficiently evaluating products of complex
functions.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
2005)</em>&nbsp;<em>24</em>&thinsp;(3), 1166&ndash;75.
</li>

<li class="bibitem" id="cite:Cline09">Cline, D., A.&nbsp;Razdan, and P.&nbsp;Wonka. 2009.
A comparison of tabular PDF inversion methods.
<em>Computer Graphics Forum</em>&nbsp;<em>28</em>&thinsp;(1), 154&ndash;60.
</li>

<li class="bibitem" id="cite:Crow84">Crow, F.&nbsp;C. 1984.
Summed-area tables for texture mapping.
<em>Computer Graphics (Proceedings of SIGGRAPH &rsquo;84)</em> <em>18</em>,
207&ndash;12.
</li>

<li class="bibitem" id="cite:Lawrence05">Lawrence, J., S.&nbsp;Rusinkiewicz, and R.&nbsp;Ramamoorthi. 2005.
Adaptive numerical cumulative distribution functions for efficient
importance sampling.
<em>Rendering Techniques 2005: 16th Eurographics Workshop on Rendering</em>,
11&ndash;20.
</li>

<li class="bibitem" id="cite:MacKay03">MacKay, D. 2003.
<em>Information Theory, Inference, and Learning Algorithms</em>.
Cambridge: Cambridge University Press.
</li>

<li class="bibitem" id="cite:McCool97">McCool, M.&nbsp;D., and P.&nbsp;K. Harwood. 1997.
Probability trees.
<em>Proceedings of Graphics Interface &rsquo;97</em>, 37&ndash;46.
</li>

<li class="bibitem" id="cite:Morrical2021">Morrical, N., and S.&nbsp;Zellmann. 2021.
Inverse transform sampling using ray tracing hardware.
In Marrs, A., P.&nbsp;Shirley, and I.&nbsp;Wald (eds.), <em>Ray Tracing Gems II</em>,
625&ndash;41. Berkeley: Apress.
</li>

<li class="bibitem" id="cite:Piponi12">Piponi, D. 2012.
Lossless decompression and the generation of random samples.
<a href="http://blog.sigfpe.com/2012/01/lossless-decompression-and-generation.html">http://blog.sigfpe.com/2012/01/lossless-decompression-and-generation.html</a>.
</li>

<li class="bibitem" id="cite:Schwarz11">Schwarz, K. 2011.
Darts, dice, and coins: Sampling from a discrete distribution.
<a href="http://www.keithschwarz.com/darts-dice-coins/">http://www.keithschwarz.com/darts-dice-coins/</a>.
</li>

<li class="bibitem" id="cite:Shirley92">Shirley, P. 1992.
Nonuniform random point sets via warping.
In D.&nbsp;Kirk (ed.), <em>Graphics Gems III</em>, 80&ndash;83. San Diego: Academic
  Press.
</li>

<li class="bibitem" id="cite:Shirley2011">Shirley, P. 2011.
Improved code for concentric map.
<a href="http://psgraphics.blogspot.com/2011/01/improved-code-for-concentric-map.html">http://psgraphics.blogspot.com/2011/01/improved-code-for-concentric-map.html</a>.
</li>

<li class="bibitem" id="cite:Shirley97">Shirley, P., and K.&nbsp;Chiu. 1997.
A low distortion map between disk and square.
<em>Journal of Graphics Tools</em>&nbsp;<em>2</em>&thinsp;(3), 45&ndash;52.
</li>

<li class="bibitem" id="cite:Shirley2019">Shirley, P., S.&nbsp;Laine, D.&nbsp;Hart, M.&nbsp;Pharr, P.&nbsp;Clarberg, E.&nbsp;Haines, M.&nbsp;Raab, and D.&nbsp;Cline. 2019.
Sampling transformations zoo.
In E.&nbsp;Haines and T.&nbsp;Akenine-M&ouml;ller (eds.), <em>Ray Tracing Gems</em>,
223&ndash;46. Berkeley: Apress.
</li>

<li class="bibitem" id="cite:SteiglederMcCool03">Steigleder, M., and M.&nbsp;McCool.  2003.
Generalized stratified sampling using the Hilbert curve.
<em>Journal of Graphics Tools</em>&nbsp;<em>8</em>&thinsp;(3), 41&ndash;47.
</li>

<li class="bibitem" id="cite:Vitsas2021">Vitsas, N., K.&nbsp;Vardis, and G.&nbsp;Papaioannou. 2021.
Sampling clear sky models using truncated Gaussian mixtures.
<em>Proceedings of the Eurographics Symposium on Rendering</em>, 35&ndash;44.
</li>

<li class="bibitem" id="cite:Vitter1985">Vitter, J.&nbsp;S. 1985.
Random sampling with a reservoir.
<em>ACM Transactions on Mathematical Software</em>,&nbsp;<em>11</em>&thinsp;(1), 37&ndash;57.
</li>

<li class="bibitem" id="cite:vonNeumann1951">von Neumann, J. 1951.
Various techniques used in connection with random digits.
<em>Journal of Research of the National Bureau of Standards, Applied
Mathematics Series</em>&nbsp;<em>12</em>, 36&ndash;38.
</li>

<li class="bibitem" id="cite:Vose1991">Vose, M.&nbsp;D. 1991.
A linear algorithm for generating random numbers with a given distribution.
<em>IEEE Transactions on Software Engineering</em>&nbsp;<em>17</em>&thinsp;(9), 972&ndash;75.
</li>

<li class="bibitem" id="cite:Walker1974">Walker, A.&nbsp;J. 1974.
New fast method for generating discrete random numbers with arbitrary
frequency distributions.
<em>Electronics Letters</em>&nbsp;<em>10</em>&thinsp;(8): 127&ndash;28.
</li>

<li class="bibitem" id="cite:Walker1977">Walker, A.&nbsp;J. 1977.
An efficient method for generating discrete random variables with general distributions.
<em>ACM Transactions on Mathematical Software</em>&nbsp;<em>3</em>&thinsp;(3), 253&ndash;56.
</li>

</ol>
<p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md bg-light navbar-light">
<div class="container-fluid">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>,<br>
<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">&copy; 2004-2023</a> Matt Pharr, Wenzel Jakob, and Greg Humphreys.
<a href="https://github.com/mmp/pbr-book-website/"><span class="fab fa-github"></span></a><br>
Purchase a printed copy: <a href="https://www.amazon.com/Physically-Based-Rendering-fourth-Implementation/dp/0262048027?keywords=physically+based+rendering+4th+edition&qid=1671730412&sprefix=physically+based%!C(MISSING)aps%!C(MISSING)145&sr=8-1&linkCode=ll1&tag=pharr-20&linkId=81a816d90f0c7e872617f1f930a51fd6&language=en_US&ref_=as_li_ss_tl"><span class="fab fa-amazon"></span></a>
<a href="https://mitpress.mit.edu/9780262048026/physically-based-rendering/"><img src="/mitpress.png" width=10 height=16></a>
</span>
</div>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Sampling_Algorithms/Exercises.html">Sampling Algorithms / Exercises</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
