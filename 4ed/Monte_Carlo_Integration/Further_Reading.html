
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="icon" href="/favicon.ico?v=2" /> <!-- force refresh -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="../pbrstyle.css">
  <link rel="stylesheet" href="/fontawesome-free-5.15.3-web/css/all.css">

<script async src="https://cse.google.com/cse.js?cx=22a43cef261a245ea"></script>  <script src="/react.min.js"></script>
  <script src="/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/bootstrap.min.css">

  <title>Further Reading</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand bg-light navbar-light">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Monte_Carlo_Integration.html">Monte Carlo Integration</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">Further Reading</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Monte_Carlo_Integration/Transforming_between_Distributions.html">(Previous: Transforming between Distributions)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<h2>Further Reading</h2><p>


</p>
<p>The Monte Carlo method was introduced soon after the development of the
digital computer by Stanislaw Ulam and John von Neumann (<a href="#cite:Ulam1947">Ulam et al. 1947</a>),
though it also seems to have been independently invented by Enrico Fermi
(<a href="#cite:Metropolis1987">Metropolis 1987</a>).  An early paper on Monte Carlo was written by
Metropolis and Ulam (<a href="#cite:Metropolis1949">1949</a>).

</p>
<p>Many books have been written on Monte Carlo integration.  Hammersley and
Handscomb (<a href="#cite:Hammersley64">1964</a>), Spanier and Gelbard
(<a href="#cite:Spanier69">1969</a>), and Kalos and Whitlock (<a href="#cite:Kalos86">1986</a>) are
classic references.  More recent books on the topic include those by
Sobol<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> (<a href="#cite:Sobol1994">1994</a>), Fishman (<a href="#cite:Fishman96">1996</a>), and Liu
(<a href="#cite:Liu01">2001</a>).  We have also found Owen&rsquo;s in-progress book
(<a href="#cite:Owen2019">2019</a>) to be an invaluable resource.
Motwani and Raghavan (<a href="#cite:Motwani:RandomizedAlgorithms">1995</a>) have written an
excellent introduction to the broader topic of randomized algorithms.

</p>
<p>Most of the functions of interest in rendering are nonnegative; applying
importance sampling to negative functions requires special care.  A
straightforward option is to define a sampling distribution that is
proportional to the absolute value of the function.  See also Owen and Zhou
(<a href="#cite:Owen2000">2000</a>) for a more effective sampling approach for such functions.

</p>
<p>Multiple importance sampling was developed by Veach and Guibas
(<a href="#cite:Veach95">Veach and Guibas 1995</a>; <a href="#cite:VeachThesis">Veach 1997</a>).  Normally, a predetermined number of
samples are taken using each sampling technique; see Pajot
et&nbsp;al. (<a href="#cite:Pajot2011">2011</a>) and Lu et&nbsp;al. (<a href="#cite:Lu2013">2013</a>) for
approaches to adaptively distributing the samples over strategies in an
effort to reduce variance by choosing those that are the best match to the
integrand.  Grittmann et&nbsp;al. (<a href="#cite:Grittmann2019">2019</a>) 
tracked the variance of each sampling technique and then dynamically
adjusted the MIS weights accordingly.  The MIS compensation approach was
developed by Karl&iacute;k et&nbsp;al. (<a href="#cite:Karlik2019">2019</a>).

</p>
<p>Sbert and collaborators
(<a href="#cite:Sbert2016">2016</a>, <a href="#cite:Sbert2017">2017</a>, <a href="#cite:Sbert2018">2018</a>) have
performed further variance analysis on MIS estimators and have developed
improved methods based on allocating samples according to the variance and
cost of each technique.
Kondapaneni et&nbsp;al. (<a href="#cite:Kondapaneni2019">2019</a>) considered the generalization
of MIS to include negative weights and derived optimal estimators in that
setting.  West et&nbsp;al. (<a href="#cite:West2020">2020</a>) considered the case where a
continuum of sampling techniques are available and derived an optimal MIS
estimator for that case, and Grittmann et al. (<a href="#cite:Grittmann2021">2021</a>)
have developed improved MIS estimators when correlation is present among
samples (as is the case, for example, with bidirectional light transport
algorithms).

</p>
<p>Heitz (<a href="#cite:Heitz2020">2020</a>) described an inversion-based sampling method
that can be applied when CDF inversion of a 1D function is not possible.
It is based on sampling from a second function that approximates the first
and then using a second random variable to adjust the sample to match the
original function&rsquo;s distribution.
An interesting alternative to manually deriving sampling techniques was
described by Anderson
et&nbsp;al. (<a href="#cite:Anderson2017">2017</a>), who developed a domain-specific language
for sampling where probabilities are automatically computed, given the
implementation of a sampling algorithm.  They showed the effectiveness of
their approach with succinct implementations of a number of tricky sampling
techniques.

</p>
<p>The numerically stable sampling technique used in <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#SampleLinear"><tt>SampleLinear()</tt></a> is
an application of Muller&rsquo;s method (<a href="#cite:Muller56">1956</a>) due to Heitz
(<a href="#cite:Heitz2020">2020</a>).  

</p>
<p>In applications of Monte Carlo in graphics, the integrand is often a
product of factors, where no sampling distribution is available that fits
the full product.  While multiple importance sampling can give reasonable
results in this case, at least minimizing variance from ineffective
sampling techniques, sampling the full product is still preferable.  Talbot
et&nbsp;al. (<a href="#cite:Talbot2005">2005</a>) applied <em>importance resampling</em> to this
problem, taking multiple samples from some distribution and then choosing
among them with probability proportional to the full integrand.  More recently, Hart
et&nbsp;al. (<a href="#cite:Hart2020">2020</a>) presented a simple technique based on warping
uniform samples that can be used to approximate product sampling.  For more
information on this topic, see also the &ldquo;Further Reading&rdquo; sections of
Chapters&nbsp;<a href="../Light_Transport_I_Surface_Reflection.html#chap:light-transport">13</a> and&nbsp;<a href="../Light_Transport_II_Volume_Rendering.html#chap:volume-integration">14</a>,
which discuss product sampling approaches in the context of specific light
transport algorithms.

</p>
<p>Debugging Monte Carlo algorithms can be challenging, since it is their
behavior in expectation that determines their correctness: it may be
difficult to tell if the program execution for a particular sample is
correct.  Statistical tests can be an effective approach for checking their
correctness.  See the papers by Subr and Arvo (<a href="#cite:Subr2007a">2007a</a>) and by
Jung et&nbsp;al. (<a href="#cite:Jung2020">2020</a>) for applicable techniques.

</p>
<p>See also the &ldquo;Further Reading&rdquo; section in
Appendix&nbsp;<a href="../Sampling_Algorithms.html#chap:sampling-algorithms">A</a>, which has information about the
sampling algorithms implemented there as well as related approaches.

</p>
<p></p>
<h3>References</h3>
<ol style="list-style: none;">
<li class="bibitem" id="cite:Anderson2017">Anderson, L., T.-M.&nbsp;Li, J.&nbsp;Lehtinen, and F.&nbsp;Durand. 2017.
Aether: An embedded domain specific sampling language for Monte Carlo rendering.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
2017)</em>&nbsp;<em>36</em>&thinsp;(4), 99:1&ndash;16.
</li>

<li class="bibitem" id="cite:Fishman96">Fishman, G.&nbsp;S. 1996.
<em>Monte Carlo: Concepts, Algorithms, and Applications</em>.
New York: Springer-Verlag.
</li>

<li class="bibitem" id="cite:Grittmann2021">Grittmann, P., I.&nbsp;Georgiev, and P.&nbsp;Slusallek. 2021.
Correlation-aware multiple importance sampling for bidirectional rendering algorithms.
<em>Computer Graphics Forum (Proceedings of Eurographics)</em>&nbsp;<em>40</em>&thinsp;(2),
231&ndash;38.
</li>

<li class="bibitem" id="cite:Grittmann2019">Grittmann, P., I.&nbsp;Georgiev, P.&nbsp;Slusallek, and J.&nbsp;K<span>&#345;</span>iv&aacute;nek. 2019.
Variance-aware multiple importance sampling.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH Asia
2019)</em>&nbsp;<em>38</em>&thinsp;(6), 152:1&ndash;9.
</li>

<li class="bibitem" id="cite:Hammersley64">Hammersley, J., and D.&nbsp;Handscomb. 1964.
<em>Monte Carlo Methods</em>.
New York: John Wiley.
</li>

<li class="bibitem" id="cite:Hart2020">Hart, D., M.&nbsp;Pharr, T.&nbsp;M&uuml;ller, W.&nbsp;Lopes, M.&nbsp;McGuire, and P.&nbsp;Shirley. 2020.
Practical product sampling by fitting and composing warps.
<em>Computer Graphics Forum</em>&nbsp;<em>39</em>&thinsp;(4), 149&ndash;58.
</li>

<li class="bibitem" id="cite:Heitz2020">Heitz, E. 2020.
Can&rsquo;t invert the CDF? The triangle-cut parameterization of the region under the curve.
<em>Computer Graphics Forum</em>&nbsp;<em>39</em>&thinsp;(4), 121&ndash;32.
</li>

<li class="bibitem" id="cite:Jung2020">Jung, A., J.&nbsp;Hanika, and C.&nbsp;Dachsbacher. 2020.
Detecting bias in Monte Carlo renderers using Welch&rsquo;s t-test.
<em>Journal of Computer Graphics Techniques (JCGT)</em>&nbsp;<em>9</em>&thinsp;(2), 1&ndash;25.
</li>

<li class="bibitem" id="cite:Kalos86">Kalos, M.&nbsp;H., and P.&nbsp;A. Whitlock. 1986.
<em>Monte Carlo Methods: Volume I: Basics</em>.
New York: Wiley.
</li>

<li class="bibitem" id="cite:Karlik2019">Karl&iacute;k, O., M.&nbsp;<span>&#352;</span>ik, P.&nbsp;V&eacute;voda, T.&nbsp;Sk<span>&#345;</span>ivan, and
 J.&nbsp;K<span>&#345;</span>iv&aacute;nek. 2019.
MIS compensation: Optimizing sampling techniques in multiple importance sampling.
<em>ACM Transactions on Graphics (Proceedings of
 SIGGRAPH Asia)</em>&nbsp;<em>38</em>&thinsp;(6), 151:1&ndash;12.
</li>

<li class="bibitem" id="cite:Kondapaneni2019">Kondapaneni, I., P.&nbsp;V&eacute;voda, P.&nbsp;Grittmann, T.&nbsp;Sk<span>&#345;</span>ivan, P.&nbsp;Slusallek, and J.&nbsp;K<span>&#345;</span>iv&aacute;nek. 2019.
Optimal multiple importance sampling.
<em>ACM Transactions on Graphics (Proceedings of
 SIGGRAPH)</em>&nbsp;<em>37</em>&thinsp;(4), 37:1&ndash;14.
</li>

<li class="bibitem" id="cite:Liu01">Liu, J.&nbsp;S. 2001.
<em>Monte Carlo Strategies in Scientific Computing</em>.
New York: Springer-Verlag.
</li>

<li class="bibitem" id="cite:Lu2013">Lu, H., R.&nbsp;Pacanowski, and X.&nbsp;Granier. 2013.
Second-order approximation for variance reduction in multiple importance sampling.
<em>Computer Graphics Forum</em>&nbsp;<em>32</em>&thinsp;(7), 131&ndash;36.
</li>

<li class="bibitem" id="cite:Metropolis1987">Metropolis, N. 1987.
The beginning of the Monte Carlo method.
<em>Los Alamos Science Special Issue</em>&nbsp;<em>15</em>, 125&ndash;30.
</li>

<li class="bibitem" id="cite:Metropolis1949">Metropolis, N., and S.&nbsp;Ulam. 1949.
The Monte Carlo method.
<em>Journal of the American Statistical Association</em>&nbsp;<em>44</em>&thinsp;(247), 335&ndash;41.
</li>

<li class="bibitem" id="cite:Motwani:RandomizedAlgorithms">Motwani, R., and P.&nbsp;Raghavan. 1995.
<em>Randomized Algorithms</em>. Cambridge, U.K.:
Cambridge University Press.
</li>

<li class="bibitem" id="cite:Muller56">Muller, D.&nbsp;E. 1956.
A method for solving algebraic equations using an automatic computer.
<em>Mathematical Tables and Other Aids to Computation</em>&nbsp;<em>10</em>&thinsp;(56), 208&ndash;15.
</li>

<li class="bibitem" id="cite:owen98latin">Owen, A.&nbsp;B. 1998.
Latin supercube sampling for very high-dimensional simulations.
<em>Modeling and Computer Simulation</em>&nbsp;<em>8</em>&thinsp;(1), 71&ndash;102.
</li>

<li class="bibitem" id="cite:Owen2019">Owen, A.&nbsp;B. 2019.
Monte Carlo theory, methods and examples.
<a href="https://statweb.stanford.edu/&nbsp;owen/mc/">https://statweb.stanford.edu/&nbsp;owen/mc/</a>.
</li>

<li class="bibitem" id="cite:Owen2000">Owen, A., and Y.&nbsp;Zhou. 2000.
Safe and effective importance sampling.
<em>Journal of the American Statistical Association</em>&nbsp;<em>95</em>&thinsp;(449), 135&ndash;43.
</li>

<li class="bibitem" id="cite:Pajot2011">Pajot, A., L.&nbsp;Barthe, M.&nbsp;Paulin, and P.&nbsp;Poulin. 2011.
Representativity for robust and adaptive multiple importance sampling.
<em>IEEE Transactions on Visualization and Computer
Graphics</em>&nbsp;<em>17</em>&thinsp;(8), 1108&ndash;21.
</li>

<li class="bibitem" id="cite:Ross:ProbabilityModels">Ross, S.&nbsp;M. 2002.
<em>Introduction to Probability Models</em> (8th ed.). San Diego:
Academic Press.
</li>

<li class="bibitem" id="cite:Sbert2017">Sbert, M., and V.&nbsp;Havran. 2017.
Adaptive multiple importance sampling for general functions.
<em>The Visual Computer</em>&nbsp;<em>33</em>, 845&ndash;55.
</li>

<li class="bibitem" id="cite:Sbert2016">Sbert, M., V.&nbsp;Havran, and L.&nbsp;Szirmay-Kalos. 2016.
Variance analysis of multi-sample and one-sample multiple importance sampling.
<em>Computer Graphics Forum</em>&nbsp;<em>35</em>&thinsp;(7), 451&ndash;60.
</li>

<li class="bibitem" id="cite:Sbert2018">Sbert, M., V.&nbsp;Havran, and L.&nbsp;Szirmay-Kalos. 2018.
Multiple importance sampling revisited: Breaking the bounds.
<em>EURASIP Journal on Advances in Signal Processing</em>&nbsp;<em>15</em>, 1&ndash;15.
</li>

<li class="bibitem" id="cite:Sobol1994">Sobol<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg>, I.&nbsp;M. 1994.
<em>A Primer for the Monte Carlo Method</em>.
Boca Raton: CRC Press.
</li>

<li class="bibitem" id="cite:Spanier69">Spanier, J., and E.&nbsp;M. Gelbard. 1969.
<em>Monte Carlo Principles and Neutron Transport Problems</em>.
Reading, Massachusetts: Addison-Wesley.
</li>

<li class="bibitem" id="cite:Subr2007a">Subr, K., and J.&nbsp;Arvo. 2007a.
Statistical hypothesis testing for assessing Monte
Carlo estimators: Applications to image synthesis.
In <em>Pacific Graphics &rsquo;97</em>, 106&ndash;15.
</li>

<li class="bibitem" id="cite:Talbot2005">Talbot, J., D.&nbsp;Cline, and P.&nbsp;Egbert. 2005.
Importance resampling for global illumination.
<em>Rendering Techniques 2005: 16th Eurographics Workshop on Rendering</em>,
139&ndash;46.
</li>

<li class="bibitem" id="cite:Ulam1947">Ulam, S., R.&nbsp;D.&nbsp;Richtmyer, and J.&nbsp;von Neumann. 1947.
Statistical methods in neutron diffusion.
<em></em> Los Alamos Scientific Laboratory Report LAMS-551.
</li>

<li class="bibitem" id="cite:VeachThesis">Veach, E. 1997.
Robust Monte Carlo methods for light transport simulation.
Ph.D. thesis, Stanford University.
</li>

<li class="bibitem" id="cite:Veach95">Veach, E., and L.&nbsp;J. Guibas. 1995.
Optimally combining sampling techniques for Monte Carlo rendering.
In <em>Computer Graphics (SIGGRAPH &rsquo;95 Proceedings)</em>, 419&ndash;28.
</li>

<li class="bibitem" id="cite:West2020">West, W., I.&nbsp;Georgiev, A.&nbsp;Gruson, and T.&nbsp;Hachisuka. 2020.
Continuous multiple importance sampling.
<em>ACM Transactions on Graphics (Proceedings of
SIGGRAPH)</em>&nbsp;<em>39</em>&thinsp;(4), 136:1&ndash;12.
</li>

</ol>
<p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md bg-light navbar-light">
<div class="container-fluid">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>,<br>
<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">&copy; 2004-2023</a> Matt Pharr, Wenzel Jakob, and Greg Humphreys.
<a href="https://github.com/mmp/pbr-book-website/"><span class="fab fa-github"></span></a><br>
Purchase a printed copy: <a href="https://www.amazon.com/Physically-Based-Rendering-fourth-Implementation/dp/0262048027?keywords=physically+based+rendering+4th+edition&qid=1671730412&sprefix=physically+based%!C(MISSING)aps%!C(MISSING)145&sr=8-1&linkCode=ll1&tag=pharr-20&linkId=81a816d90f0c7e872617f1f930a51fd6&language=en_US&ref_=as_li_ss_tl"><span class="fab fa-amazon"></span></a>
<a href="https://mitpress.mit.edu/9780262048026/physically-based-rendering/"><img src="/mitpress.png" width=10 height=16></a>
</span>
</div>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Monte_Carlo_Integration/Exercises.html">Monte Carlo Integration / Exercises</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
