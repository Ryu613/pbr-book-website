
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="icon" href="/favicon.ico?v=2" /> <!-- force refresh -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="../pbrstyle.css">
  <link rel="stylesheet" href="/fontawesome-free-5.15.3-web/css/all.css">

<script async src="https://cse.google.com/cse.js?cx=22a43cef261a245ea"></script>  <script src="/react.min.js"></script>
  <script src="/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/bootstrap.min.css">

  <title>Further Reading</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand bg-light navbar-light">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Reflection_Models.html">Reflection Models</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">Further Reading</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Reflection_Models/Scattering_from_Hair.html">(Previous: Scattering from Hair)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<h2>Further Reading</h2><p>


</p>
<p>Hall&rsquo;s (<a href="#cite:Hall89">1989</a>) book collected and described the state of the
art in physically based surface reflection models for graphics; it remains
a seminal reference.  It discusses the physics of surface reflection in
detail, with many pointers to the original literature.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x8-MicrofacetModels"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x8-MicrofacetModels"></span><h4>Microfacet Models</h4><p>


</p>
<p>Phong (<a href="#cite:Phong75">1975</a>) developed an early empirical reflection model
for glossy surfaces in computer graphics.  Although neither reciprocal nor
energy conserving, it was a cornerstone of the first synthetic images of
non-Lambertian objects.  The Torrance&ndash;Sparrow microfacet model was
described by Torrance and Sparrow (<a href="#cite:Torrance67">1967</a>); it was first
introduced to graphics by Blinn (<a href="#cite:Blinn:1977:MOL">1977</a>), and a variant
of it was used by Cook and Torrance (<a href="#cite:Cook81">1981</a>, <a href="#cite:Cook82">1982</a>).

</p>
<p>The papers by Beckmann and Spizzichino (<a href="#cite:Beckmann63">1963</a>) and
Trowbridge and Reitz (<a href="#cite:Trowbridge1975">1975</a>) introduced two widely used
microfacet distribution functions.  Kurt
et&nbsp;al. (<a href="#cite:Kurt2010">2010</a>) introduced an anisotropic variant of the Beckmann&ndash;Spizzichino
distribution function; see Heitz (<a href="#cite:Heitz2014a">2014</a>) for anisotropic
variants of many other microfacet distribution functions.  (Early
anisotropic BRDF models for computer graphics were developed by Kajiya
(<a href="#cite:Kajiya85">1985</a>) and Poulin and Fournier (<a href="#cite:Poulin90">1990</a>).)
Ribardi&egrave;re et&nbsp;al. (<a href="#cite:Ribardiere2017">2017</a>) applied Student&rsquo;s
t-distribution to model microfacet distributions; it provides an additional
degree of freedom, which they showed allows a better fit to measured data
while subsuming both the Beckmann&ndash;Spizzichino and Trowbridge&ndash;Reitz distributions.  
Ribardi&egrave;re
et&nbsp;al. (<a href="#cite:Ribardiere2019">2019</a>) investigated the connection between
normal distribution functions (NDFs) and microfacet distributions and also
showed how to generate surfaces
with distributions described by their model.

</p>
<p>The microfacet masking-shadowing function was introduced by Smith
(<a href="#cite:Smith1967">1967</a>), building on the assumption that heights of nearby points
on the microfacet surface are uncorrelated. Smith also first derived the
normalization constraint in Equation&nbsp;(<a href="../Reflection_Models/Roughness_Using_Microfacet_Theory.html#eq:microfacet-g1-condition">9.17</a>).  
Heitz&rsquo;s paper on microfacet masking-shadowing functions
(<a href="#cite:Heitz2014a">2014</a>) provides a very well-written introduction to
microfacet BSDF models in general, with many useful figures and
explanations about details of the topic.

</p>
<p>The more accurate <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.305ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4006.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper G left-parenthesis omega Subscript normal i Baseline comma omega Subscript normal o Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D43A" d="M760 695l-63 -255c-5 -18 -5 -20 -18 -20c-4 0 -15 0 -15 10s3 11 3 51c0 116 -59 193 -161 193c-99 0 -196 -61 -250 -129c-105 -130 -115 -295 -115 -326c0 -153 105 -210 201 -210c35 0 165 11 193 121c10 37 21 82 21 91c0 13 -5 16 -31 19c-23 2 -53 2 -53 2 c-22 0 -30 0 -30 11c0 20 12 20 21 20l140 -3c23 0 82 3 105 3c8 0 13 -4 13 -11c0 -19 -11 -20 -16 -20c-57 -1 -58 -3 -69 -48c-4 -17 -9 -34 -13 -51l-19 -77c-5 -21 -15 -59 -17 -61c0 0 -2 -4 -7 -4c-10 0 -36 37 -45 62c-18 -20 -37 -41 -87 -61 c-36 -15 -81 -24 -125 -24c-162 0 -273 115 -273 274c0 232 225 453 448 453c111 0 157 -75 166 -89l70 77c11 11 12 12 15 12c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="786" y="0"></use>
<g transform="translate(1176,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="880" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2095" y="0"></use>
<g transform="translate(2540,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6F" x="880" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3617" y="0"></use>
</g>
</svg> function for Gaussian microfacet surfaces
that better accounts for the effects of correlation between the two
directions that we have implemented is due to Ross et
al.&nbsp;(<a href="#cite:Ross05">2005</a>).  Our derivation of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.868ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2096 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal upper Lamda left-parenthesis omega Subscript Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-39B" d="M661 0l-123 3c-38 0 -109 0 -144 -3v31c26 0 85 0 85 30c0 0 0 4 -5 18l-158 492l-150 -466c-5 -14 -5 -17 -5 -22c0 -24 23 -51 77 -52v-31l-113 3l-93 -3v31c70 0 90 39 100 69l192 595c5 17 7 21 23 21c11 0 17 -2 23 -21l200 -621c12 -37 15 -43 91 -43v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-39B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="694" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="1084" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1706" y="0"></use>
</g>
</svg>
function, Equation&nbsp;(<a href="../Reflection_Models/Roughness_Using_Microfacet_Theory.html#eq:microfacet-lambda">9.19</a>), follows Heitz
(<a href="#cite:Heitz2015">2015</a>).

</p>
<p>

</p>
<p>For many decades, Monte Carlo rendering of microfacet models involved
generating samples proportional to the microfacet distribution <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.326ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2723.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper D left-parenthesis omega Subscript normal h Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D437" d="M804 430c0 -219 -197 -430 -405 -430h-331c-19 0 -28 0 -28 12c0 19 11 19 28 19c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 11 -6 14 -22 16c-12 1 -30 2 -43 2c-20 0 -29 0 -29 12c0 19 11 19 30 19h336c150 0 235 -112 235 -253zM717 467c0 132 -83 185 -181 185 h-107c-43 0 -45 -3 -54 -38l-137 -549c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h113c123 0 202 76 231 113c85 110 105 274 105 323Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-68" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-348h1c16 36 60 96 144 96c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D437" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="828" y="0"></use>
<g transform="translate(1218,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-68" x="880" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2334" y="0"></use>
</g>
</svg>. Heitz
and d&rsquo;Eon (<a href="#cite:Heitz2014">2014</a>) were the first to demonstrate that it was possible to reduce
variance by restricting this sampling process to only consider visible
microfacets. Our microfacet sampling implementation in
Section&nbsp;<a href="../Reflection_Models/Roughness_Using_Microfacet_Theory.html#sec:microfacet">9.6</a> follows Heitz&rsquo;s improved approach
(<a href="#cite:Heitz2018:ggx-sample">2018</a>), which showed that sampling the visible area of
the Trowbridge&ndash;Reitz microfacet distribution corresponds to sampling the
projection of a truncated ellipsoid, which in turn can be performed using an
approach developed by Walter et&nbsp;al. (<a href="#cite:Walter2015">2015</a>).  See also Heitz
(<a href="#cite:Heitz2014a">2014</a>) for an overview of traditional techniques 
that directly sample the microfacet distribution <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.326ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2723.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper D left-parenthesis omega Subscript normal h Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D437" d="M804 430c0 -219 -197 -430 -405 -430h-331c-19 0 -28 0 -28 12c0 19 11 19 28 19c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 11 -6 14 -22 16c-12 1 -30 2 -43 2c-20 0 -29 0 -29 12c0 19 11 19 30 19h336c150 0 235 -112 235 -253zM717 467c0 132 -83 185 -181 185 h-107c-43 0 -45 -3 -54 -38l-137 -549c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h113c123 0 202 76 231 113c85 110 105 274 105 323Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-68" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-348h1c16 36 60 96 144 96c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D437" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="828" y="0"></use>
<g transform="translate(1218,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-68" x="880" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2334" y="0"></use>
</g>
</svg> 
without considering visibility.

</p>
<p>When dealing with refraction through rough
dielectrics, a modified change of variables term is needed to account for the
mapping from half vectors to outgoing direction. A model based on this approach
was originally developed by Stam&nbsp;(<a href="#cite:Stam:2001:AIM">2001</a>); Walter et&nbsp;al.
(<a href="#cite:Walter07">2007</a>) proposed improvements and provided an elegant geometric
justification of the half vector mapping of
Equation&nbsp;(<a href="../Reflection_Models/Rough_Dielectric_BSDF.html#eq:mf-transmission-change-of-vars">9.36</a>).
The generalized half-direction vector for refraction used in these models and in
Equation&nbsp;(<a href="../Reflection_Models/Rough_Dielectric_BSDF.html#eq:wm-microfacet-transmission">9.34</a>) is due to Sommerfeld and
Runge&nbsp;(<a href="#cite:Sommerfeld1911">1911</a>). 

</p>
<p>One issue with the specular term of the Torrance&ndash;Sparrow BRDF presented in
Section&nbsp;<a href="../Reflection_Models/Roughness_Using_Microfacet_Theory.html#sec:torrance-sparrow">9.6.5</a> is that it only models a single scattering
interaction with the microfacet surface, causing a growing portion of the
energy to be lost as the roughness increases. In scenes where many subsequent
interactions are crucial (e.g., a complex 3D object made from a translucent
rough dielectric material), this energy loss can become so conspicuous that
standard microfacet models become effectively unusable.

</p>
<p>The original model by Torrance and Sparrow&nbsp;(<a href="#cite:Torrance67">1967</a>) included a
diffuse component to simulate light having scattered multiple times.
However, a
simple diffuse correction is generally unsatisfactory, since the precise amount
of energy loss will depend both on the surface roughness and the angle of
incidence. Kelemen and Szirmay-Kalos (<a href="#cite:Kelemen2001:brdf">2001</a>) proposed an
improved diffuse-like term that accounts for this dependence. Jakob et
al.&nbsp;(<a href="#cite:Jakob2014a">2014a</a>) generalized their approach to rough dielectric
boundaries in the context of layered structures, where energy losses can be
particularly undesirable.

</p>
<p>In all of these cases, light is treated as essentially diffuse following
scattering by multiple facets. Building on Smith&rsquo;s uncorrelated height
assumption, Heitz et&nbsp;al. (<a href="#cite:Heitz2016:smith-multi">2016b</a>) cast a microfacet
BRDF model into a volumetric analogue composed of microflakes&mdash;that is, a
distribution of mirror facets suspended in a 3D space. With this new
interpretation, they are able to simulate an arbitrary number of volumetric
scattering interactions to evaluate an effective BRDF that is free of energy
loss and arguably closer to physical reality.

</p>
<p>Analytic solutions may sometimes obviate the need for a stochastic simulation
of interreflection. For example, Lee et&nbsp;al. (<a href="#cite:Lee2018">2018</a>) and Xie and
Hanrahan (<a href="#cite:Xie2018">2018</a>) both derived analytic models for multiple
scattering under the assumption of microfacets with a v-groove shape.  Efficient
approximate models for multiple scattering among microfacets were presented by
Kulla and Conty Estevez (<a href="#cite:Kulla2017">2017</a>) and by Turquin
(<a href="#cite:Turquin2019">2019</a>).

</p>
<p>Microfacet models have provided a foundation for a variety of additional
reflection models.  Simonot (<a href="#cite:Simonot2009">2009</a>) has developed a model that
spans Oren&ndash;Nayar&rsquo;s diffuse microfacet model (<a href="#cite:Oren94">1994</a>)
and Torrance&ndash;Sparrow: microfacets are
modeled as Lambertian reflectors with a layer above them that ranges from
perfectly transmissive to a perfect specular reflector. Conty Estevez and
Kulla (<a href="#cite:Conty2017">2017</a>) have developed a model for cloth.  The halo of a
softer and wider secondary highlight is often visible with rough surfaces.
Barla et&nbsp;al. (<a href="#cite:Barla2018">2018</a>) described a model for such surfaces with a
focus on perceptually meaningful parameters for it.

</p>
<p>Weyrich et&nbsp;al. (<a href="#cite:Weyrich09">2009</a>) have developed methods to infer a
microfacet distribution that matches a measured or desired reflection
distribution.  Remarkably, they showed that it is possible to manufacture
actual physical surfaces that match a desired reflection distribution
fairly accurately.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x8-LayeredMaterials"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x8-LayeredMaterials"></span><h4>Layered Materials</h4><p>


</p>
<p>Many materials are naturally composed of multiple layers&mdash;for example, a metal base
surface tarnished with patina, or wood with a varnish coating. Using a
specialized BRDF to represent such structures can be vastly more efficient than
resolving internal reflections using standard light transport methods.

</p>
<p>Hanrahan and Krueger (<a href="#cite:Hanrahan93">1993</a>) modeled the layers of skin,
accounting for just a single scattering event in each layer, and Dorsey and
Hanrahan (<a href="#cite:Dorsey1996">1996</a>) rendered layered materials using the
Kubelka&ndash;Munk theory, which accounts for multiple scattering within layers
but assumes that radiance distribution does not vary as a function of
direction.

</p>
<p>Pharr and Hanrahan (<a href="#cite:Pharr00">2000</a>) showed that Monte Carlo integration
could be used to solve the <em>adding equations</em> to efficiently compute
BSDFs for layered materials without needing either of these
simplifications.  The adding equations are integral equations that
accurately describe the effect of multiple scattering in layered media; they
were derived by van de Hulst (<a href="#cite:vanDeHulst80">1980</a>) and Twomey
et&nbsp;al. (<a href="#cite:Twomey1966">1966</a>).

</p>
<p>Weidlich and Wilkie (<a href="#cite:Weidlich2007">2007</a>) rendered layered materials
more efficiently by making a number of simplifying assumptions.  Guo
et&nbsp;al. (<a href="#cite:Guo2018">2018</a>) showed that both unidirectional and bidirectional Monte Carlo random
walks through layers led to efficient algorithms for evaluation, sampling,
and PDF evaluation.  (Their unidirectional approach is
implemented in <tt>pbrt</tt>&rsquo;s <a href="../Light_Transport_II_Volume_Rendering/Scattering_from_Layered_Materials.html#LayeredBxDF"><tt>LayeredBxDF</tt></a> in
Section&nbsp;<a href="../Light_Transport_II_Volume_Rendering/Scattering_from_Layered_Materials.html#sec:scattering-layered">14.3</a>.)  Xia et&nbsp;al. (<a href="#cite:Xia2020">2020a</a>)
described an improved importance sampling for this approach and Gamboa
et&nbsp;al. (<a href="#cite:Gamboa2020">2020</a>) showed that bidirectional sampling was
unnecessary and described a more efficient approach for multiple layers.

</p>
<p>Another approach for layered materials is to represent the aggregate scattering behavior of a
layered surface using a parametric representation.  Examples include Jakob
et&nbsp;al. (<a href="#cite:Jakob2014a">2014a</a>) and Zeltner and Jakob
(<a href="#cite:Zeltner2018">2018</a>), who applied the adding equations to discretized scattering
matrices describing volumetric layers and rough interfaces.
Guo et&nbsp;al. (<a href="#cite:Guo2017">2017</a>) modeled coated
surfaces using a modified microfacet scattering model.
Belcour (<a href="#cite:Belcour2018:layered">2018</a>) characterized
individual layers&rsquo; scattering statistically,
computed aggregate scattering using the adding equations, and then mapped the
result to sums of lobes based on the Trowbridge&ndash;Reitz microfacet
distribution function.  Weier and Belcour
(<a href="#cite:Weier2020">2020</a>) generalized this approach to handle anisotropic
reflection from the layer interfaces and Randrianandrasana et
al. (<a href="#cite:Randrianandrasana2021">2021</a>) further generalized the model to
improve accuracy and ensure energy conservation.

</p>
<p>It is possible to apply similar approaches to aggregate scattering at other
scales.  For example, Blumer et&nbsp;al. precomputed the effect of multiple
scattering in complex geometry like trees and stored the result in a form
that allows for efficient evaluation and sampling (<a href="#cite:Blumer2016">Blumer et al. 2016</a>).

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x8-BSDFRe-ParameterizationandAcquisition"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x8-BSDFRe-ParameterizationandAcquisition"></span><h4>BSDF (Re-)Parameterization and Acquisition</h4><p>


</p>
<p>Improvements in data-acquisition technology have led to increasing amounts of
detailed real-world BRDF data, even including BRDFs that are spatially varying
(sometimes called &ldquo;bidirectional texture functions,&rdquo; BTFs) (Dana
et&nbsp;al.&nbsp;<a href="#cite:Dana99">1999</a>).  See M&uuml;ller et&nbsp;al. (<a href="#cite:Muller05">2005</a>)
for a survey of work in BRDF measurement until the year 2005 and Guarnera et&nbsp;al.
(<a href="#cite:Guarnera2016">2016</a>) for a survey through the following decade.

</p>
<p>Fitting measured BRDF data to parametric reflection models is a difficult
problem.  Rusinkiewicz (<a href="#cite:Rusinkiewicz98">1998</a>) made the influential
observation that reparameterizing the measured data can make it substantially
easier to compress or fit to models. The topic of BRDF parameterizations has
also been investigated by Stark et&nbsp;al. (<a href="#cite:Stark05">2005</a>) and in Marscher&rsquo;s
Ph.D. dissertation (<a href="#cite:MarschnerPhd">1998</a>). 

</p>
<p>

</p>
<p>Building on Rusinkiewicz&rsquo;s parameterization, Matusik et&nbsp;al.
(<a href="#cite:Matusik03a">2003a</a>, <a href="#cite:Matusik03b">2003b</a>) designed a BRDF representation
and an efficient measurement device that repeatedly photographs a spherical
sample to simultaneously acquire BRDF evaluations for many directions. They
used this device to assemble a collection of isotropic material measurements
that is now known as the MERL BRDF database. Baek et&nbsp;al.&nbsp;(<a href="#cite:Baek2020">2020</a>)
extended this approach with additional optics to capture polarimetric BRDFs,
whose evaluation yields <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.165ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2223.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">4 times 4</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="1723" y="0"></use>
</g>
</svg> Mueller matrices that characterize how
reflection changes the polarization state of light. Nielsen et
al.&nbsp;(<a href="#cite:Nielsen2015">2015</a>) analyzed the manifold of MERL BRDFs to show that as
few as 10&ndash;20 carefully chosen measurements can produce high-quality BRDF
approximations.

</p>
<p>
Dupuy et&nbsp;al. (<a href="#cite:Dupuy2015">2015</a>) developed a simple iterative procedure for
fitting standard microfacet distributions to measured BRDFs. Dupuy and
Jakob&nbsp;(<a href="#cite:Dupuy2018">2018</a>) generalized this procedure to arbitrary
data-driven microfacet distributions and used the resulting approximation to
perform a measurement in reparameterized coordinates, which is the approach
underlying the <a href="../Reflection_Models/Measured_BSDFs.html#MeasuredBxDF"><tt>MeasuredBxDF</tt></a>. They then used a motorized goniophotometer
to spectroscopically acquire a collection of isotropic and anisotropic material
samples that can be loaded into <tt>pbrt</tt>.

</p>
<p>While the high-dimensional nature of reflectance functions can pose a serious
impediment in any acquisition procedure, the resulting data can often be
approximated much more compactly. Bagher et&nbsp;al. (<a href="#cite:Bagher2016">2016</a>)
decomposed the MERL database into a set of 1D factors requiring 3.2 KiB per material.
V&aacute;vra and Filip&nbsp;(<a href="#cite:Vavra2016">2016</a>) showed how lower-dimensional slices
can inform a sparse measurement procedure for anisotropic materials.

</p>
<p>









</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x8-HairFurandFibers"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x8-HairFurandFibers"></span><h4>Hair, Fur, and Fibers</h4><p>


</p>
<p>Kajiya and Kay (<a href="#cite:Kajiya89">1989</a>) were the first to develop a reflectance
model for hair fibers, observing the characteristic behavior of the underlying
cylindrical reflectance geometry. For example, a thin and ideally specular
cylinder under parallel illumination will reflect light into a 1D cone of
angles. Reflection from a rough cylinder tends to concentrate around the
specular 1D cone and decay with increasing angular distance. Kajiya and Kay
proposed a phenomenological model combining diffuse and specular terms sharing
these properties. For related work, see also the paper by Banks
(<a href="#cite:Banks94">1994</a>), which discusses basic shading models for 1D primitives
like hair.  Goldman (<a href="#cite:Goldman97">1997</a>) developed a probabilistic shading
model that models reflection from collections of short hairs.  Ward et&nbsp;al.&rsquo;s
survey (<a href="#cite:WardHair07">2007</a>) has extensive coverage of early research in
modeling, animating, and rendering hair.

</p>
<p>Marschner et&nbsp;al. (<a href="#cite:Marschner03">2003</a>) investigated the processes
underlying scattering from hair and performed a variety of measurements of
scattering from actual hair.  They introduced the longitudinal/azimuthal
decomposition and the use of the modified index of refraction to hair
rendering.  They then developed a scattering model where the longitudinal
component was derived by first considering perfect specular paths and
then allowing roughness by centering a Gaussian around them, and their
azimuthal model assumed perfect specular reflections.  They showed that
this model agreed reasonably well with their measurements.  Hery and
Ramamoorthi (<a href="#cite:Hery2012">2012</a>) showed how to sample the first term of
this model and Pekelis et&nbsp;al. (<a href="#cite:Pekelis2015">2015</a>) developed a more
efficient approach to sampling all of its terms.

</p>
<p>Zinke and Weber (<a href="#cite:Zinke2007">2007</a>) formalized different ways of
modeling scattering from hair and clarified the assumptions underlying each
of them.  Starting with the <em>bidirectional fiber scattering
distribution function</em> (BFSDF), which describes reflected differential
radiance at a point on a hair as a fraction of incident differential power
at another, they showed how assuming homogeneous scattering properties and
a far-away viewer and illumination made it possible to simplify the
eight-dimensional BFSDF to a four-dimensional <em>bidirectional curve
scattering distribution function</em> (BCSDF).  (Our implementation of the
<a href="../Reflection_Models/Scattering_from_Hair.html#HairBxDF"><tt>HairBxDF</tt></a> has glossed over some of these subtleties and opted for the
simplicity of considering the scattering model as a BSDF.)

</p>
<p>Sadeghi et&nbsp;al. (<a href="#cite:Sadeghi2010">2010</a>) developed a hair scattering model
with artist-friendly controls; Ou et&nbsp;al. (<a href="#cite:Ou2012">2012</a>) showed how to
sample from its distribution.  Ogaki et&nbsp;al. (<a href="#cite:Ogaki2010">2010</a>) created
a tabularized model by explicitly modeling hair microgeometry and following
random walks through it.

</p>
<p>D&rsquo;Eon et&nbsp;al. (<a href="#cite:dEon2011">2011</a>, <a href="#cite:dEon2013">2013</a>) made a number of
improvements to Marschner et&nbsp;al.&rsquo;s model.  They showed that their <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.313ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 1426.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper M Subscript p</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D440" d="M1044 672c0 -20 -9 -20 -32 -20c-75 0 -77 -10 -86 -46l-133 -533c-5 -18 -5 -20 -5 -24c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -13 -20 -19 -20c-41 0 -84 3 -125 3l-124 -3c-3 0 -15 0 -15 12c0 19 11 19 28 19c79 0 81 8 91 47l143 573h-1l-404 -633 c-5 -7 -11 -18 -22 -18c-12 0 -13 11 -15 23l-86 620h-1l-136 -545c-3 -11 -4 -16 -4 -23c0 -23 11 -43 68 -44c7 0 18 0 18 -11c0 -20 -13 -20 -18 -20c-33 0 -69 3 -103 3c-33 0 -68 -3 -100 -3c-8 0 -14 3 -14 12c0 18 13 19 18 19c81 3 98 35 108 75l127 509 c3 12 4 15 4 19c0 11 -6 14 -22 16c-12 1 -30 2 -43 2c-20 0 -29 0 -29 12c0 19 11 19 30 19h137c26 0 28 0 31 -23l78 -566l365 570c12 19 13 19 39 19h132c17 0 27 0 27 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45D" d="M490 282c0 -147 -125 -293 -241 -293c-51 0 -79 35 -92 64c-7 -25 -49 -188 -49 -200c0 -9 0 -16 50 -16c14 0 24 0 24 -11c0 -20 -13 -20 -18 -20c-32 0 -66 3 -99 3c-28 0 -57 -3 -84 -3c-8 0 -13 4 -13 12c0 19 11 19 23 19c44 0 46 7 54 41l112 445c4 17 7 28 7 51 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c37 0 80 -21 90 -75c33 39 81 75 131 75c76 0 133 -66 133 -160zM418 326c0 59 -24 94 -64 94c-17 0 -46 -7 -81 -38c-18 -15 -45 -43 -52 -70 l-49 -196c-3 -12 -3 -16 -3 -16c0 -6 13 -89 79 -89c37 0 85 33 119 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D440" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45D" x="1372" y="-213"></use>
</g>
</svg>
term was not actually energy conserving and derived a new one that was; this
is the model from Equation&nbsp;(<a href="../Reflection_Models/Scattering_from_Hair.html#eq:hair-mp">9.49</a>) that our implementation uses.
(See also d&rsquo;Eon (<a href="#cite:dEon2013:notes">2013</a>) for a more numerically stable
formulation of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.313ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 1426.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper M Subscript p</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D440" d="M1044 672c0 -20 -9 -20 -32 -20c-75 0 -77 -10 -86 -46l-133 -533c-5 -18 -5 -20 -5 -24c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -13 -20 -19 -20c-41 0 -84 3 -125 3l-124 -3c-3 0 -15 0 -15 12c0 19 11 19 28 19c79 0 81 8 91 47l143 573h-1l-404 -633 c-5 -7 -11 -18 -22 -18c-12 0 -13 11 -15 23l-86 620h-1l-136 -545c-3 -11 -4 -16 -4 -23c0 -23 11 -43 68 -44c7 0 18 0 18 -11c0 -20 -13 -20 -18 -20c-33 0 -69 3 -103 3c-33 0 -68 -3 -100 -3c-8 0 -14 3 -14 12c0 18 13 19 18 19c81 3 98 35 108 75l127 509 c3 12 4 15 4 19c0 11 -6 14 -22 16c-12 1 -30 2 -43 2c-20 0 -29 0 -29 12c0 19 11 19 30 19h137c26 0 28 0 31 -23l78 -566l365 570c12 19 13 19 39 19h132c17 0 27 0 27 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45D" d="M490 282c0 -147 -125 -293 -241 -293c-51 0 -79 35 -92 64c-7 -25 -49 -188 -49 -200c0 -9 0 -16 50 -16c14 0 24 0 24 -11c0 -20 -13 -20 -18 -20c-32 0 -66 3 -99 3c-28 0 -57 -3 -84 -3c-8 0 -13 4 -13 12c0 19 11 19 23 19c44 0 46 7 54 41l112 445c4 17 7 28 7 51 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c37 0 80 -21 90 -75c33 39 81 75 131 75c76 0 133 -66 133 -160zM418 326c0 59 -24 94 -64 94c-17 0 -46 -7 -81 -38c-18 -15 -45 -43 -52 -70 l-49 -196c-3 -12 -3 -16 -3 -16c0 -6 13 -89 79 -89c37 0 85 33 119 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D440" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45D" x="1372" y="-213"></use>
</g>
</svg> for low roughness, as well as Jakob
(<a href="#cite:Jakob2012">2012</a>) for notes related to sampling their <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.313ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 1426.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper M Subscript p</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D440" d="M1044 672c0 -20 -9 -20 -32 -20c-75 0 -77 -10 -86 -46l-133 -533c-5 -18 -5 -20 -5 -24c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -13 -20 -19 -20c-41 0 -84 3 -125 3l-124 -3c-3 0 -15 0 -15 12c0 19 11 19 28 19c79 0 81 8 91 47l143 573h-1l-404 -633 c-5 -7 -11 -18 -22 -18c-12 0 -13 11 -15 23l-86 620h-1l-136 -545c-3 -11 -4 -16 -4 -23c0 -23 11 -43 68 -44c7 0 18 0 18 -11c0 -20 -13 -20 -18 -20c-33 0 -69 3 -103 3c-33 0 -68 -3 -100 -3c-8 0 -14 3 -14 12c0 18 13 19 18 19c81 3 98 35 108 75l127 509 c3 12 4 15 4 19c0 11 -6 14 -22 16c-12 1 -30 2 -43 2c-20 0 -29 0 -29 12c0 19 11 19 30 19h137c26 0 28 0 31 -23l78 -566l365 570c12 19 13 19 39 19h132c17 0 27 0 27 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45D" d="M490 282c0 -147 -125 -293 -241 -293c-51 0 -79 35 -92 64c-7 -25 -49 -188 -49 -200c0 -9 0 -16 50 -16c14 0 24 0 24 -11c0 -20 -13 -20 -18 -20c-32 0 -66 3 -99 3c-28 0 -57 -3 -84 -3c-8 0 -13 4 -13 12c0 19 11 19 23 19c44 0 46 7 54 41l112 445c4 17 7 28 7 51 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c37 0 80 -21 90 -75c33 39 81 75 131 75c76 0 133 -66 133 -160zM418 326c0 59 -24 94 -64 94c-17 0 -46 -7 -81 -38c-18 -15 -45 -43 -52 -70 l-49 -196c-3 -12 -3 -16 -3 -16c0 -6 13 -89 79 -89c37 0 85 33 119 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D440" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45D" x="1372" y="-213"></use>
</g>
</svg> term in a
numerically stable way.)  They also introduced a Gaussian to the azimuthal
term, allowing for varying azimuthal roughness.  A 1D quadrature method was
used to integrate the model across the width of the hair&nbsp;<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.339ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 576.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">h</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-210E" d="M546 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 20 5 32 13 55c24 61 62 170 62 224c0 36 -11 70 -54 70s-74 -19 -96 -35c-34 -27 -65 -83 -68 -92c-1 -6 -9 -39 -11 -45c-5 -23 -11 -45 -17 -67l-22 -90l-19 -76c-5 -14 -21 -26 -37 -26c-9 0 -29 5 -29 28 c0 6 0 8 4 22l145 576l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-78 -318c37 46 85 77 148 77c75 0 115 -42 115 -107c0 -58 -45 -177 -61 -220c-9 -22 -18 -46 -18 -71c0 -23 7 -33 24 -33c55 0 87 71 102 124 c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-210E" x="0" y="0"></use>
</g>
</svg>.

</p>
<p>The RGB values used for the hair pigments in
<a href="../Reflection_Models/Scattering_from_Hair.html#HairBxDF::SigmaAFromConcentration"><tt>HairBxDF::SigmaAFromConcentration()</tt></a> were computed by d&rsquo;Eon et
al. (<a href="#cite:dEon2011">2011</a>), based on a model by Donner and Jensen
(<a href="#cite:Donner06a">2006</a>).
The function implemented in the <a href="../Reflection_Models/Scattering_from_Hair.html#HairBxDF::SigmaAFromReflectance"><tt>HairBxDF::SigmaAFromReflectance()</tt></a>
method is due to Chiang et&nbsp;al. (<a href="#cite:Chiang2016">2016a</a>), who created a cube of hair and
rendered it with a variety of absorption coefficients and roughnesses
while it was illuminated with a uniform white dome. They then fit a
function that mapped from the hair&rsquo;s azimuthal roughness and average color
at the center of the front face of the cube to an absorption coefficient.

</p>
<p>D&rsquo;Eon et&nbsp;al. (<a href="#cite:dEon2014">2014</a>) performed extensive Monte Carlo
simulations of scattering from dielectric cylinders with explicitly modeled
scales and glossy scattering at the boundary based on a Beckmann microfacet
distribution.  They showed that separable models did not model all the
observed effects and that in particular the specular term modeled by
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.313ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 1426.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper M Subscript p</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D440" d="M1044 672c0 -20 -9 -20 -32 -20c-75 0 -77 -10 -86 -46l-133 -533c-5 -18 -5 -20 -5 -24c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -13 -20 -19 -20c-41 0 -84 3 -125 3l-124 -3c-3 0 -15 0 -15 12c0 19 11 19 28 19c79 0 81 8 91 47l143 573h-1l-404 -633 c-5 -7 -11 -18 -22 -18c-12 0 -13 11 -15 23l-86 620h-1l-136 -545c-3 -11 -4 -16 -4 -23c0 -23 11 -43 68 -44c7 0 18 0 18 -11c0 -20 -13 -20 -18 -20c-33 0 -69 3 -103 3c-33 0 -68 -3 -100 -3c-8 0 -14 3 -14 12c0 18 13 19 18 19c81 3 98 35 108 75l127 509 c3 12 4 15 4 19c0 11 -6 14 -22 16c-12 1 -30 2 -43 2c-20 0 -29 0 -29 12c0 19 11 19 30 19h137c26 0 28 0 31 -23l78 -566l365 570c12 19 13 19 39 19h132c17 0 27 0 27 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45D" d="M490 282c0 -147 -125 -293 -241 -293c-51 0 -79 35 -92 64c-7 -25 -49 -188 -49 -200c0 -9 0 -16 50 -16c14 0 24 0 24 -11c0 -20 -13 -20 -18 -20c-32 0 -66 3 -99 3c-28 0 -57 -3 -84 -3c-8 0 -13 4 -13 12c0 19 11 19 23 19c44 0 46 7 54 41l112 445c4 17 7 28 7 51 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c37 0 80 -21 90 -75c33 39 81 75 131 75c76 0 133 -66 133 -160zM418 326c0 59 -24 94 -64 94c-17 0 -46 -7 -81 -38c-18 -15 -45 -43 -52 -70 l-49 -196c-3 -12 -3 -16 -3 -16c0 -6 13 -89 79 -89c37 0 85 33 119 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D440" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45D" x="1372" y="-213"></use>
</g>
</svg> varies over the surface of the cylinder and also depends on <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg>.
They developed a non-separable scattering model, where both <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">alpha</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="0" y="0"></use>
</g>
</svg> and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.991ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1287.7 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">beta Subscript m</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45A" d="M848 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 20 4 31 13 55c20 53 62 167 62 224c0 36 -11 70 -54 70c-109 0 -162 -120 -165 -133l-60 -241c-8 -32 -14 -57 -45 -57c-15 0 -29 9 -29 27c0 5 9 39 13 59c9 33 10 39 20 76l28 116c8 30 15 58 15 83 c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84c0 38 -15 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23 c0 0 -12 0 -12 10c0 3 13 62 31 97c9 18 28 57 74 57c45 0 87 -30 92 -87c17 23 66 87 156 87c25 0 57 -5 82 -26c28 -24 31 -58 32 -71c37 53 88 97 163 97s115 -42 115 -107c0 -57 -42 -168 -61 -220c-9 -22 -18 -46 -18 -71c0 -23 7 -33 24 -33c55 0 87 71 102 124 c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45A" x="801" y="-213"></use>
</g>
</svg> vary as a function of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.339ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 576.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">h</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-210E" d="M546 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 20 5 32 13 55c24 61 62 170 62 224c0 36 -11 70 -54 70s-74 -19 -96 -35c-34 -27 -65 -83 -68 -92c-1 -6 -9 -39 -11 -45c-5 -23 -11 -45 -17 -67l-22 -90l-19 -76c-5 -14 -21 -26 -37 -26c-9 0 -29 5 -29 28 c0 6 0 8 4 22l145 576l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-78 -318c37 46 85 77 148 77c75 0 115 -42 115 -107c0 -58 -45 -177 -61 -220c-9 -22 -18 -46 -18 -71c0 -23 7 -33 24 -33c55 0 87 71 102 124 c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-210E" x="0" y="0"></use>
</g>
</svg>, and showed that it fit their
simulations very accurately.

</p>
<p>All the scattering models we have described so far have been
BCSDFs&mdash;they represent the overall scattering across the entire width of
the hair in a single model.  Such &ldquo;far field&rdquo; models assume both that the
viewer is far away and that incident illumination is uniform across the
hair&rsquo;s width.  In practice, both of these assumptions are invalid if one is
using path tracing to model multiple scattering inside hair.  Two recent
models have considered scattering at a single point along the hair&rsquo;s width,
making them more suitable for accurately modeling &ldquo;near field&rdquo; scattering.

</p>
<p>Yan et&nbsp;al. (<a href="#cite:Yan2015:fur">2015</a>) generalized d&rsquo;Eon et&nbsp;al.&rsquo;s model to account
for scattering in the medulla, modeling a scattering cylinder in the
interior of fur, and validated their model with a variety of measurements
of actual animal fur.  Subsequent work developed an efficient model that
allows both near- and far-field evaluation (<a href="#cite:Yan2017:near-far-field">Yan et al. 2017a</a>).

</p>
<p>Chiang et&nbsp;al. (<a href="#cite:Chiang2016">2016a</a>) showed that eliminating the integral
over width from d&rsquo;Eon et&nbsp;al.&rsquo;s model works well in practice and that the
sampling rates necessary for path tracing also worked well to integrate
scattering over the curve width, giving a much more efficient
implementation.  They also developed the perceptually uniform
parameterization of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.991ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1287.7 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">beta Subscript m</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45A" d="M848 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 20 4 31 13 55c20 53 62 167 62 224c0 36 -11 70 -54 70c-109 0 -162 -120 -165 -133l-60 -241c-8 -32 -14 -57 -45 -57c-15 0 -29 9 -29 27c0 5 9 39 13 59c9 33 10 39 20 76l28 116c8 30 15 58 15 83 c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84c0 38 -15 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23 c0 0 -12 0 -12 10c0 3 13 62 31 97c9 18 28 57 74 57c45 0 87 -30 92 -87c17 23 66 87 156 87c25 0 57 -5 82 -26c28 -24 31 -58 32 -71c37 53 88 97 163 97s115 -42 115 -107c0 -57 -42 -168 -61 -220c-9 -22 -18 -46 -18 -71c0 -23 7 -33 24 -33c55 0 87 71 102 124 c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45A" x="801" y="-213"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.534ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1091.1 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">beta Subscript n</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="801" y="-213"></use>
</g>
</svg> that we have implemented in the
<a href="../Reflection_Models/Scattering_from_Hair.html#HairBxDF"><tt>HairBxDF</tt></a> as
well as the inverse mapping from reflectance to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.382ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1025.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">sigma Subscript normal a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70E" d="M567 407c0 -34 -36 -34 -49 -34h-110c31 -44 31 -92 31 -109c0 -154 -133 -275 -251 -275c-91 0 -150 70 -150 158c0 119 111 284 262 284h228c18 0 39 0 39 -24zM375 276c0 31 -8 97 -92 97c-34 0 -94 -14 -136 -83c-35 -59 -47 -141 -47 -171c0 -72 40 -108 89 -108 c39 0 93 26 132 85c34 51 54 133 54 180Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70E" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-61" x="808" y="-213"></use>
</g>
</svg> used in our
<a href="../Reflection_Models/Scattering_from_Hair.html#HairBxDF::SigmaAFromReflectance"><tt>HairBxDF::SigmaAFromReflectance()</tt></a> method.

</p>
<p>Further recent advances in hair and fur rendering include work by
Khungurn and Marschner (<a href="#cite:Khungurn2017">2017</a>), who developed a scattering
model from elliptical fibers and showed that modeling fibers as elliptical
rather than cylindrical gives a closer match to measured data.  Benamira
and Pattanaik (<a href="#cite:Benamira2021">2021</a>) recently proposed a model that
accounts for both elliptical fibers and diffraction effects, which are
significant at the scale of human hair.

</p>
<p>Modeling and rendering the individual fibers of fabric is closely related
to doing so for hair and fur.  Recent work includes Zhao
et&nbsp;al. (<a href="#cite:Zhao2016:yarn">2016</a>), who fit a procedural yarn model to CT-scanned
yarn, and Aliaga et&nbsp;al. (<a href="#cite:Aliaga2017">2017</a>), who demonstrated the
complexity of scattering from a variety of cloth fibers and developed
tabularized scattering functions for them using a precomputed simulation.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x8-GlintsandMicrostructure"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x8-GlintsandMicrostructure"></span><h4>Glints and Microstructure</h4><p>


</p>
<p>The microfacet reflection models in this chapter are all based on the
assumption that so many microfacets are visible in a pixel that they can be
accurately described by their aggregate statistical behavior.  This assumption
is not true for many real-world surfaces, where a relatively small number of
microfacets may be visible in each pixel; examples of such surfaces include
glittery car paint and plastics. Additionally, many types of rough surfaces
that aren&rsquo;t considered glittery (e.g., bead-blasted plastic) are characterized
by bright high-frequency glints under directionally peaked illumination
(e.g., the sun).

</p>
<p>A common characteristic of many glint-rendering techniques is that they replace
point evaluations of reflectance functions with a directional and/or spatial
average covering a small region (e.g., a ray differential). With such an
approach, a single sample suffices to find all glints visible within one pixel,
which dramatically accelerates the rendering process.

</p>
<p>One approach to rendering glints was introduced by Jakob et&nbsp;al.
(<a href="#cite:Jakob2014b">2014b</a>), who developed a temporally consistent stochastic process
that samples glint positions on the fly during evaluation of a
spatio-directional average. Wang et&nbsp;al. (<a href="#cite:Wang2018">2018</a>) showed that the
performance of this method could be improved by a separable approximation of
the spatial and directional dimensions. These stochastic methods are compact
but also very limited in terms of the glint distributions that can be modeled.

</p>
<p>In production rendering systems, fine surface details are often modeled using
bump- or normal maps. Glinty surface appearance tends to result when such
surfaces have high-resolution detail as well as a specular BRDF, and when they are
furthermore subject to sharp (e.g., point or directional) illumination. At the
same time, such configurations produce an extremely challenging Monte Carlo
integration problem that has motivated numerous specialized methods for
rendering normal-mapped specular surfaces.

</p>
<p>Yan et&nbsp;al. (<a href="#cite:Yan2014">2014</a>) proposed a method that organizes the normal
maps into a 4D spatio-directional data structure that can be queried to find
reflecting surface regions. Yan et&nbsp;al. (<a href="#cite:Yan2016">2016</a>) drastically reduced
the cost of reflectance queries by converting the normal map into a large
superposition of 4D Gaussian functions termed a <em>position-normal
distribution</em>. Though image fidelity is excellent, the overheads of these
methods can be significant: slow rendering in the former case, and lengthy
preprocessing and storage requirements in the second case. Zhu et&nbsp;al.
(<a href="#cite:Zhu2019">2019</a>) addressed both of these issues via clustering and runtime
synthesis of normal map detail.  Wang et&nbsp;al.
(<a href="#cite:Wang2020:microstructure">2020a</a>) substantially reduced the storage
requirements by using a semi-procedural model that matches the statistics of an
input texture. Zeltner et&nbsp;al. (<a href="#cite:Zeltner2020">2020</a>) proposed a Newton-like
equation-solving iteration that stochastically finds glints within texels of a
normal map. Atanasov et&nbsp;al.&nbsp;(<a href="#cite:Atanasov2021">2021</a>) developed a multi-level
data structure for finding glints around a given half vector.

</p>
<p>Other work in this area includes Raymond et&nbsp;al. (<a href="#cite:Raymond2016">2016</a>), who
developed methods for rendering scratched surfaces, and Kuznetsov et&nbsp;al., who
trained generative adversarial networks to represent microgeometry
(<a href="#cite:Kuznetsov2019">Kuznetsov et al. 2019</a>). Chermain et&nbsp;al. (<a href="#cite:Chermain2019">2019</a>)
incorporated the effect of multiple scattering among the microstructure facets in such
models, and Chermain et&nbsp;al. (<a href="#cite:Chermain2021">2021</a>) proposed a visible normal
sampling technique for glint NDF. Loubet et&nbsp;al. recently developed a technique for
sampling specular paths that is applicable to rendering caustics as well
as rendering glints (<a href="#cite:Loubet2020">2020</a>). 

</p>
<p>


</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x8-WaveOptics"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x8-WaveOptics"></span><h4>Wave Optics</h4><p>


</p>
<p>Essentially all physically based renderers are based on laws that approximate
wave-optical behavior geometrically. At a high level, these approximations are
sound given the large scale of depicted objects compared to the wavelength of
light. At the same time, wave-optical properties tend to make themselves
noticeable whenever geometric features occur at scales resembling the
wavelength of light, and such features may indeed be present even on objects
that are themselves drastically larger. 

</p>
<p>For example, consider a thin film of oil on a puddle, a tiny scratch on an
otherwise smooth metallic surface, or an object with micron-scale surface
microstructure. These cases can feature striking structural coloration caused
by the interference of light, which a purely geometric simulation would not be
able to reproduce. It may be tempting to switch to a full wave-optical
simulation of light in such cases, though this line of thought quickly runs
into fundamental limits: for example, using the Finite Difference Time Domain
(FDTD) method, the simulation domain would need to be discretized at
resolutions of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.169ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3947.8 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">less-than 100 normal n normal m</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-3C" d="M689 -9c24 -11 7 -47 -18 -36l-581 275c-17 8 -17 32 0 40l581 275c25 11 42 -25 18 -36l-548 -259Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-3C" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-31"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1001" y="0"></use>
</g>
<g transform="translate(2557,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6D" x="556" y="0"></use>
</g>
</g>
</svg> and simulated using sub-femtosecond timesteps. This
can still work when studying local behavior at the micron scale, but it is
practically infeasible for scenes measured in centimeters or even meters. These
challenges have motivated numerous specialized methods that reintroduce such
wave-optical effects within an otherwise geometric simulation.

</p>
<p>Moravec (<a href="#cite:Moravec81">1981</a>) was the first to apply a wave optics model to
computer graphics. Other early work in this area includes Bahar and Chakrabarti
(<a href="#cite:Bahar87">1987</a>) and Stam (<a href="#cite:Stam99">1999</a>), who modeled diffraction effects
from random and periodic structures. Cuypers et&nbsp;al. (<a href="#cite:Cuypers2012">2012</a>)
modeled multiple diffraction phenomena using signed BSDFs based on Wigner
Distribution Functions. 

</p>
<p>Musbach et&nbsp;al. (<a href="#cite:Musbach2013">2013</a>) applied the FDTD to obtain a BRDF of
the iridescent microstructure of a Morpho butterfly. Their paper provides
extensive references to previous work on this topic. Dhillon et&nbsp;al.
(<a href="#cite:Dhillon2014">2014</a>) developed a model of diffraction from small-scale
biological features such as are present in snake skin. Belcour and Barla
(<a href="#cite:Belcour2017:irid">2017</a>) modeled thin film iridescence on a rough microfacet
surface and showed the importance of this effect for materials such as leather
and how the resulting spectral variation can be efficiently calculated in an
RGB-based simulation. Werner et&nbsp;al. (<a href="#cite:Werner2017">2017</a>) developed a model
for rendering surfaces with iridescent scratches. Yan et&nbsp;al.
(<a href="#cite:Yan2018">2018</a>) presented a surface microstructure model that integrates
over a coherence area to produce iridescent glints, revealing substantial
differences between geometric and wave-based modeling. Toisoul and
Ghosh&nbsp;(<a href="#cite:Toisoul2017">2017</a>) presented a method for capturing and reproducing
the appearance of periodic grating-like structures. Xia et&nbsp;al.
(<a href="#cite:Xia2020:wave">2020b</a>) showed that diffraction and interference are meaningful
at the scale of fibers and developed a wave optics-based model for scattering
from fibers that they validated with measured data.

</p>
<p>In contrast to the above applications that reproduce dramatic goniochromatic
effects, several works have studied how wave-based modeling can improve
modeling of common materials (e.g., rough plastic or conductive surfaces).
L&ouml;w et&nbsp;al.&nbsp;(<a href="#cite:Low2012">2012</a>) proposed and compared geometric and
wave-based BRDF models in fits to materials to the MERL database. Dong et
al.&nbsp;(<a href="#cite:Dong2015">2015</a>) measured the surface microstructure of metal samples
using a profilometer and used it to construct geometric and wave-based models
that they then compared to goniophotometric measurements. Holzschuch and
Pacanowski (<a href="#cite:Holzschuch2017">2017</a>) integrated diffraction effects into a
microfacet model and showed that this gives a closer fit to measured data.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x8-AdditionalTopics"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x8-AdditionalTopics"></span><h4>Additional Topics</h4><p>


</p>
<p>The Lambertian BRDF is an idealized model; as noted earlier, it does not
match many real-world BRDFs precisely.  Oren and Nayar (<a href="#cite:Oren94">1994</a>)
proposed an improved model based on Lambertian microfacets that allowed the
specification of surface roughness.  d&rsquo;Eon has recently
(<a href="#cite:dEon2021">2021</a>) proposed a model based on scattering Lambertian
spheres that matches the appearance of many materials well.

</p>
<p>A number of researchers have investigated BRDFs based on modeling the
small-scale geometric features of a reflective surface.  This work includes
the computation of BRDFs from bump maps by Cabral, Max, and Springmeyer
(<a href="#cite:Cabral87">1987</a>); Fournier&rsquo;s normal distribution functions
(<a href="#cite:Fournier92">Fournier 1992</a>); and a technique by Westin, Arvo, and Torrance (<a href="#cite:Westin92">1992</a>),
who applied Monte Carlo ray tracing to statistically model reflection from
microgeometry and represented the resulting BRDFs with spherical harmonics.
Wu et&nbsp;al. (<a href="#cite:Wu2011">2011</a>) developed a system that made it possible to
model microgeometry and specify its underlying BRDF while interactively
previewing the resulting macro-scale BRDF, and Falster
et&nbsp;al. (<a href="#cite:Falster2020">2020</a>) computed BSDFs of microgeometry, accounting
for both multiple scattering and diffraction.

</p>
<p>The effect of the polarization of light is not modeled in <tt>pbrt</tt>, although
for some scenes it can be an important effect; see, for example, the paper
by Tannenbaum, Tannenbaum, and Wozny (<a href="#cite:Tannenbaum94">1994</a>) for
information about how to extend a renderer to account for this effect.
Fluorescence, where
light is reflected at different wavelengths than the incident illumination,
is also not modeled by <tt>pbrt</tt>; see Glassner (<a href="#cite:Glassner94">1994</a>) and
Wilkie et&nbsp;al. (<a href="#cite:Wilkie06">2006</a>) for more information on this topic.

</p>
<p>Modeling reflection from a variety of specific types of surfaces has
received attention from researchers, leading to specialized reflection
models.  Examples include wood (<a href="#cite:Marschner05">Marschner et&nbsp;al. 2005</a>), car paint
(<a href="#cite:Ergun2016">Ergun et al. 2016</a>), paper (<a href="#cite:Papas2014">Papas et al. 2014</a>), and pearlescent materials
(<a href="#cite:Guillen2020">Guill&eacute;n et al. 2020</a>).  Cloth remains a particularly challenging material to
render; see the recent survey by Castillo et&nbsp;al. (<a href="#cite:Castillo2019">2019</a>)
for comprehensive coverage of work in this area.

</p>
<p>Sampling BSDFs well is a key component of efficient image synthesis.
Sz&eacute;csi et&nbsp;al. (<a href="#cite:Szesci2003">2003</a>) evaluated different approaches for
sampling BSDFs that are comprised of multiple lobes.  It is often only
possible to sample some factors of a BSDF (e.g., when sampling the
Torrance&ndash;Sparrow BRDF using the distribution of visible microfacet
normals); Herholz et&nbsp;al. fit parametric sampling distributions to BSDFs in
an effort to sample them more effectively (<a href="#cite:Herholz2018">Herholz et al. 2018</a>).

</p>
<p><tt>pbrt</tt>&rsquo;s test suite uses statistical hypothesis tests to verify the
correctness of its BSDF sampling routines.  The idea of verifying such
graphics-related Monte Carlo sampling routines using statistical tests was
introduced by Subr and Arvo (<a href="#cite:Subr2007a">2007a</a>). The <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.509ex" height="2.843ex" style="vertical-align: -0.671ex;" viewBox="0 -934.9 1080.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">chi squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D712" d="M594 419c0 -3 0 -5 -11 -16l-238 -267c22 -77 90 -319 141 -319c19 0 44 16 53 40c3 10 4 14 14 14s12 -6 12 -11c0 -13 -27 -65 -85 -65c-89 0 -111 50 -124 80c-24 56 -36 95 -68 199l-229 -257c-4 -4 -9 -11 -16 -11c-6 0 -12 6 -12 12c0 3 0 5 11 16l230 257 c8 8 8 11 8 11c0 3 -32 119 -64 198c-17 44 -47 120 -77 120c-6 0 -38 -4 -53 -43c-2 -5 -4 -11 -13 -11c-12 0 -12 10 -12 10c0 14 26 66 84 66c88 0 110 -50 121 -73c23 -53 31 -78 71 -205l229 255c6 7 10 12 16 12c8 0 12 -6 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D712" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="886" y="513"></use>
</g>
</svg> test
variant that is used in <tt>pbrt</tt> was originally developed as part of the
<em>Mitsuba</em> renderer by Jakob (<a href="#cite:Jakob2010">2010</a>).

</p>
<p></p>
<h3>References</h3>
<ol style="list-style: none;">
<li class="bibitem" id="cite:Aliaga2017">Aliaga, C., C.&nbsp;Castillo, D.&nbsp;Guti&eacute;rrez, M.&nbsp;A.&nbsp;Otaduy, J.&nbsp;Lopez-Moreno, and A.&nbsp;Jarabo. 2017.
An appearance model for textile fibers.
<em>Computer Graphics Forum</em>&nbsp;<em>36</em>&thinsp;(4), 35&ndash;45.
</li>

<li class="bibitem" id="cite:Atanasov2021">Atanasov, A., A.&nbsp;Wilkie, V.&nbsp;Koylazov, and J.&nbsp;K<span>&#345;</span>iv&aacute;nek. 2021.
A multiscale microfacet model based on inverse bin mapping.
<em>Computer Graphics Forum (Proceedings of Eurographics)</em>&nbsp;<em>40</em>&thinsp;(2), 103&ndash;13.
</li>

<li class="bibitem" id="cite:Baek2020">Baek, S.-H., T.&nbsp;Zeltner, H.&nbsp;J.&nbsp;Ku, I.&nbsp;Hwang, X.&nbsp;Tong, W.&nbsp;Jakob, and M.&nbsp;H.&nbsp;Kim. 2020.
Image-based acquisition and modeling of polarimetric reflectance.
<em>ACM Transactions on Graphics (Proceedings of
SIGGRAPH)</em>&nbsp;<em>39</em>&thinsp;(4), 139:1&ndash;14.
</li>

<li class="bibitem" id="cite:Bagher2016">Bagher, M.&nbsp;M., J.&nbsp;M.&nbsp;Snyder, and D.&nbsp;Nowrouzezahrai. 2016.
A non-parametric factor microfacet model for isotropic BRDFs.
<em>ACM Transactions on Graphics</em>&nbsp;<em>35</em>&thinsp;(5), 159:1&ndash;16.
</li>

<li class="bibitem" id="cite:Bahar87">Bahar, E., and S.&nbsp;Chakrabarti. 1987.
Full-wave theory applied to computer-aided graphics for 3D objects.
<em>IEEE Computer Graphics and Applications</em>&nbsp;<em>7</em>&thinsp;(7), 46&ndash;60.
</li>

<li class="bibitem" id="cite:Banks94">Banks, D.&nbsp;C. 1994.
Illumination in diverse codimensions.
In <em>Proceedings of SIGGRAPH &rsquo;94</em>, Computer Graphics Proceedings,
  Annual Conference Series, 327&ndash;34.
</li>

<li class="bibitem" id="cite:Barla2018">Barla, P., R.&nbsp;Pacanowski, and P.&nbsp;Vangorp. 2018.
A composite BRDF model for hazy gloss.
<em>Computer Graphics Forum</em>&nbsp;<em>37</em>&thinsp;(4), 55&ndash;66.
</li>

<li class="bibitem" id="cite:Beckmann63">Beckmann, P., and A.&nbsp;Spizzichino. 1963.
<em>The Scattering of Electromagnetic Waves from Rough Surfaces</em>.
New York: Pergamon.
</li>

<li class="bibitem" id="cite:Belcour2018:layered">Belcour, L. 2018.
Efficient rendering of layered materials using an atomic decomposition with statistical operators.
<em>ACM Transactions on Graphics (Proceedings of
SIGGRAPH)</em>&nbsp;<em>37</em>&thinsp;(4), 73:1&ndash;15.
</li>

<li class="bibitem" id="cite:Belcour2017:irid">Belcour, L., and P.&nbsp;Barla. 2017.
A practical extension to microfacet theory for the modeling of varying iridescence.
<em>ACM Transactions on Graphics (Proceedings of
SIGGRAPH)</em>&nbsp;<em>36</em>&thinsp;(4), 65:1&ndash;14.
</li>

<li class="bibitem" id="cite:Benamira2021">Benamira, A., and S.&nbsp;Pattanaik. 2021.
A combined scattering and diffraction model for elliptical hair rendering.
<em>Computer Graphics Forum (Proceedings of EGSR 2021)</em>&nbsp;<em>40</em>&thinsp;(4),
163&ndash;75.
</li>

<li class="bibitem" id="cite:Blinn:1977:MOL">Blinn, J.&nbsp;F. 1977.
Models of light reflection for computer synthesized pictures.
<em>Computer Graphics (SIGGRAPH &rsquo;77 Proceedings)</em>
<em>11</em>, 192&ndash;98.
</li>

<li class="bibitem" id="cite:Blumer2016">Blumer, A., J.&nbsp;Nov&aacute;k, R.&nbsp;Habel, D.&nbsp;Nowrouzezahrai, and W.&nbsp;Jarosz. 2016.
Reduced aggregate scattering operators for path tracing.
<em>Computer Graphics Forum</em>&nbsp;<em>35</em>&thinsp;(7), 461&ndash;73.
</li>

<li class="bibitem" id="cite:Bracewell:Fourier">Bracewell, R.&nbsp;N. 2000.
<em>The Fourier Transform and Its Applications</em>. New York:
McGraw-Hill.
</li>

<li class="bibitem" id="cite:Cabral87">Cabral, B., N.&nbsp;Max, and R.&nbsp;Springmeyer. 1987.
Bidirectional reflection functions from surface bump maps.
<em>Computer Graphics (SIGGRAPH &rsquo;87 Proceedings)</em> <em>21</em>,
273&ndash;81.
</li>

<li class="bibitem" id="cite:Castillo2019">Castillo, C., J.&nbsp;L&oacute;pez-Moreno, and C.&nbsp;Aliaga. 2019.
Recent advances in fabric appearance reproduction.
<em>Computers &amp; Graphics</em>&nbsp;<em>84</em>, 103&ndash;21.
</li>

<li class="bibitem" id="cite:Chermain2021">Chermain, X., B.&nbsp;Sauvage, J.-M.&nbsp;Dischler, and C.&nbsp;Dachsbacher. 2021.
Importance sampling of glittering BSDFs based on finite mixture distributions.
<em>Proceedings of the Eurographics Symposium on Rendering</em>, 45&ndash;53.
</li>

<li class="bibitem" id="cite:Chermain2019">Chermain, X., F.&nbsp;Claux, and S.&nbsp;M&eacute;rillou. 2019.
Glint rendering based on a multiple-scattering patch BRDF.
<em>Computer Graphics Forum</em>&nbsp;<em>38</em>&thinsp;(4), 27&ndash;37.
</li>

<li class="bibitem" id="cite:Chiang2016">Chiang, M.&nbsp;J.-Y., B.&nbsp;Bitterli, C.&nbsp;Tappan, and B.&nbsp;Burley. 2016a.
A practical and controllable hair and fur model for production path
tracing.
<em>Computer Graphics Forum (Proceedings of Eurographics 2016)</em>
<em>35</em>&thinsp;(2), 275&ndash;83.
</li>

<li class="bibitem" id="cite:Collett93">Collett, E. 1993.
<em>Polarized Light: Fundamentals and Applications</em>. New York: Marcel
Dekker.
</li>

<li class="bibitem" id="cite:Conty2017">Conty Estevez, A., and C.&nbsp;Kulla. 2017.
Production friendly microfacet sheen BRDF.
<em>SIGGRAPH 2017 Talks</em>.
</li>

<li class="bibitem" id="cite:Cook81">Cook, R.&nbsp;L., and K.&nbsp;E. Torrance. 1981.
A reflectance model for computer graphics.
<em>Computer Graphics (SIGGRAPH &rsquo;81 Proceedings)</em> <em>15</em>,
307&ndash;16.
</li>

<li class="bibitem" id="cite:Cook82">Cook, R.&nbsp;L., and K.&nbsp;E. Torrance. 1982.
A reflectance model for computer graphics.
<em>ACM Transactions on Graphics</em>&nbsp;<em>1</em>&thinsp;(1), 7&ndash;24.
</li>

<li class="bibitem" id="cite:Cuypers2012">Cuypers, T., T.&nbsp;Haber, P.&nbsp;Bekaert, S.&nbsp;B.&nbsp;Oh, and R.&nbsp;Raskar. 2012.
Reflectance model for diffraction.
<em>ACM Transactions on Graphics</em>&nbsp;<em>31</em>&thinsp;(5), 122:1&ndash;11.
</li>

<li class="bibitem" id="cite:dEon2013:notes">d&rsquo;Eon, E. 2013.
Notes on <em>An energy-conserving hair reflectance model</em>.
</li>

<li class="bibitem" id="cite:dEon2021">d&rsquo;Eon, E. 2021.
An analytic BRDF for materials with spherical Lambertian scatterers.
<em>Computer Graphics Forum (Proceedings of EGSR)</em>&nbsp;<em>40</em>&thinsp;(4),
153&ndash;61.
</li>

<li class="bibitem" id="cite:dEon2011">d&rsquo;Eon, E., G.&nbsp;Francois, M.&nbsp;Hill, J.&nbsp;Letteri, and J.-M.&nbsp;Aubry. 2011.
An energy-conserving hair reflectance model.
<em>Computer Graphics Forum</em>&nbsp;<em>30</em>&thinsp;(4), 1181&ndash;87.
</li>

<li class="bibitem" id="cite:dEon2013">d&rsquo;Eon, E., S.&nbsp;Marschner, and J.&nbsp;Hanika. 2013.
Importance sampling for physically-based hair fiber models.
<em>SIGGRAPH Asia 2013 Technical Briefs</em>, 25:1&ndash;4.
</li>

<li class="bibitem" id="cite:dEon2014">d&rsquo;Eon, E., S.&nbsp;Marschner, and J.&nbsp;Hanika. 2014.
A fiber scattering model with non-separable lobes&mdash;supplemental report.
In <em>SIGGRAPH 2014 Talks</em>, 46:1.
</li>

<li class="bibitem" id="cite:Dana99">Dana, K.&nbsp;J., B.&nbsp;van Ginneken, S.&nbsp;K. Nayar, and J.&nbsp;J. Koenderink. 1999.
Reflectance and texture of real-world surfaces.
<em>ACM Transactions on Graphics</em>&nbsp;<em>18</em>&thinsp;(1), 1&ndash;34.
</li>

<li class="bibitem" id="cite:Dhillon2014">Dhillon, D.&nbsp;S., J.&nbsp;Teyssier, M.&nbsp;Single, I.&nbsp;Gaponenko, M.&nbsp;C.&nbsp;Milinkovitch, and M.&nbsp;Zwicker. 2014.
Interactive diffraction from biological nanostructures.
<em>Computer Graphics Forum</em>&nbsp;<em>33</em>&thinsp;(8), 177&ndash;88.
</li>

<li class="bibitem" id="cite:Dong2015">Dong, Z., B.&nbsp;Walter, S.&nbsp;Marschner, and D.&nbsp;P.&nbsp;Greenberg. 2015.
Predicting appearance from measured microgeometry of metal surfaces.
<em>ACM Transactions on Graphics</em>&nbsp;<em>35</em>&thinsp;(1), 9:1&ndash;13.
</li>

<li class="bibitem" id="cite:Donner06a">Donner, C., and H.&nbsp;W. Jensen. 2006.
A spectral BSSRDF for shading human skin.
<em>Rendering Techniques 2006: 17th Eurographics Workshop on Rendering</em>,
409&ndash;17.
</li>

<li class="bibitem" id="cite:Dorsey1996">Dorsey, J., and P.&nbsp;Hanrahan. 1996.
Modeling and rendering of metallic patinas.
In <em>Proceedings of SIGGRAPH &rsquo;96</em>, 387&ndash;96.
</li>

<li class="bibitem" id="cite:Dupuy2018">Dupuy, J., and W.&nbsp;Jakob. 2018.
An adaptive parameterization for efficient material acquisition and rendering.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>37</em>&thinsp;(6), 274:1&ndash;14.
</li>

<li class="bibitem" id="cite:Dupuy2015">Dupuy, J., E.&nbsp;Heitz, J.-C.&nbsp;Iehl, P.&nbsp;Poulin, and V.&nbsp;Ostromoukhov. 2015.
Extracting microfacet-based BRDF parameters from arbitrary materials with
power iterations.
<em>Computer Graphics Forum (Proceedings of the 2015 Eurographics
Symposium on Rendering)</em>&nbsp;<em>34</em>&thinsp;(4), 21&ndash;30.
</li>

<li class="bibitem" id="cite:Ergun2016">Ergun, S., S.&nbsp;&Ouml;nel, and A.&nbsp;Ozturk. 2016.
A general micro-flake model for predicting the appearance of car paint.
<em>Eurographics Symposium on Rendering&mdash;Experimental Ideas and
Implementations</em>, 65&ndash;71.
</li>

<li class="bibitem" id="cite:Falster2020">Falster, V., A.&nbsp;Jarabo, and J.&nbsp;R.&nbsp;Frisvad. 2020.
Computing the bidirectional scattering of a microstructure using scalar diffraction theory and path tracing.
<em>Computer Graphics Forum</em>&nbsp;<em>39</em>&thinsp;(7), 231&ndash;42.
</li>

<li class="bibitem" id="cite:Fournier92">Fournier, A. 1992.
Normal distribution functions and multiple surfaces.
<em>Graphics Interface &rsquo;92 Workshop on Local Illumination</em>, 45&ndash;52.
</li>

<li class="bibitem" id="cite:Gamboa2020">Gamboa, L.&nbsp;E., A.&nbsp;Gruson, and D.&nbsp;Nowrouzezahrai. 2020.
An efficient transport estimator for complex layered materials.
<em>Computer Graphics Forum</em>&nbsp;<em>39</em>&thinsp;(2), 363&ndash;71.
</li>

<li class="bibitem" id="cite:Glassner94">Glassner, A. 1994.
A model for fluorescence and phosphorescence.
<em>Proceedings of the Fifth Eurographics Workshop on Rendering</em>,
57&ndash;68.
</li>

<li class="bibitem" id="cite:Goldman97">Goldman, D.&nbsp;B. 1997.
Fake fur rendering.
<em>Proceedings of SIGGRAPH &rsquo;97</em>, Computer Graphics Proceedings,
  Annual Conference Series, 127&ndash;34.
</li>

<li class="bibitem" id="cite:Guarnera2016">Guarnera, D., G.&nbsp;Guarnera, A.&nbsp;Ghosh, C.&nbsp;Denk, and M.&nbsp;Glencross. 2016.
BRDF representation and acquisition.
<em>Computer Graphics Forum (Eurographics State of the Art
Report)</em>&nbsp;<em>35</em>&thinsp;(2), 625&ndash;50.
</li>

<li class="bibitem" id="cite:Guillen2020">Guill&eacute;n, I., J.&nbsp;Marco, D.&nbsp;Gutierrez, W.&nbsp;Jakob, and A.&nbsp;Jarabo. 2020.
A general framework for pearlescent materials. 
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>39</em>&thinsp;(6), 253:1&ndash;15.
</li>

<li class="bibitem" id="cite:Guo2017">Guo, J., J.&nbsp;Qian, Y.&nbsp;Guo. and J.&nbsp;Pan. 2017.
Rendering thin transparent layers with extended normal distribution functions.
<em>IEEE Transactions on Visualization &amp; Computer Graphics</em>&nbsp;<em>23</em>&thinsp;(9), 2108&ndash;19.
</li>

<li class="bibitem" id="cite:Guo2018">Guo, Y., M.&nbsp;Ha<span>&#353;</span>an, and S.&nbsp;Zhao. 2018.
Position-free Monte Carlo simulation for arbitrary layered BSDFs.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>37</em>&thinsp;(6), 279:1&ndash;14.
</li>

<li class="bibitem" id="cite:Hall89">Hall, R. 1989.
<em>Illumination and Color in Computer Generated Imagery</em>.
New York: Springer-Verlag.
</li>

<li class="bibitem" id="cite:Hanrahan93">Hanrahan, P., and W.&nbsp;Krueger. 1993.
Reflection from layered surfaces due to subsurface scattering.
<em>Computer Graphics (SIGGRAPH &rsquo;93 Proceedings)</em>, 165&ndash;74.
</li>

<li class="bibitem" id="cite:Heitz2014a">Heitz, E. 2014.
Understanding the masking-shadowing function in microfacet-based BRDFs.
<em>Journal of Computer Graphics Techniques (JCGT)</em>&nbsp;<em>3</em>&thinsp;(2),
32&ndash;91.
</li>

<li class="bibitem" id="cite:Heitz2015">Heitz, E. 2015.
Derivation of the microfacet <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.868ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2096 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal upper Lamda left-parenthesis omega Subscript Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-39B" d="M661 0l-123 3c-38 0 -109 0 -144 -3v31c26 0 85 0 85 30c0 0 0 4 -5 18l-158 492l-150 -466c-5 -14 -5 -17 -5 -22c0 -24 23 -51 77 -52v-31l-113 3l-93 -3v31c70 0 90 39 100 69l192 595c5 17 7 21 23 21c11 0 17 -2 23 -21l200 -621c12 -37 15 -43 91 -43v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-39B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="694" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="1084" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1706" y="0"></use>
</g>
</svg> function.
Personal communication.
</li>

<li class="bibitem" id="cite:Heitz2018:ggx-sample">Heitz, E. 2018.
Sampling the GGX distribution of visible normals.
<em>Journal of Computer Graphics Techniques (JCGT)</em>&nbsp;<em>7</em>&thinsp;(4), 1&ndash;13.
</li>

<li class="bibitem" id="cite:Heitz2014">Heitz, E., and E.&nbsp;d&rsquo;Eon. 2014.
Importance sampling microfacet-based BSDFs using the distribution
of visible normals.
<em>Computer Graphics Forum (Proceedings of the 2014 Eurographics
Symposium on Rendering)</em>&nbsp;<em>33</em>&thinsp;(4), 103&ndash;12.
</li>

<li class="bibitem" id="cite:Heitz2016:smith-multi">Heitz, E., J.&nbsp;Hanika, E.&nbsp;d&rsquo;Eon, and C.&nbsp;Dachsbacher. 2016b.
Multiple-scattering microfacet BSDFs with the Smith model.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH)</em>&nbsp;<em>35</em>&thinsp;(4), 58:1&ndash;14.
</li>

<li class="bibitem" id="cite:Herholz2018">Herholz, S., O.&nbsp;Elek, J.&nbsp;Schindel, J.&nbsp;K<span>&#345;</span>iv&aacute;nek, and H.&nbsp;P.&nbsp;A.&nbsp;Lensch. 2018.
A unified manifold framework for efficient BRDF sampling based on parametric mixture models.
<em>Eurographics Symposium on Rendering&mdash;Experimental Ideas and
Implementations</em>, 41&ndash;52.
</li>

<li class="bibitem" id="cite:Hery2012">Hery, C., and R.&nbsp;Ramamoorthi. 2012.
Importance sampling of reflection from hair fibers.
<em>Journal of Computer Graphics Techniques (JCGT)</em>&nbsp;<em>1</em>&thinsp;(1), 1&ndash;17.
</li>

<li class="bibitem" id="cite:Holzschuch2017">Holzschuch, N., and R.&nbsp;Pacanowski. 2017.
A two-scale microfacet reflectance model combining reflection and diffraction.
<em>ACM Transactions on Graphics (Proceedings of
SIGGRAPH)</em>&nbsp;<em>36</em>&thinsp;(4), 66:1&ndash;12.
</li>

<li class="bibitem" id="cite:Jakob2010">Jakob, W. 2010.
Mitsuba renderer.
<a href="http://www.mitsuba-renderer.org">http://www.mitsuba-renderer.org</a>.
</li>

<li class="bibitem" id="cite:Jakob2012">Jakob, W. 2012.
Numerically stable sampling of the von Mises Fisher distribution on <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.576ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 1109.1 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper S squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="926" y="513"></use>
</g>
</svg> (and other tricks).
<a href="https://www.mitsuba-renderer.org/&nbsp;wenzel/files/vmf.pdf">https://www.mitsuba-renderer.org/&nbsp;wenzel/files/vmf.pdf</a>.
</li>

<li class="bibitem" id="cite:Jakob2014a">Jakob, W., E.&nbsp;d&rsquo;Eon, O.&nbsp;Jakob, and S.&nbsp;Marschner. 2014a.
A comprehensive framework for rendering layered materials. 
<em>ACM Transactions on Graphics</em>&nbsp;<em>33</em>&thinsp;(4), 118:1&ndash;14.
</li>

<li class="bibitem" id="cite:Jakob2014b">Jakob, W., M.&nbsp;Ha<span>&#353;</span>an, L.-Q.&nbsp;Yan, J.&nbsp;Lawrence, R.&nbsp;Ramamoorthi,
and S.&nbsp;Marschner. 2014b.
Discrete stochastic microfacet models.
<em>ACM Transactions on Graphics</em>&nbsp;<em>33</em>&thinsp;(4), 115:1&ndash;10.
</li>

<li class="bibitem" id="cite:Kajiya85">Kajiya, J.&nbsp;T. 1985.
Anisotropic reflection models.
<em>Computer Graphics (Proceedings of SIGGRAPH &rsquo;85)</em> <em>19</em>,
15&ndash;21.
</li>

<li class="bibitem" id="cite:Kajiya89">Kajiya, J.&nbsp;T., and T.&nbsp;L. Kay. 1989.
Rendering fur with three dimensional textures.
<em>Computer Graphics (Proceedings of SIGGRAPH &rsquo;89)</em> <em>23</em>,
271&ndash;80.
</li>

<li class="bibitem" id="cite:Kelemen2001:brdf">Kelemen, C., and L.&nbsp;Szirmay-Kalos. 2001.
A microfacet based coupled specular-matte BRDF model with importance sampling.
<em>Eurographics 2001&mdash;Short Presentations</em>.
</li>

<li class="bibitem" id="cite:Khungurn2017">Khungurn, P., and S.&nbsp;Marschner. 2017.
Azimuthal scattering from elliptical hair fibers.
<em>ACM Transactions on Graphics</em>&nbsp;<em>36</em>&thinsp;(2), 13:1&ndash;23.
</li>

<li class="bibitem" id="cite:Kulla2017">Kulla, C., and A.&nbsp;Conty Estevez. 2017.
Revisiting physically based shading at Imageworks.
<em>SIGGRAPH 2017 Course Notes</em> <em>2</em>&thinsp;(3).
</li>

<li class="bibitem" id="cite:Kurt2010">Kurt, M., L.&nbsp;Szirmay-Kalos, and J.&nbsp;K<span>&#345;</span>iv&aacute;nek. 2010.
An anisotropic BRDF model for fitting and Monte Carlo rendering.
<em>SIGGRAPH Computer Graphics</em>&nbsp;<em>44</em>&thinsp;(1), 3:1&ndash;15.
</li>

<li class="bibitem" id="cite:Kuznetsov2019">Kuznetsov, A., M.&nbsp;Ha<span>&#353;</span>an, Z.&nbsp;Xu, L.-Q.&nbsp;Yan, B.&nbsp;Walter, N.&nbsp;K.&nbsp;Kalantari,
S.&nbsp;Marschner, and R.&nbsp;Ramamoorthi. 2019.
Learning generative models for rendering specular microgeometry.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>38</em>&thinsp;(6), 225:1&ndash;14.
</li>

<li class="bibitem" id="cite:Low2012">L&ouml;w, J., J.&nbsp;Kronander, A.&nbsp;Ynnerman, and J.&nbsp;Unger. 2012.
BRDF models for accurate and efficient rendering of glossy surfaces.
<em>ACM Transactions on Graphics</em>&nbsp;<em>31</em>&thinsp;(1), 9:1&ndash;14.
</li>

<li class="bibitem" id="cite:Lee2018">Lee, J.&nbsp;H., A.&nbsp;Jarabo, D.&nbsp;S.&nbsp;Jeon, D.&nbsp;Gutierrez, and M.&nbsp;H.&nbsp;Kim. 2018.
Practical multiple scattering for rough surfaces.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>37</em>&thinsp;(6), 275:1&ndash;12.
</li>

<li class="bibitem" id="cite:Loubet2020">Loubet, G., T.&nbsp;Zeltner, N.&nbsp;Holzschuch, and W.&nbsp;Jakob. 2020.
Slope-space integrals for specular next event estimation.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>39</em>&thinsp;(6), 239:1&ndash;13.
</li>

<li class="bibitem" id="cite:Muller05">M&uuml;ller, G., J.&nbsp;Meseth, M.&nbsp;Sattler, R.&nbsp;Sarlette, and R.&nbsp;Klein. 2005.
Acquisition, synthesis and rendering of bidirectional texture functions.
<em>Computer Graphics Forum (Eurographics State of the Art Report)</em>&nbsp;<em>24</em>&thinsp;(1),  83&ndash;109.
</li>

<li class="bibitem" id="cite:MarschnerPhd">Marschner, S. 1998.
Inverse rendering for computer graphics.
Ph.D. thesis, Cornell University.
</li>

<li class="bibitem" id="cite:Marschner03">Marschner, S.&nbsp;R., H.&nbsp;W. Jensen, M.&nbsp;Cammarano, S.&nbsp;Worley, and P.&nbsp;Hanrahan.
2003.
Light scattering from human hair fibers.
<em>ACM Transactions on Graphics</em>&nbsp;<em>22</em>&thinsp;(3), 780&ndash;91.
</li>

<li class="bibitem" id="cite:Marschner05">Marschner, S., S.&nbsp;Westin, A.&nbsp;Arbree, and J.&nbsp;Moon. 2005.
Measuring and modeling the appearance of finished wood.
In <em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
2005)</em>&nbsp;<em>24</em>&thinsp;(3),
727&ndash;34.
</li>

<li class="bibitem" id="cite:Matusik03a">Matusik, W., H.&nbsp;Pfister, M.&nbsp;Brand, and L.&nbsp;McMillan. 2003a.
Efficient isotropic BRDF measurement.
In <em>Proceedings of the 14th Eurographics Workshop on Rendering</em>, 241&ndash;47.
</li>

<li class="bibitem" id="cite:Matusik03b">Matusik, W., H.&nbsp;Pfister, M.&nbsp;Brand, and L.&nbsp;McMillan. 2003b.
A data-driven reflectance model.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
2003)</em>&nbsp;<em>22</em>&thinsp;(3), 759&ndash;69.
</li>

<li class="bibitem" id="cite:Moravec81">Moravec, H. 1981.
3D graphics and the wave theory.
In <em>Computer Graphics</em>, Volume&nbsp;15, 289&ndash;96.
</li>

<li class="bibitem" id="cite:Musbach2013">Musbach, A., G.&nbsp;W.&nbsp;Meyer, F.&nbsp;Reitich, and S.&nbsp;H.&nbsp;Oh. 2013.
Full wave modelling of light propagation and reflection.
<em>Computer Graphics Forum</em>&nbsp;<em>32</em>&thinsp;(6), 24&ndash;37.
</li>

<li class="bibitem" id="cite:Nielsen2015">Nielsen, J.&nbsp;B., H.&nbsp;W.&nbsp;Jensen, and R.&nbsp;Ramamoorthi. 2015.
On optimal, minimal BRDF sampling for reflectance acquisition.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>34</em>&thinsp;(6), 186:1&ndash;11.
</li>

<li class="bibitem" id="cite:Ogaki2010">Ogaki, S., Y.&nbsp;Tokuyoshi, and S.&nbsp;Schoellhammer. 2010.
An empirical fur shader.
In <em>SIGGRAPH Asia 2010 Sketches</em>, 16:1&ndash;2.
</li>

<li class="bibitem" id="cite:Oren94">Oren, M., and S.&nbsp;K. Nayar. 1994.
Generalization of Lambert&rsquo;s reflectance model.
In <em>Proceedings of SIGGRAPH &rsquo;94,  Computer Graphics Proceedings, Annual
  Conference Series</em>, 239&ndash;46. New York: ACM Press.
</li>

<li class="bibitem" id="cite:Ou2012">Ou, J., F.&nbsp;Xie, P.&nbsp;Krishnamachari, and F.&nbsp;Pellacini. 2012.
ISHair: Importance sampling for hair scattering.
<em>Computer Graphics Forum (Proceedings of the 2012 Eurographics Symposium on
Rendering)</em>&nbsp;<em>31</em>&thinsp;(4), 1537&ndash;45.
</li>

<li class="bibitem" id="cite:Papas2014">Papas, M., K.&nbsp;de Mesa, and H.&nbsp;W.&nbsp;Jensen. 2014.
A physically-based BSDF for modeling the appearance of paper.
<em>Computer Graphics Forum (Proceedings of the 2014 Eurographics
Symposium on Rendering)</em>&nbsp;<em>33</em>&thinsp;(4), 133&ndash;42.
</li>

<li class="bibitem" id="cite:Pekelis2015">Pekelis, L., C.&nbsp;Hery, R.&nbsp;Villemin, and J.&nbsp;Ling. 2015.
A data-driven light scattering model for hair.
<em>Pixar Technical Memo 15-02</em>.
</li>

<li class="bibitem" id="cite:Pharr00">Pharr, M., and P.&nbsp;M. Hanrahan. 2000.
Monte Carlo evaluation of non-linear scattering equations for
  subsurface reflection.
In <em>Proceedings of ACM SIGGRAPH 2000</em>, Computer Graphics
  Proceedings, Annual Conference Series, 75&ndash;84.
</li>

<li class="bibitem" id="cite:Phong75">Phong, B.-T. 1975.
Illumination for computer generated pictures.
<em>Communications of the ACM</em>&nbsp;<em>18</em>&thinsp;(6), 311&ndash;17.
</li>

<li class="bibitem" id="cite:Poulin90">Poulin, P., and A.&nbsp;Fournier. 1990.
A model for anisotropic reflection.
In <em>Computer Graphics (Proceedings of SIGGRAPH &rsquo;90)</em>, Volume&nbsp;24,
  273&ndash;82.
</li>

<li class="bibitem" id="cite:Randrianandrasana2021">Randrianandrasana, J., P.&nbsp;Callet, and L.&nbsp;Lucas. 2021.
Transfer matrix based layered materials rendering.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH)</em>&nbsp;<em>40</em>&thinsp;(4), 177:1&ndash;16.
</li>

<li class="bibitem" id="cite:Raymond2016">Raymond, B., G.&nbsp;Guennebaud, and P.&nbsp;Barla. 2016.
Multi-scale rendering of scratched materials using a structured SVBRDF model.
<em>ACM Transactions on Graphics (Proceedings of
SIGGRAPH)</em>&nbsp;<em>35</em>&thinsp;(4), 57:1&ndash;11.
</li>

<li class="bibitem" id="cite:Ribardiere2017">Ribardi&egrave;re, M., B.&nbsp;Bringier, D.&nbsp;Meneveaux, and L.&nbsp;Simonot. 2017.
STD: Student&rsquo;s t-distribution of slopes for microfacet based BSDFs.
<em>Computer Graphics Forum</em>&nbsp;<em>36</em>&thinsp;(2), 421&ndash;29.
</li>

<li class="bibitem" id="cite:Ribardiere2019">Ribardi&egrave;re, M., B.&nbsp;Bringier, L.&nbsp;Simonot, and D.&nbsp;Meneveaux. 2019.
Microfacet BSDFs generated from NDFs and explicit microgeometry.
<em>ACM Transactions on Graphics</em>&nbsp;<em>38</em>&thinsp;(5), 143:1&ndash;15.
</li>

<li class="bibitem" id="cite:Ross05">Ross, V., D. Dion, and G.&nbsp;Potvin. 2005.
Detailed analytical approach to the Gaussian surface bidirectional reflectance distribution function specular component applied to the sea surface. 
<em>Journal of the Optical Society of America</em>&nbsp;<em>22</em>&thinsp;(11),
  2442&ndash;53.
</li>

<li class="bibitem" id="cite:Rusinkiewicz98">Rusinkiewicz, S. 1998.
A new change of variables for efficient BRDF representation.
In <em>Proceedings of the Eurographics Rendering Workshop</em>, 11&ndash;23.
</li>

<li class="bibitem" id="cite:Sadeghi2010">Sadeghi, I., H.&nbsp;Pritchett, H.&nbsp;W.&nbsp;Jensen, and R.&nbsp;Tamstorf. 2010.
An artist friendly hair shading system.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH 2010)</em>&nbsp;<em>29</em>&thinsp;(4), 56:1&ndash;10.
</li>

<li class="bibitem" id="cite:Simonot2009">Simonot, L. 2009.
Photometric model of diffuse surfaces described as a distribution of
interfaced Lambertian facets. <em>Applied Optics</em>&nbsp;<em>48</em>&thinsp;(30), 5793&ndash;801.
</li>

<li class="bibitem" id="cite:Smith1967">Smith, B. 1967.
Geometrical shadowing of a random rough surface.
<em>IEEE Transactions on Antennas and Propagation</em>&nbsp;<em>15</em>&thinsp;(5), 668&ndash;71.
</li>

<li class="bibitem" id="cite:Sommerfeld1911">Sommerfeld, A., and J.&nbsp;Runge. 1911.
Anwendungen der vektorrechnung auf die grundlagen der geometrischen optik.
<em>Annalen der Physik</em>&nbsp;<em>340</em>&thinsp;(7), 277&ndash;98.
</li>

<li class="bibitem" id="cite:Stam99">Stam, J. 1999.
Diffraction shaders.
In <em>Proceedings of SIGGRAPH &rsquo;99</em>, Computer Graphics Proceedings,
  Annual Conference Series, 101&ndash;10.
</li>

<li class="bibitem" id="cite:Stam:2001:AIM">Stam, J. 2001.
An illumination model for a skin layer bounded by rough surfaces.
In <em>Rendering Techniques 2001: 12th Eurographics Workshop on
  Rendering</em>, 39&ndash;52.
</li>

<li class="bibitem" id="cite:Stark05">Stark, M., J.&nbsp;Arvo, and B.&nbsp;Smits. 2005.
Barycentric parameterizations for isotropic BRDFs.
<em>IEEE Transactions on Visualization and Computer
  Graphics</em>&nbsp;<em>11</em>&thinsp;(2),
126&ndash;38.
</li>

<li class="bibitem" id="cite:Stokes1860">Stokes, G.&nbsp;G. 1860. On the intensity of the light reflected from or transmitted through a pile of plates.
In <em>Proceedings of the Royal Society of London 11</em>, 545&ndash;56.
</li>

<li class="bibitem" id="cite:Subr2007a">Subr, K., and J.&nbsp;Arvo. 2007a.
Statistical hypothesis testing for assessing Monte
Carlo estimators: Applications to image synthesis.
In <em>Pacific Graphics &rsquo;97</em>, 106&ndash;15.
</li>

<li class="bibitem" id="cite:Szesci2003">Sz&eacute;csi, L., L.&nbsp;Szirmay-Kalos, and C.&nbsp;Kelemen. 2003.
Variance reduction for Russian roulette.
<em>Journal of the World Society for Computer Graphics (WSCG)</em> <em>11</em>&nbsp;(1).
</li>

<li class="bibitem" id="cite:Tannenbaum94">Tannenbaum, D.&nbsp;C., P.&nbsp;Tannenbaum, and M.&nbsp;J. Wozny. 1994.
Polarization and birefringency considerations in rendering.
In <em>Proceedings of SIGGRAPH &rsquo;94</em>, Computer Graphics Proceedings,
  Annual Conference Series, 221&ndash;22.
</li>

<li class="bibitem" id="cite:Toisoul2017">Toisoul, T., and A.&nbsp;Ghosh. 2017.
Practical acquisition and rendering of diffraction effects in surface reflectance.
<em>ACM Transactions on Graphics</em>&nbsp;<em>36</em>&thinsp;(5), 166:1&ndash;16.
</li>

<li class="bibitem" id="cite:Torrance67">Torrance, K.&nbsp;E., and E.&nbsp;M. Sparrow. 1967.
Theory for off-specular reflection from roughened surfaces.
<em>Journal of the Optical Society of America</em>&nbsp;<em>57</em>&thinsp;(9),
  1105&ndash;14.
</li>

<li class="bibitem" id="cite:Trowbridge1975">Trowbridge, S., and K.&nbsp;P.&nbsp;Reitz. 1975.
Average irregularity representation of a rough ray reflection.
<em>Journal of the Optical Society of America</em>&nbsp;<em>65</em>&thinsp;(5), 531&ndash;36.
</li>

<li class="bibitem" id="cite:Turquin2019">Turquin, E., 2019.
Practical multiple scattering compensation for microfacet models.
<em>Industrial Light &amp; Magic Technical Report</em>.
</li>

<li class="bibitem" id="cite:Twomey1966">Twomey, S., H.&nbsp;Jacobowitz, and H.&nbsp;B.&nbsp;Howell. 1966.
Matrix methods for multiple-scattering problems.
<em>Journal of the Atmospheric Sciences</em>&nbsp;<em>32</em>, 289&ndash;96.
</li>

<li class="bibitem" id="cite:Vavra2016">V&aacute;vra, R., and J.&nbsp;Filip. 2016.
Minimal sampling for effective acquisition of anisotropic BRDFs.
<em>Computer Graphics Forum</em>&nbsp;<em>35</em>&thinsp;(7), 299&ndash;309.
</li>

<li class="bibitem" id="cite:vanDeHulst80">van de Hulst, H.&nbsp;C. 1980.
<em>Multiple Light Scattering</em>.
New York: Academic Press.
</li>

<li class="bibitem" id="cite:Walter07">Walter, B., S.&nbsp;Marschner, H.&nbsp;Li, and K.&nbsp;Torrance. 2007.
Microfacet models for refraction through rough surfaces.
In <em>Rendering Techniques 2007 (Proc. Eurographics Symposium on
Rendering)</em>, 195&ndash;206.
</li>

<li class="bibitem" id="cite:Walter2015">Walter, B., Z.&nbsp;Dong, S.&nbsp;Marschner, and D.&nbsp;Greenberg. 2015.
The ellipsoid normal distribution function.
<em>Supplemental material of</em> Predicting
Appearance from Measured Microgeometry of Metal Surfaces, <em>ACM
Transactions on Graphics (Proceedings of SIGGRAPH)</em>&nbsp;<em>35</em>&thinsp;(4), 9:1&ndash;13.
</li>

<li class="bibitem" id="cite:Wang2018">Wang, B., L.&nbsp;Wang, and N.&nbsp;Holzschuch. 2018.
Fast global illumination with discrete stochastic microfacets using a filterable model.
<em>Computer Graphics Forum</em>&nbsp;<em>37</em>&thinsp;(7), 55&ndash;64.
</li>

<li class="bibitem" id="cite:Wang2020:microstructure">Wang, B., M.&nbsp;Ha<span>&#353;</span>an, N.&nbsp;Holzschuch, and L.-Q.&nbsp;Yan. 2020a.
Example-based microstructure rendering with constant storage.
<em>ACM Transactions on Graphics</em>&nbsp;<em>39</em>&thinsp;(5), 162:1&ndash;12.
</li>

<li class="bibitem" id="cite:WardHair07">Ward, K., F.&nbsp;Bertails, T.-Y.&nbsp;Kim, S.&nbsp;R.&nbsp;Marschner, M.-P.&nbsp;Cani, and
M.&nbsp;Lin. 2007.
A survey on hair modeling: Styling, simulation, and rendering.
<em>IEEE Transactions on Visualization and Computer
Graphics</em>&nbsp;<em>13</em>&thinsp;(2), 213&ndash;34.
</li>

<li class="bibitem" id="cite:Weidlich2007">Weidlich, A., and A.&nbsp;Wilkie. 2007.
Arbitrarily layered micro-facet surfaces.
In <em>Proceedings of the 5th International Conference on Computer
Graphics and Interactive Techniques in Australia and Southeast Asia
(GRAPHITE &rsquo;07)</em>, 171&ndash;78.
</li>

<li class="bibitem" id="cite:Weier2020">Weier, P., and L.&nbsp;Belcour. 2020.
Rendering layered materials with anisotropic interfaces.
<em>Journal of Computer Graphics Techniques (JCGT)</em>&nbsp;<em>9</em>&thinsp;(2), 37&ndash;57.
</li>

<li class="bibitem" id="cite:Werner2017">Werner, S., Z.&nbsp;Velinov, W.&nbsp;Jakob, and M.&nbsp;Hullin. 2017.
Scratch iridescence: Wave-optical rendering of diffractive surface structure. 
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>36</em>&thinsp;(6), 207:1&ndash;14.
</li>

<li class="bibitem" id="cite:Westin92">Westin, S., J.&nbsp;Arvo, and K.&nbsp;Torrance. 1992.
Predicting reflectance functions from complex surfaces.
<em>Computer Graphics</em>&nbsp;<em>26</em>&thinsp;(2), 255&ndash;64.
</li>

<li class="bibitem" id="cite:Weyrich09">Weyrich, T., P.&nbsp;Peers, W.&nbsp;Matusik, and S.&nbsp;Rusinkiewicz. 2009.
Fabricating microgeometry for custom surface reflectance.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
2008)</em>&nbsp;<em>28</em>&thinsp;(3),
32:1&ndash;6.
</li>

<li class="bibitem" id="cite:Wilkie06">Wilkie, A., A.&nbsp;Weidlich, C.&nbsp;Larboulette, and W.&nbsp;Purgathofer. 2006.
A reflectance model for diffuse fluorescent surfaces. 
In <em>Proceedings of GRAPHITE</em>, 321&ndash;31.
</li>

<li class="bibitem" id="cite:Wilkie2012">Wilkie, A., and A. Weidlich. 2012. Polarised light in
computer graphics. <em>SIGGRAPH Asia 2012 Course Notes.</em>
</li>

<li class="bibitem" id="cite:Wolff90">Wolff, L.&nbsp;B., and D.&nbsp;J. Kurlander. 1990.
Ray tracing with polarization parameters.
<em>IEEE Computer Graphics and Applications</em>&nbsp;<em>10</em>&thinsp;(6),
  44&ndash;55.
</li>

<li class="bibitem" id="cite:Wu2011">Wu, H., J.&nbsp;Dorsey, and H.&nbsp;Rushmeier. 2011.
Physically-based interactive bi-scale material design.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH Asia
2011)</em>&nbsp;<em>30</em>&thinsp;(6), 145:1&ndash;10.
</li>

<li class="bibitem" id="cite:Xia2020">Xia, M., B.&nbsp;Walter, C.&nbsp;Hery, and S.&nbsp;Marschner. 2020a.
Gaussian product sampling for rendering layered materials.
<em>Computer Graphics Forum</em>&nbsp;<em>39</em>&thinsp;(1), 420&ndash;35.
</li>

<li class="bibitem" id="cite:Xia2020:wave">Xia, M., B.&nbsp;Walter, E.&nbsp;Michielssen, D.&nbsp;Bindel, and S.&nbsp;Marschner. 2020b.
A wave optics based fiber scattering model.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>39</em>&thinsp;(6), 1&ndash;16.
</li>

<li class="bibitem" id="cite:Xie2018">Xie, F., and P.&nbsp;Hanrahan. 2018.
Multiple scattering from distributions of specular v-grooves.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>37</em>&thinsp;(6), 276:1&ndash;14.
</li>

<li class="bibitem" id="cite:Yan2015:fur">Yan, L.-Q., C.-W. Tseng, H.&nbsp;W. Jensen, and R.&nbsp;Ramamoorthi. 2015.
Physically-accurate fur reflectance: Modeling, measurement, and rendering.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH Asia
2015)</em>&nbsp;<em>34</em>&thinsp;(6), 185:1&ndash;13.
</li>

<li class="bibitem" id="cite:Yan2017:near-far-field">Yan, L.-Q., H.&nbsp;W.&nbsp;Jensen, and R.&nbsp;Ramamoorthi. 2017a.
An efficient and practical near and far field fur reflectance model.
<em>ACM Transactions on Graphics (Proceedings of
SIGGRAPH)</em>&nbsp;<em>36</em>&thinsp;(4), 67:1&ndash;13.
</li>

<li class="bibitem" id="cite:Yan2018">Yan, L.-Q., M.&nbsp;Ha<span>&#353;</span>an, B.&nbsp;Walter, S.&nbsp;Marschner, and R.&nbsp;Ramamoorthi. 2018.
Rendering specular microgeometry with wave optics.
<em>ACM Transactions on Graphics (Proceedings of
SIGGRAPH)</em>&nbsp;<em>37</em>&thinsp;(4), 75:1&ndash;10.
</li>

<li class="bibitem" id="cite:Yan2016">Yan, L.-Q., M.&nbsp;Ha<span>&#353;</span>an, S.&nbsp;Marschner, and R.&nbsp;Ramamoorthi. 2016.
Position-normal distributions for efficient rendering of specular microstructure.
<em>ACM Transactions on Graphics (Proceedings of
SIGGRAPH)</em>&nbsp;<em>35</em>&thinsp;(4), 56:1&ndash;9.
</li>

<li class="bibitem" id="cite:Yan2014">Yan, L.-Q., M.&nbsp;Ha<span>&#353;</span>an, W.&nbsp;Jakob, J.&nbsp;Lawrence, S.&nbsp;Marschner, and
R.&nbsp;Ramamoorthi. 2014.
Rendering glints on high-resolution normal-mapped specular surfaces.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
2014)</em>&nbsp;<em>33</em>&thinsp;(4), 116:1&ndash;9.
</li>

<li class="bibitem" id="cite:Zeltner2018">Zeltner, T., and W.&nbsp;Jakob. 2018.
The layer laboratory: A calculus for additive and subtractive composition
of anisotropic surface reflectance.
<em>ACM Transactions on Graphics (Proceedings of
SIGGRAPH)</em>&nbsp;<em>37</em>&thinsp;(4), 74:1&ndash;14.
</li>

<li class="bibitem" id="cite:Zeltner2020">Zeltner, T., I.&nbsp;Georgiev, and W.&nbsp;Jakob. 2020.
Specular manifold sampling for rendering high-frequency caustics and glints.
<em>ACM Transactions on Graphics (Proceedings of
SIGGRAPH)</em>&nbsp;<em>39</em>&thinsp;(4), 149:1&ndash;15.
</li>

<li class="bibitem" id="cite:Zhao2016:yarn">Zhao, S., F.&nbsp;Luan, and K.&nbsp;Bala. 2016.
Fitting procedural yarn models for realistic cloth rendering.
<em>ACM Transactions on Graphics (Proceedings of
SIGGRAPH)</em>&nbsp;<em>35</em>&thinsp;(4), 51:1&ndash;11.
</li>

<li class="bibitem" id="cite:Zhu2019">Zhu, J., Y.&nbsp;Xu, and L.&nbsp;Wang. 2019.
A stationary SVBRDF material modeling method based on discrete microsurface.
<em>Computer Graphics Forum</em>&nbsp;<em>38</em>&thinsp;(7), 745&ndash;54.
</li>

<li class="bibitem" id="cite:Zinke2007">Zinke, A., and A.&nbsp;Weber. 2007.
Light scattering from filaments.
<em>IEEE Transactions on Visualization and Computer
Graphics</em>&nbsp;<em>13</em>&thinsp;(2), 342&ndash;56.
</li>

</ol>
<p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md bg-light navbar-light">
<div class="container-fluid">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>,<br>
<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">&copy; 2004-2023</a> Matt Pharr, Wenzel Jakob, and Greg Humphreys.
<a href="https://github.com/mmp/pbr-book-website/"><span class="fab fa-github"></span></a><br>
Purchase a printed copy: <a href="https://www.amazon.com/Physically-Based-Rendering-fourth-Implementation/dp/0262048027?keywords=physically+based+rendering+4th+edition&qid=1671730412&sprefix=physically+based%!C(MISSING)aps%!C(MISSING)145&sr=8-1&linkCode=ll1&tag=pharr-20&linkId=81a816d90f0c7e872617f1f930a51fd6&language=en_US&ref_=as_li_ss_tl"><span class="fab fa-amazon"></span></a>
<a href="https://mitpress.mit.edu/9780262048026/physically-based-rendering/"><img src="/mitpress.png" width=10 height=16></a>
</span>
</div>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Reflection_Models/Exercises.html">Reflection Models / Exercises</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
