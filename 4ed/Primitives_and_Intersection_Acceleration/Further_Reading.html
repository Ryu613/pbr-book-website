
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="icon" href="/favicon.ico?v=2" /> <!-- force refresh -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="../pbrstyle.css">
  <link rel="stylesheet" href="/fontawesome-free-5.15.3-web/css/all.css">

<script async src="https://cse.google.com/cse.js?cx=22a43cef261a245ea"></script>  <script src="/react.min.js"></script>
  <script src="/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/bootstrap.min.css">

  <title>Further Reading</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand bg-light navbar-light">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Primitives_and_Intersection_Acceleration.html">Primitives and Intersection Acceleration</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">Further Reading</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Primitives_and_Intersection_Acceleration/Bounding_Volume_Hierarchies.html">(Previous: Bounding Volume Hierarchies)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<h2>Further Reading</h2><p>


</p>
<p>The stochastic alpha test implemented in Section&nbsp;<a href="../Primitives_and_Intersection_Acceleration/Primitive_Interface_and_Geometric_Primitives.html#sec:gprim">7.1.1</a> builds on
ideas introduced in Enderton et al.&rsquo;s stochastic approach for transparency
(<a href="#cite:Enderton2010">2010</a>) and Wyman and McGuire&rsquo;s hashed alpha testing
algorithm (<a href="#cite:Wyman2017">2017</a>), both of which were focused on
rasterization-based rendering.

</p>
<p>After the introduction of the ray-tracing algorithm, an enormous amount of
research was done to try to find effective ways to speed it up, primarily
by developing improved ray-tracing acceleration structures.  Arvo and
Kirk&rsquo;s chapter in <em>An Introduction to Ray Tracing</em>
(Glassner&nbsp;<a href="#cite:Glassner:IntroRayTracing">1989a</a>) summarizes the state of the
art as of 1989 and still provides an excellent taxonomy for categorizing
different approaches to ray intersection acceleration.

</p>
<p>Kirk and Arvo (<a href="#cite:Kirk88">1988</a>) introduced the unifying principle of
<em>meta-hierarchies.</em> They showed that by implementing acceleration data
structures to conform to the same interface as is used for primitives in
the scene, it is easy to mix and match different intersection acceleration
schemes.  <tt>pbrt</tt> follows this model.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x5-Grids"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x5-Grids"></span><h4>Grids</h4><p>


</p>
<p>Fujimoto, Tanaka, and Iwata (<a href="#cite:Fujimoto86">1986</a>) introduced uniform
grids, a spatial subdivision approach where the scene bounds are decomposed
into equally sized grid cells.  More efficient grid-traversal methods were
described by Amanatides and Woo (<a href="#cite:Amanatides87">1987</a>) and Cleary and
Wyvill (<a href="#cite:Cleary:1988:AOA">1988</a>).  Snyder and Barr (<a href="#cite:Snyder87">1987</a>)
described a number of key improvements to this approach and showed the use
of grids for rendering extremely complex scenes.  Hierarchical grids, where
grid cells with many primitives in them are themselves refined into grids,
were introduced by Jevans and Wyvill (<a href="#cite:Jevans89">1989</a>).  More
sophisticated techniques for hierarchical grids were developed by Cazals,
Drettakis, and Puech (<a href="#cite:Cazals95">1995</a>) and Klimaszewski and Sederberg
(<a href="#cite:Klimaszewski97">1997</a>).

</p>
<p>Ize et&nbsp;al. (<a href="#cite:Ize2006">2006</a>) developed an efficient algorithm for
parallel construction of grids.  One of their interesting findings was that
grid construction performance quickly became limited by memory bandwidth as
the number of cores used increased.

</p>
<p>Choosing an optimal grid resolution is important for getting good
performance from grids.  A good paper on this topic is by Ize
et&nbsp;al. (<a href="#cite:Ize07">2007</a>), who provided a solid foundation for
automatically selecting the resolution and for deciding when to refine into
subgrids when using hierarchical grids.  They derived theoretical results
using a number of simplifying assumptions and then showed the applicability
of the results to rendering real-world scenes.  Their paper also includes a
good selection of pointers to previous work in this area.

</p>
<p>Lagae and Dutr&eacute; (<a href="#cite:Lagae08a">2008a</a>) described an innovative
representation for uniform grids based on hashing that has the desirable
properties that not only does each primitive have a single index into a
grid cell, but also each cell has only a single primitive index.  They
showed that this representation has very low memory usage and is still quite
efficient.

</p>
<p>Hunt and Mark (<a href="#cite:Hunt08a">2008a</a>) showed that building grids in
perspective space, where the center of projection is the camera or a light
source, can make tracing rays from the camera or light substantially more
efficient.  Although this approach requires multiple acceleration
structures, the performance benefits from multiple specialized structures
for different classes of rays can be substantial.  Their approach is also
notable in that it is in some ways a middle ground between rasterization
and ray tracing.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x5-BoundingVolumeHierarchies"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x5-BoundingVolumeHierarchies"></span><h4>Bounding Volume Hierarchies</h4><p>


</p>
<p>Clark (<a href="#cite:Clark76">1976</a>) first suggested using bounding volumes to cull
collections of objects for standard visible-surface determination
algorithms.  Building on this work, Rubin and Whitted (<a href="#cite:Rubin80">1980</a>)
developed the first hierarchical data structures for scene representation
for fast ray tracing, although their method depended on the user to define
the hierarchy.  Kay and Kajiya (<a href="#cite:Kay86">1986</a>) implemented one of the
first practical object subdivision approaches based on bounding objects
with collections of slabs.

</p>
<p>Goldsmith and Salmon (<a href="#cite:Goldsmith87">1987</a>) described the first algorithm
for automatically computing bounding volume hierarchies. Although their
algorithm was based on estimating the probability of a ray intersecting a
bounding volume using the volume&rsquo;s surface area, it was much less
effective than modern SAH BVH approaches.  The first use of the SAH for BVH
construction was described by M&uuml;ller and Fellner
(<a href="#cite:Muller1999">1999</a>); another early application is due to Mass&oacute; and
L&oacute;pez (<a href="#cite:Masso2003">2003</a>).

</p>
<p>The <a href="../Primitives_and_Intersection_Acceleration/Bounding_Volume_Hierarchies.html#BVHAggregate"><tt>BVHAggregate</tt></a> implementation in this chapter is based on the
construction algorithm described by Wald (<a href="#cite:Wald07">2007</a>) and
G&uuml;nther et&nbsp;al. (<a href="#cite:Gunther2007">2007</a>).  The bounding box test is the
one introduced by Williams et&nbsp;al. (<a href="#cite:Williams05">2005</a>).  An even more
efficient bounding box test that does additional precomputation in exchange
for higher performance when the same ray is tested for intersection against
many bounding boxes was developed by Eisemann
et&nbsp;al. (<a href="#cite:Eisemann2007">2007</a>); we leave implementing their method for an
exercise.
Ize&rsquo;s robust ray&ndash;bounding box intersection algorithm ensures that the BVH
is <em>watertight</em> and that valid intersections are not missed due to
numeric error&nbsp;(<a href="#cite:Ize2013">Ize 2013</a>).

</p>
<p>The BVH traversal algorithm used in <tt>pbrt</tt> was concurrently developed by a
number of researchers; see the notes by Boulos and Haines
(<a href="#cite:Boulos2006">2006</a>) for more details and background.  Another option
for tree traversal is that of Kay and Kajiya (<a href="#cite:Kay86">1986</a>); they
maintained a heap of nodes ordered by ray distance.  On GPUs, which have
relatively limited amounts of on-chip memory, maintaining a stack of
to-be-visited nodes for each ray may have a prohibitive memory cost.  Foley
and Sugerman (<a href="#cite:Foley2005">2005</a>) introduced a &ldquo;stackless&rdquo; kd-tree
traversal algorithm that periodically backtracks and searches starting from
the tree root to find the next node to visit, rather than storing all nodes
to visit explicitly.  Laine (<a href="#cite:Laine2010">2010</a>) made a number of
improvements to this approach, reducing the frequency of re-traversals from
the tree root and applying the approach to BVHs.  See also Binder and
Keller (<a href="#cite:Binder2016">2016</a>), who applied perfect hashing to finding
subsequent nodes to visit with the stackless approach. 

</p>
<p>An innovative approach to BVH traversal is described by Hendrich
et&nbsp;al. (<a href="#cite:Hendrich2019">2019</a>), who created a spatio-directional 5D data
structure that records a set of BVH nodes that are used to seed the
traversal stack for sets of rays.  Given a particular ray, traversal starts
immediately with an appropriate stack, which in turn improves performance
by entirely skipping processing of BVH nodes that are either certain to be
intersected or certain not to be intersected for rays in a particular set.

</p>
<p>

</p>
<p>A number of researchers have developed techniques for improving the quality
of BVHs after construction.  Yoon et&nbsp;al. (<a href="#cite:Yoon2007">2007</a>) and Kensler
(<a href="#cite:Kensler08">2008</a>) presented algorithms that make local adjustments to
the BVH.  See also Bittner et&nbsp;al. (<a href="#cite:Bittner2013">2013</a>,
<a href="#cite:Bittner2014">2014</a>), Karras and Aila
(<a href="#cite:Karras2013">2013</a>), and
Meister and Bittner (<a href="#cite:Meister2018a">2018a</a>) for further work in this area.  An
interesting approach was described by Gu et&nbsp;al. (<a href="#cite:Gu2015">2015</a>), who
constructed a BVH, traced a relatively small number of representative rays, and
gathered statistics about how frequently each bounding box was intersected,
and then tuned the BVH to be more efficient for rays with similar
statistics.

</p>
<p>Most current methods for building BVHs are based on top-down construction
of the tree, first creating the root node and then partitioning the
primitives into children and continuing recursively.  An alternative
approach was demonstrated by Walter et&nbsp;al. (<a href="#cite:Walter08">2008</a>), who
showed that bottom-up construction, where the leaves are created first and
then agglomerated into parent nodes, is a viable option.  Gu
et&nbsp;al. (<a href="#cite:Gu2013b">2013b</a>) developed a much more efficient implementation
of this approach and showed its suitability for parallel implementation,
and Meister and Bittner (<a href="#cite:Meister2018b">2018b</a>) described a bottom-up
approach that is suitable for GPU implementation.

</p>
<p>One shortcoming of BVHs is that even a small number of relatively large
primitives that have overlapping bounding boxes can substantially reduce
the efficiency of the BVH: many of the nodes of the tree will be
overlapping, solely due to the overlapping bounding boxes of geometry down
at the leaves.  Ernst and Greiner (<a href="#cite:Ernst2007">2007</a>) proposed &ldquo;split
clipping&rdquo; as a solution; the restriction that each primitive only appears
once in the tree is lifted, and the bounding boxes of large input
primitives are subdivided into a set of tighter subbounds that are then
used for tree construction.

</p>
<p>Dammertz and Keller (<a href="#cite:Dammertz2008a">2008a</a>) observed that the
problematic primitives are the ones with a large amount of empty space in
their bounding box relative to their surface area, so they subdivided the
most egregious triangles and reported substantial performance improvements.
Stich et al. (<a href="#cite:Stich2009">2009</a>) developed an approach that splits
primitives during BVH construction, making it possible to only split
primitives when an SAH cost reduction was found.  See also Popov et al.&rsquo;s
paper (<a href="#cite:Popov2009">2009</a>) on a theoretically optimal BVH partitioning
algorithm and its relationship to previous approaches, and Karras and Aila
(<a href="#cite:Karras2013">2013</a>) for improved criteria for deciding when to split
triangles.  Woop et&nbsp;al. (<a href="#cite:Woop2014">2014</a>) developed an approach to
building BVHs for long, thin geometry like hair and fur; because this sort
of geometry is quite thin with respect to the volume of its bounding boxes,
it normally has poor performance with most acceleration structures.
Ganestam and Doggett (<a href="#cite:Ganestam2016">2016</a>) have proposed a splitting
approach that has benefits to both BVH construction and traversal
efficiency.

</p>
<p>The memory requirements for BVHs can be significant.  In our
implementation, each node is 32 bytes.  With up to 2 BVH nodes needed per
primitive in the scene, the total overhead may be as high as 64 bytes per
primitive.  Cline et&nbsp;al. (<a href="#cite:Cline2006">2006</a>) suggested a more compact
representation for BVH nodes, at some expense of efficiency.  First, they
quantized the bounding box stored in each node using 8 or 16 bytes to
encode its position with respect to the node&rsquo;s parent&rsquo;s bounding box.
Second, they used <em>implicit indexing</em>, where the node <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>&rsquo;s children
are at positions <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.965ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 846 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="500" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.968ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 2569.4 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 i plus 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1068" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2068" y="0"></use>
</g>
</svg> in the node array (assuming a <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.971ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1279 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 times</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="500" y="0"></use>
</g>
</svg>
branching factor).  They showed substantial memory savings, with moderate
performance impact.  Bauszat et&nbsp;al. (<a href="#cite:Bauszat2010">2010</a>) developed
another space-efficient BVH representation.  See also Segovia and Ernst
(<a href="#cite:Segovia2010">2010</a>), who developed compact representations of both BVH
nodes and triangle meshes.  A BVH specialized for space-efficient storage
of parametric surfaces was described by Selgrad
et&nbsp;al. (<a href="#cite:Selgrad2017">2017</a>) and an adoption of this approach for
displaced subdivision surfaces was presented by Lier
et&nbsp;al. (<a href="#cite:Lier2018">2018a</a>).

</p>
<p>Other work in the area of space-efficient BVHs includes that of
Vaidyanathan et&nbsp;al. (<a href="#cite:Vaidyanathan2016">2016</a>), who introduced a
reduced-precision representation of the BVH that still guarantees
conservative intersection tests with respect to the original BVH.  Liktor
and Vaidyanathan (<a href="#cite:Liktor2016">2016</a>) introduced a BVH node
representation based on clustering nodes that improves cache performance
and reduces storage requirements for child node pointers.  Ylitie et
al. (<a href="#cite:Ylitie2017">2017</a>) showed how to optimally convert binary BVHs
into wider BVHs with more children at each node, from which they derived a
compressed BVH representation that shows a substantial bandwidth reduction
with incoherent rays.  Vaidyanathan et&nbsp;al. (<a href="#cite:Vaidyanathan2019">2019</a>)
developed an algorithm for efficiently traversing such wide BVHs using a
small stack.  Benthin et&nbsp;al. (<a href="#cite:Benthin2018">2018</a>) focused on compressing
sets of adjacent leaf nodes of BVHs under the principle that most of the
memory is used at the leaves, and Lin et&nbsp;al. (<a href="#cite:Lin2019">2019</a>) described
an approach that saves both computation and storage by taking advantage of
shared planes among the bounds of the children of a BVH node.

</p>
<p>Yoon and Manocha (<a href="#cite:Yoon06b">2006</a>) described algorithms for
cache-efficient layout of BVHs and kd-trees and demonstrated performance
improvements from using them.  See also Ericson&rsquo;s book
(<a href="#cite:Ericson04">2004</a>) for extensive discussion of this topic.

</p>
<p>The linear BVH was introduced by Lauterbach
et&nbsp;al. (<a href="#cite:Lauterbach09">2009</a>); Morton codes were first described in a report by
Morton (<a href="#cite:Morton1966">1966</a>).  Pantaleoni and Luebke
(<a href="#cite:Pantaleoni2010a">2010</a>) developed the HLBVH generalization, using the
SAH at the upper levels of the tree.  They also noted that the upper bits
of the Morton-coded values can be used to efficiently find clusters of
primitives&mdash;both of these ideas are used in our HLBVH implementation.
Garanzha et&nbsp;al. (<a href="#cite:Garanzha2011">2011</a>) introduced further improvements

to the HLBVH, most of them targeting GPU implementations.  Vinkler
et&nbsp;al. (<a href="#cite:Vinkler2017">2017</a>) described improved techniques for mapping
values to the Morton index coordinates that lead to higher-quality BVHs,
especially for scenes with a range of primitive sizes.

</p>
<p>Wald (<a href="#cite:Wald2012">2012</a>) described an approach for high-performance
parallel BVH construction on CPUs that uses the SAH throughout.  More
recently, Benthin et&nbsp;al. (<a href="#cite:Benthin2017">2017</a>) have described a
two-level BVH construction technique based on building high-quality
second-level BVHs for collections of objects in a scene, collecting them
into a single BVH, and then iteratively refining the overall tree,
including moving subtrees from one of the initial BVHs to another.
Hendrich et&nbsp;al. (<a href="#cite:Hendrich2017">2017</a>) described a related technique,
quickly building an initial LBVH and then progressively
building a higher-quality BVH based on it.

</p>
<p>A comprehensive survey of work in bounding volume hierarchies, spanning
construction, representation, traversal, and hardware acceleration, was
recently published by Meister et al. (<a href="#cite:Meister2021">2021</a>).

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x5-kd-trees"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x5-kd-trees"></span><h4>kd-trees</h4><p>


</p>
<p>Glassner (<a href="#cite:Glassner84">1984</a>) introduced the use of octrees for ray
intersection acceleration.  Use of the kd-tree for ray tracing was first
described by Kaplan (<a href="#cite:Kaplan85">1985</a>).  Kaplan&rsquo;s tree construction
algorithm always split nodes down their middle; MacDonald and Booth
(<a href="#cite:MacDonald90">1990</a>) introduced the SAH approach, estimating ray&ndash;node
traversal probabilities using relative surface areas.  Naylor
(<a href="#cite:Naylor93">1993</a>) has also written on general issues of constructing
good kd-trees.  Havran and Bittner (<a href="#cite:Havran02">2002</a>) revisited many of
these issues and introduced useful improvements.  Adding a bonus factor to
the SAH for tree nodes that are completely empty
was suggested by Hurley et&nbsp;al. (<a href="#cite:Hurley02">2002</a>).  See
Havran&rsquo;s Ph.D. thesis (<a href="#cite:Havran2000">2000</a>) for an excellent overview of
high-performance kd-construction and traversal algorithms.

</p>
<p>Jansen (<a href="#cite:Jansen86">1986</a>) first developed the efficient ray-traversal
algorithm for kd-trees.  Arvo (<a href="#cite:Arvo88">1988</a>) also investigated this
problem and discussed it in a note in <em>Ray Tracing News</em>.  Sung and
Shirley (<a href="#cite:Sung92">1992</a>) described a ray-traversal algorithm&rsquo;s
implementation for a BSP-tree accelerator; our <a href="../Primitives_and_Intersection_Acceleration/Aggregates.html#KdTreeAggregate"><tt>KdTreeAggregate</tt></a>
traversal code (included in the online edition) is loosely based on theirs.

</p>
<p>The asymptotic complexity of the kd-tree construction algorithm in <tt>pbrt</tt> is <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.172ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 4810.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper O left-parenthesis n log squared n right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D442" d="M740 436c0 -239 -223 -458 -435 -458c-144 0 -256 101 -256 267c0 233 220 460 436 460c149 0 255 -108 255 -269zM651 475c0 149 -90 205 -172 205c-79 0 -177 -52 -246 -156c-77 -117 -91 -263 -91 -307c0 -132 70 -213 169 -213c84 0 166 59 214 120 c99 123 126 279 126 351Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6C" d="M255 0l-111 3l-111 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-618c0 -45 11 -45 78 -45v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-67" d="M485 404c0 -23 -19 -30 -29 -30c-16 0 -29 12 -29 29c0 12 5 23 16 27c-3 1 -10 1 -10 1c-18 0 -54 -5 -90 -39c25 -23 41 -60 41 -97c0 -77 -69 -146 -162 -146c-19 0 -60 3 -99 31c-17 -20 -17 -43 -17 -47c0 -32 21 -63 53 -67c7 -1 50 -1 75 -1c61 0 119 0 172 -28 c51 -28 65 -79 65 -114c0 -78 -104 -129 -222 -129c-122 0 -221 55 -221 127c0 40 32 83 92 100c-31 20 -44 58 -44 89c0 35 18 68 31 83c-25 21 -47 59 -47 103c0 77 69 146 162 146c22 0 64 -3 106 -36c42 41 86 47 106 47c39 0 51 -32 51 -49zM309 296 c0 23 0 123 -87 123c-40 0 -63 -28 -71 -40c-15 -25 -16 -57 -16 -84c0 -23 0 -123 87 -123c40 0 63 28 71 40c15 25 16 57 16 84zM419 -79c0 86 -112 86 -198 86h-59c-44 -3 -82 -40 -82 -86c0 -53 69 -104 170 -104c98 0 169 50 169 104Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D442" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="763" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="1153" y="0"></use>
<g transform="translate(1920,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6C"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-67" x="779" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="1809" y="596"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="3820" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4420" y="0"></use>
</g>
</svg>.  Wald and Havran (<a href="#cite:Wald06">2006</a>) showed that it is
possible to build kd-trees in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.118ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4356.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper O left-parenthesis n log n right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D442" d="M740 436c0 -239 -223 -458 -435 -458c-144 0 -256 101 -256 267c0 233 220 460 436 460c149 0 255 -108 255 -269zM651 475c0 149 -90 205 -172 205c-79 0 -177 -52 -246 -156c-77 -117 -91 -263 -91 -307c0 -132 70 -213 169 -213c84 0 166 59 214 120 c99 123 126 279 126 351Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6C" d="M255 0l-111 3l-111 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-618c0 -45 11 -45 78 -45v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-67" d="M485 404c0 -23 -19 -30 -29 -30c-16 0 -29 12 -29 29c0 12 5 23 16 27c-3 1 -10 1 -10 1c-18 0 -54 -5 -90 -39c25 -23 41 -60 41 -97c0 -77 -69 -146 -162 -146c-19 0 -60 3 -99 31c-17 -20 -17 -43 -17 -47c0 -32 21 -63 53 -67c7 -1 50 -1 75 -1c61 0 119 0 172 -28 c51 -28 65 -79 65 -114c0 -78 -104 -129 -222 -129c-122 0 -221 55 -221 127c0 40 32 83 92 100c-31 20 -44 58 -44 89c0 35 18 68 31 83c-25 21 -47 59 -47 103c0 77 69 146 162 146c22 0 64 -3 106 -36c42 41 86 47 106 47c39 0 51 -32 51 -49zM309 296 c0 23 0 123 -87 123c-40 0 -63 -28 -71 -40c-15 -25 -16 -57 -16 -84c0 -23 0 -123 87 -123c40 0 63 28 71 40c15 25 16 57 16 84zM419 -79c0 86 -112 86 -198 86h-59c-44 -3 -82 -40 -82 -86c0 -53 69 -104 170 -104c98 0 169 50 169 104Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D442" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="763" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="1153" y="0"></use>
<g transform="translate(1920,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6C"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-67" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="3366" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3966" y="0"></use>
</g>
</svg> time with some additional
implementation complexity; they reported a <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
</g>
</svg> to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.971ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1279 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">3 times</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="500" y="0"></use>
</g>
</svg> speedup in
construction time for typical scenes.

</p>
<p>The best kd-trees for ray tracing are built using &ldquo;perfect splits,&rdquo; where
the primitive being inserted into the tree is clipped to the bounds of the
current node at each step.  This eliminates the issue that, for example, an
object&rsquo;s bounding box may intersect a node&rsquo;s bounding box and thus be
stored in it, even though the object itself does not intersect the node&rsquo;s
bounding box.  This approach was introduced by Havran and Bittner
(<a href="#cite:Havran02">2002</a>) and discussed further by Hurley
et&nbsp;al. (<a href="#cite:Hurley02">2002</a>), Wald and Havran (<a href="#cite:Wald06">2006</a>), and
Soupikov et&nbsp;al. (<a href="#cite:Soupikov08">2008</a>).  Even with perfect splits, large
primitives may still be stored in many kd-tree leaves; Choi
et&nbsp;al. (<a href="#cite:Choi2013">2013</a>) suggested storing some primitives in interior
nodes to address this issue.

</p>
<p>kd-tree construction tends to be much slower than BVH construction
(especially if &ldquo;perfect splits&rdquo; are used), so parallel construction
algorithms are of particular interest.  Work in this area includes that of
Shevtsov et&nbsp;al. (<a href="#cite:Shevtsov07b">2007b</a>) and Choi
et&nbsp;al. (<a href="#cite:Choi2010">2010</a>), who presented efficient parallel kd-tree
construction algorithms with good scalability to multiple processors.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x5-TheSurfaceAreaHeuristic"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x5-TheSurfaceAreaHeuristic"></span><h4>The Surface Area Heuristic</h4><p>


</p>
<p>
A number of researchers have investigated improvements to the SAH since its
introduction to ray tracing by MacDonald and Booth
(<a href="#cite:MacDonald90">1990</a>).  Fabianowski et&nbsp;al. (<a href="#cite:Fabianowski2009">2009</a>)
derived a version that replaces the assumption that rays are uniformly
distributed throughout space with the assumption that ray origins are
uniformly distributed inside the scene&rsquo;s bounding box.  Hunt and Mark
(<a href="#cite:Hunt08b">2008b</a>) introduced a modified SAH that accounts for the fact that
rays generally are not uniformly distributed but rather that many of them
originate from a single point or a set of nearby points (cameras and light
sources, respectively).  Hunt (<a href="#cite:Hunt2008">2008</a>) showed how the SAH
should be modified when the &ldquo;mailboxing&rdquo; optimization is being used, and
Vinkler et&nbsp;al. (<a href="#cite:Vinkler2012">2012</a>) used assumptions about the
visibility of primitives to adjust their SAH cost.  Ize and Hansen
(<a href="#cite:Ize2011">2011</a>) derived a &ldquo;ray termination surface area heuristic&rdquo;
(RTSAH), which they used to adjust BVH traversal order for shadow rays in
order to more quickly find intersections with occluders.  See also Moulin
et&nbsp;al. (<a href="#cite:Moulin2015">2015</a>), who adapted the SAH to account for shadow
rays being occluded during kd-tree traversal.

</p>
<p>While the SAH has led to very effective kd-trees and BVHs, a number of
researchers have noted that it is not unusual to encounter cases where a
kd-tree or BVH with a higher SAH-estimated cost gives better performance
than one with lower estimated cost.  Aila et&nbsp;al. (<a href="#cite:Aila2013">2013</a>)
surveyed some of these results and proposed two additional heuristics that
help address them; one accounts for the fact that most rays start on
surfaces&mdash;ray origins are not actually randomly distributed throughout the
scene&mdash;and another accounts for SIMD divergence when multiple rays traverse
the hierarchy together.  While these new heuristics are effective at
explaining why a given tree delivers the performance that it does, it is
not yet clear how to incorporate them into tree construction algorithms.

</p>
<p>Evaluating the SAH can be costly, particularly when many different splits
or primitive partitions are being considered.  One solution to this problem
is to only compute it at a subset of the candidate points&mdash;for example,
along the lines of the bucketing approach used in the <a href="../Primitives_and_Intersection_Acceleration/Bounding_Volume_Hierarchies.html#BVHAggregate"><tt>BVHAggregate</tt></a> in
<tt>pbrt</tt>.  Hurley et&nbsp;al. (<a href="#cite:Hurley02">2002</a>) suggested this approach for
building kd-trees, and Popov et&nbsp;al. (<a href="#cite:Popov06">2006</a>) discussed it in
detail.  Shevtsov et&nbsp;al. (<a href="#cite:Shevtsov07b">2007b</a>) introduced the
improvement of binning the full extents of triangles, not just their
centroids.

</p>
<p>Wodniok and Goesele constructed BVHs where the SAH cost estimate is not based
on primitive counts and primitive bounds but is instead found by actually
building BVHs for various partitions and computing their SAH cost
(<a href="#cite:Wodniok2016">Wodniok and Goesele 2016</a>).  They showed a meaningful improvement in ray
intersection performance, though at a cost of impractically long BVH
construction times.

</p>
<p>Hunt et&nbsp;al. (<a href="#cite:Hunt2006">2006</a>) noted that if you only have to evaluate
the SAH at one point, for example, you do not need to sort the primitives
but only need to do a linear scan over them to compute primitive counts and
bounding boxes at the point.  <tt>pbrt</tt>&rsquo;s implementation follows that approach.
They also showed that approximating the SAH with a piecewise quadratic
based on evaluating it at a number of individual positions, and using that
to choose a good split, leads to effective trees.  A similar approximation
was used by Popov et&nbsp;al. (<a href="#cite:Popov06">2006</a>).

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x5-OtherTopicsinAccelerationStructures"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x5-OtherTopicsinAccelerationStructures"></span><h4>Other Topics in Acceleration Structures</h4><p>


</p>
<p>Weghorst, Hooper, and Greenberg (<a href="#cite:Weghorst84">1984</a>) discussed the
trade-offs of using various shapes for bounding volumes and suggested
projecting objects to the screen and using a <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg>-buffer rendering to
accelerate finding intersections for camera rays.

</p>
<p>A number of researchers have investigated the applicability of general BSP
trees, where the splitting planes are not necessarily axis aligned, as they
are with kd-trees.  Kammaje and Mora (<a href="#cite:Kammaje07">2007</a>) built BSP trees
using a preselected set of candidate splitting planes. Budge
et&nbsp;al. (<a href="#cite:Budge2008">2008</a>) developed a number of improvements to their
approach, though their results only approached kd-tree performance in
practice due to a slower construction stage and slower traversal than
kd-trees.  Ize et&nbsp;al. (<a href="#cite:Ize08">2008</a>) showed a BSP implementation that
renders scenes faster than kd-trees but at the cost of extremely long
construction times.

</p>
<p>There are many techniques for traversing a collection of rays through the
acceleration structure together, rather than just one at a time.  This
approach (&ldquo;packet tracing&rdquo;) is an important component of many high-performance
ray tracing approaches; it is discussed in more detail in
Section&nbsp;<a href="../Retrospective_and_the_Future/Design_Alternatives.html#sec:packet-tracing">16.2.3</a>.

</p>
<p>Animated primitives present two challenges to ray tracers: first, renderers
that try to reuse acceleration structures over multiple frames of an
animation must update the acceleration structures if objects are moving.
Lauterbach et&nbsp;al. (<a href="#cite:Lauterbach2006">2006</a>) and Wald
et&nbsp;al. (<a href="#cite:Wald07a">2007a</a>) showed how to incrementally update BVHs in this
case, and Kopta et&nbsp;al. (<a href="#cite:Kopta2012">2012</a>) reused BVHs over multiple
frames of an animation, maintaining their quality by updating the parts
that bound moving objects. Garanzha (<a href="#cite:Garanzha2009">2009</a>) suggested
creating clusters of nearby primitives and then building BVHs of those
clusters (thus lightening the load on the BVH construction algorithm).

</p>
<p>A second challenge from animated primitives is that for primitives that are
moving quickly, the bounding boxes of their full motion over the frame time
may be quite large, leading to many unnecessary ray&ndash;primitive intersection
tests.  Notable work on this issue includes Glassner
(<a href="#cite:Glassner1988">1988</a>), who generalized ray tracing (and an octree for
acceleration) to four dimensions, adding time.  More recently,
Gr&uuml;nschlo&szlig; et&nbsp;al. (<a href="#cite:Grunschloss2011">2011</a>) developed
improvements to BVHs for moving primitives.  See also Wald et&nbsp;al.&rsquo;s
(<a href="#cite:Wald2007b">2007b</a>) survey paper on ray tracing animated scenes.  Woop
et&nbsp;al. (<a href="#cite:Woop2017">2017</a>) described a generalization of BVHs that also
allows nodes to split in time, with child nodes of such a split accounting
for different time ranges.

</p>
<p>

</p>
<p>An innovative approach to acceleration structures was suggested by Arvo and
Kirk (<a href="#cite:Arvo87">1987</a>), who introduced a 5D data structure that
subdivided based on both 3D spatial and 2D ray directions.  Another
interesting approach for scenes described with triangle meshes was
developed by Lagae and Dutr&eacute; (<a href="#cite:Lagae08b">2008b</a>): they computed a
constrained tetrahedralization, where all triangle faces of the model are
represented in the tetrahedralization.  Rays are then stepped through
tetrahedra until they intersect a triangle from the scene description.
This approach is still a few times slower than the state of the art in
kd-trees and BVHs but is an interesting new way to think about the problem.

</p>
<p>There is a middle ground between kd-trees and BVHs, where the
tree node holds a splitting plane for each child rather than just a single
splitting plane.  This refinement makes it possible to do object
subdivision in a kd-tree-like acceleration structure, putting each
primitive in just one subtree and allowing the subtrees to overlap, while
still preserving many of the benefits of efficient kd-tree traversal.  Ooi
et&nbsp;al. (<a href="#cite:Ooi87">1987</a>) first introduced this refinement to kd-trees for
storing spatial data, naming it the &ldquo;spatial kd-tree&rdquo; (skd-tree).
Skd-trees have been applied to ray tracing by a number of
researchers, including Zachmann (<a href="#cite:Zachmann02">2002</a>), Woop
et&nbsp;al. (<a href="#cite:Woop06">2006</a>), W&auml;chter and Keller
(<a href="#cite:Wachter2006">2006</a>), Havran et&nbsp;al. (<a href="#cite:Havran06">2006</a>), and Zuniga
and Uhlmann (<a href="#cite:Zuniga06">2006</a>).

</p>
<p>When spatial subdivision approaches like grids or kd-trees are used,
primitives may overlap multiple nodes of the structure and a ray may be
tested for intersection with the same primitive multiple times as it passes
through the structure.  Arnaldi, Priol, and Bouatouch
(<a href="#cite:Arnaldi87">1987</a>) and Amanatides and Woo (<a href="#cite:Amanatides87">1987</a>)
developed the &ldquo;mailboxing&rdquo; technique to address this issue: each ray is
given a unique integer identifier, and each primitive records the id of the
last ray that was tested against it.  If the ids match, then the
intersection test is unnecessary and can be skipped.

</p>
<p>While effective, mailboxing does not work well with a multi-threaded ray
tracer.  To address this issue, Benthin (<a href="#cite:Benthin2006">2006</a>) suggested
storing a small per-ray hash table to record ids of recently intersected
primitives. Shevtsov et&nbsp;al. (<a href="#cite:Shevtsov07a">2007a</a>) maintained a small
array of the last <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">n</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="0" y="0"></use>
</g>
</svg> intersected primitive ids and searched it linearly
before performing intersection tests. Although some primitives may still be
checked multiple times with both of these approaches, they usually
eliminate most redundant tests.

</p>
<p></p>
<h3>References</h3>
<ol style="list-style: none;">
<li class="bibitem" id="cite:Aila2013">Aila, T., T.&nbsp;Karras, and S.&nbsp;Laine. 2013.
On quality metrics of bounding volume hierarchies.
In <em>Proceedings of High Performance Graphics 2013</em>, 101&ndash;7.
</li>

<li class="bibitem" id="cite:Moller01">Akenine-M&ouml;ller, T. 2001.
Fast 3D triangle-box overlap testing.
<em>Journal of Graphics Tools</em>&nbsp;<em>6</em>&thinsp;(1), 29&ndash;33.
</li>

<li class="bibitem" id="cite:Amanatides87">Amanatides, J., and A.&nbsp;Woo. 1987.
A fast voxel traversal algorithm for ray tracing.
In <em>Proceedings of Eurographics &rsquo;87</em>, 3&ndash;10.
</li>

<li class="bibitem" id="cite:Arnaldi87">Arnaldi, B., T.&nbsp;Priol, and K.&nbsp;Bouatouch. 1987.
A new space subdivision method for ray tracing CSG modeled scenes.
<em>The Visual Computer</em>&nbsp;<em>3</em>&thinsp;(2), 98&ndash;108.
</li>

<li class="bibitem" id="cite:Arvo88">Arvo, J. 1988.
Linear-time voxel walking for octrees.
<em>Ray Tracing News 1</em>&thinsp;(5).
</li>

<li class="bibitem" id="cite:Arvo87">Arvo, J., and D. Kirk. 1987.
Fast ray tracing by ray classification.
<em>Computer Graphics (SIGGRAPH &rsquo;87 Proceedings)</em>&nbsp;<em>21</em>&thinsp;(4), 55&ndash;64.
</li>

<li class="bibitem" id="cite:Bauszat2010">Bauszat, P., M.&nbsp;Eisemann, and M.&nbsp;Magnor. 2010.
The minimal bounding volume hierarchy.
<em>Vision, Modeling, and Visualization (2010)</em>, 227&ndash;34.
</li>

<li class="bibitem" id="cite:Benthin2006">Benthin, C. 2006.
Realtime ray tracing on current CPU architectures.
Ph.D. thesis, Saarland University.
</li>

<li class="bibitem" id="cite:Benthin2018">Benthin, C., I.&nbsp;Wald, S.&nbsp;Woop, and A.&nbsp;T.&nbsp;&Aacute;fra. 2018.
Compressed-leaf bounding volume hierarchies.
<em>Proceedings of High Performance Graphics (HPG &rsquo;18)</em>, 6:1&ndash;4.
</li>

<li class="bibitem" id="cite:Benthin2017">Benthin, C., S.&nbsp;Woop, I.&nbsp;Wald, and A.&nbsp;T.&nbsp;&Aacute;fra. 2017.
Improved two-level BVHs using partial re-braiding.
<em>Proceedings of High Performance Graphics (HPG &rsquo;17)</em>, 7:1&ndash;8.
</li>

<li class="bibitem" id="cite:Binder2016">Binder, N., and A.&nbsp;Keller. 2016.
Efficient stackless hierarchy traversal on GPUs with backtracking in constant time.
<em>Proceedings of High Performance Graphics</em>, 41&ndash;50.
</li>

<li class="bibitem" id="cite:Bittner2013">Bittner, J., M.&nbsp;Hapala, and V.&nbsp;Havran. 2013.
Fast insertion-based optimization of bounding volume hierarchies.
<em>Computer Graphics Forum</em>&nbsp;<em>32</em>&thinsp;(1), 85&ndash;100.
</li>

<li class="bibitem" id="cite:Bittner2014">Bittner, J., M.&nbsp;Hapala, and V.&nbsp;Havran. 2014.
Incremental BVH construction for ray tracing.
<em>Computers &amp; Graphics</em>&nbsp;<em>47</em>, 135&ndash;44.
</li>

<li class="bibitem" id="cite:Boulos2006">Boulos, S., and E.&nbsp;Haines. 2006.
Ray&ndash;box sorting.
<em>Ray Tracing News</em>&nbsp;<em>19</em>&thinsp;(1),
<a href="http://www.realtimerendering.com/resources/RTNews/html/rtnv19n1.html">www.realtimerendering.com/resources/RTNews/html/rtnv19n1.html</a>.
</li>

<li class="bibitem" id="cite:Budge2008">Budge, B., D.&nbsp;Coming, D.&nbsp;Norpchen, and K.&nbsp;Joy. 2008.
Accelerated building and ray tracing of restricted BSP trees.
<em>2008 IEEE Symposium on Interactive Ray Tracing</em>, 167&ndash;74.
</li>

<li class="bibitem" id="cite:Cazals95">Cazals, F., G.&nbsp;Drettakis, and C.&nbsp;Puech. 1995.
Filtering, clustering and hierarchy construction: A new solution for
  ray-tracing complex scenes.
<em>Computer Graphics Forum</em>&nbsp;<em>14</em>&thinsp;(3), 371&ndash;82.
</li>

<li class="bibitem" id="cite:Choi2013">Choi, B., B.&nbsp;Chang, and I.&nbsp;Ihm. 2013.
Improving memory space efficiency of kd-tree for real-time ray tracing.
<em>Computer Graphics Forum</em>&nbsp;<em>32</em>&thinsp;(7), 335&ndash;44.
</li>

<li class="bibitem" id="cite:Choi2010">Choi, B., R.&nbsp;Komuravelli, V.&nbsp;Lu, H.&nbsp;Sung, R.&nbsp;L.&nbsp;Bocchino,
S.&nbsp;V.&nbsp;Adve, and J.&nbsp;C.&nbsp;Hart. 2010.
Parallel SAH k-D tree construction.
In <em>Proceedings of High Performance Graphics 2010</em>, 77&ndash;86.
</li>

<li class="bibitem" id="cite:Clark76">Clark, J.&nbsp;H. 1976.
Hierarchical geometric models for visible surface algorithms.
<em>Communications of the ACM</em>&nbsp;<em>19</em>&thinsp;(10), 547&ndash;54.
</li>

<li class="bibitem" id="cite:Cleary:1988:AOA">Cleary, J.&nbsp;G., and G.&nbsp;Wyvill. 1988.
Analysis of an algorithm for fast ray tracing using uniform space
  subdivision.
<em>The Visual Computer</em>&nbsp;<em>4</em>&thinsp;(2), 65&ndash;83.
</li>

<li class="bibitem" id="cite:Cline2006">Cline, D., P.&nbsp;Egbert, J.&nbsp;Talbot, and D.&nbsp;Cardon. 2006.
Two stage importance sampling for direct lighting.
<em>Rendering Techniques 2006: 17th Eurographics Workshop on Rendering</em>,
103&ndash;14.
</li>

<li class="bibitem" id="cite:Dammertz2008a">Dammertz, H., and A.&nbsp;Keller. 2008a.
The edge volume heuristic&mdash;robust triangle subdivision for improved BVH
performance. In
<em>IEEE Symposium on Interactive Ray Tracing</em>, 155&ndash;58.
</li>

<li class="bibitem" id="cite:Eisemann2007">Eisemann, M., M.&nbsp;Magnor, T.&nbsp;Grosch, and S.&nbsp;M&uuml;ller. 2007.
Fast ray/axis-aligned bounding box overlap tests using ray slopes.
<em>Journal of Graphics, GPU, and Game Tools</em>&nbsp;<em>12</em>&thinsp;(4), 35&ndash;46.
</li>

<li class="bibitem" id="cite:Enderton2010">Enderton, E., E.&nbsp;Sintorn, P.&nbsp;Shirley, and D.&nbsp;Luebke. 2010.
Stochastic transparency.
<em>Proceedings of the 2010 ACM SIGGRAPH Symposium on Interactive 3D
Graphics and Games (I3D &rsquo;10)</em>, 157&ndash;64.
</li>

<li class="bibitem" id="cite:Ericson04">Ericson, C. 2004.
<em>Real-Time Collision Detection</em>.
 Morgan Kaufmann Series in Interactive 3D Technology.
San Francisco: Morgan Kaufmann.
</li>

<li class="bibitem" id="cite:Ernst2007">Ernst, M., and G.&nbsp;Greiner. 2007.
Early split clipping for bounding volume hierarchies.
<em>IEEE Symposium on Interactive Ray Tracing</em>, 73&ndash;78.
</li>

<li class="bibitem" id="cite:Fabianowski2009">Fabianowski, B., C.&nbsp;Fowler, and J.&nbsp;Dingliana.  2009.
A cost metric for scene-interior ray origins.
<em>Short Paper Proceedings of the 30th Annual Conference of the European
Association for Computer Graphics  (Eurographics 2009)</em>, 49&ndash;50.
</li>

<li class="bibitem" id="cite:Foley2005">Foley, T., and J.&nbsp;Sugerman. 2005.
KD-tree acceleration structures for a GPU raytracer.
<em>Proceedings of the ACM SIGGRAPH/EUROGRAPHICS Conference
on Graphics Hardware</em>, 15&ndash;22.
</li>

<li class="bibitem" id="cite:Fujimoto86">Fujimoto, A., T.&nbsp;Tanaka, and K.&nbsp;Iwata. 1986.
Arts: Accelerated ray-tracing system.
<em>IEEE Computer Graphics and Applications</em>&nbsp;<em>6</em>&thinsp;(4), 16&ndash;26.
</li>

<li class="bibitem" id="cite:Gunther2007">G&uuml;nther, J., S.&nbsp;Popov, H.&nbsp;P. Seidel, and P.&nbsp;Slusallek.  2007.
Realtime ray tracing on GPU with BVH-based packet traversal.
<em>IEEE Symposium on Interactive Ray Tracing</em>, 113&ndash;18.
</li>

<li class="bibitem" id="cite:Ganestam2016">Ganestam, P., and M.&nbsp;Doggett. 2016.
SAH guided spatial split partitioning for fast BVH construction.
<em>Computer Graphics Forum</em>&nbsp;<em>35</em>&thinsp;(2), 285&ndash;93.
</li>

<li class="bibitem" id="cite:Garanzha2009">Garanzha, K. 2009.
The use of precomputed triangle clusters for accelerated ray tracing in dynamic scenes.
<em>Computer Graphics Forum (Proceedings of the 2009 Eurographics
Symposium on Rendering)</em>&nbsp;<em>28</em>&thinsp;(4), 1199&ndash;206.
</li>

<li class="bibitem" id="cite:Garanzha2011">Garanzha, K., J.&nbsp;Pantaleoni, D.&nbsp;McAllister. 2011.
Simpler and faster HLBVH with work queues. 
<em>Proceedings of High Performance Graphics 2011</em>, 59&ndash;64.
</li>

<li class="bibitem" id="cite:Glassner:IntroRayTracing">Glassner, A. (ed.) 1989a.
<em>An Introduction to Ray Tracing</em>. San Diego:
Academic Press.
</li>

<li class="bibitem" id="cite:Glassner84">Glassner, A. 1984.
Space subdivision for fast ray tracing.
<em>IEEE Computer Graphics and Applications</em>&nbsp;<em>4</em>&thinsp;(10),
15&ndash;22.
</li>

<li class="bibitem" id="cite:Glassner1988">Glassner, A. 1988.
Spacetime ray tracing for animation.
<em>IEEE Computer Graphics &amp; Applications</em>&nbsp;<em>8</em>&thinsp;(2), 60&ndash;70.
</li>

<li class="bibitem" id="cite:Goldsmith87">Goldsmith, J., and J.&nbsp;Salmon. 1987.
Automatic creation of object hierarchies for ray tracing.
<em>IEEE Computer Graphics and Applications</em>&nbsp;<em>7</em>&thinsp;(5), 14&ndash;20.
</li>

<li class="bibitem" id="cite:Grunschloss2011">Gr&uuml;nschlo&szlig;, L., M.&nbsp;Stich, S.&nbsp;Nawaz, and A.&nbsp;Keller. 2011.
MSBVH: An efficient acceleration data structure for ray traced motion blur.
<em>Proceedings of High Performance Graphics 2011</em>, 65&ndash;70.
</li>

<li class="bibitem" id="cite:Gu2015">Gu, Y., Y.&nbsp;He, and G.&nbsp;E.&nbsp;Blelloch. 2015.
Ray specialized contraction on bounding volume hierarchies.
<em>Computer Graphics Forum</em>&nbsp;<em>34</em>&thinsp;(7), 309&ndash;18.
</li>

<li class="bibitem" id="cite:Gu2013b">Gu, Y., Y.&nbsp;He, K.&nbsp;Fatahalian, and G.&nbsp;Blelloch. 2013b.
Efficient BVH construction via approximate agglomerative clustering.
<em>Proceedings of High Performance Graphics 2013</em>, 81&ndash;88.
</li>

<li class="bibitem" id="cite:Havran2000">Havran, V. 2000.
Heuristic ray shooting algorithms.
Ph.D. thesis, Czech Technical University.
</li>

<li class="bibitem" id="cite:Havran02">Havran, V., and J.&nbsp;Bittner. 2002.
On improving kd-trees for ray shooting.
In <em>Proceedings of WSCG 2002 Conference</em>, 209&ndash;17.
</li>

<li class="bibitem" id="cite:Havran06">Havran, V., R.&nbsp;Herzog, and H.-P.&nbsp;Seidel. 2006.
On the fast construction of spatial hierarchies for ray tracing.
In <em>IEEE Symposium on Interactive Ray Tracing</em>, 71&ndash;80.
</li>

<li class="bibitem" id="cite:Hendrich2019">Hendrich, J., A.&nbsp;Posp&iacute;<span>&#353;</span>il, D.&nbsp;Meister, and J.&nbsp;Bittner. 2019.
Ray classification for accelerated BVH traversal.
<em>Computer Graphics Forum</em>&nbsp;<em>38</em>&thinsp;(4), 49&ndash;56.
</li>

<li class="bibitem" id="cite:Hendrich2017">Hendrich, J., D.&nbsp;Meister, and J.&nbsp;Bittner. 2017.
Parallel BVH construction using progressive hierarchical refinement.
<em>Computer Graphics Forum</em>&nbsp;<em>36</em>&thinsp;(2), 487&ndash;94.
</li>

<li class="bibitem" id="cite:Hunt2008">Hunt, W.  2008.
Corrections to the surface area metric with respect to mail-boxing.
In <em>IEEE Symposium on Interactive Ray Tracing</em>, 77&ndash;80.
</li>

<li class="bibitem" id="cite:Hunt08a">Hunt, W., and B.&nbsp;Mark. 2008a.
Ray-specialized acceleration structures for ray tracing.
In <em>IEEE Symposium on Interactive Ray Tracing</em>, 3&ndash;10.
</li>

<li class="bibitem" id="cite:Hunt08b">Hunt, W., and B.&nbsp;Mark. 2008b.
Adaptive acceleration structures in perspective space.
In <em>IEEE Symposium on Interactive Ray Tracing</em>, 111&ndash;17.
</li>

<li class="bibitem" id="cite:Hunt2006">Hunt, W., W.&nbsp;Mark, and G.&nbsp;Stoll. 2006.
Fast kd-tree construction with an adaptive error-bounded heuristic.
In <em>IEEE Symposium on Interactive Ray Tracing</em>, 81&ndash;88.
</li>

<li class="bibitem" id="cite:Hurley02">Hurley, J., A.&nbsp;Kapustin, A.&nbsp;Reshetov, and A.&nbsp;Soupikov. 2002.
Fast ray tracing for modern general purpose CPU.
In <em>Proceedings of GraphiCon 2002</em>.
</li>

<li class="bibitem" id="cite:Ize2013">Ize, T. 2013.
Robust BVH ray traversal.
<em>Journal of Computer Graphics Techniques (JCGT)</em>&nbsp;<em>2</em>&thinsp;(2), 12&ndash;27.
</li>

<li class="bibitem" id="cite:Ize2011">Ize, T., and C.&nbsp;Hansen. 2011.
RTSAH traversal order for occlusion rays.
<em>Computer Graphics Forum (Proceedings of Eurographics 2011)</em>&nbsp;<em>30</em>&thinsp;(2),
295&ndash;305.
</li>

<li class="bibitem" id="cite:Ize08">Ize, T., I.&nbsp;Wald, and S.&nbsp;Parker. 2008.
Ray tracing with the BSP tree.
In <em>IEEE Symposium on Interactive Ray Tracing</em>, 159&ndash;66.
</li>

<li class="bibitem" id="cite:Ize2006">Ize, T., I.&nbsp;Wald, C.&nbsp;Robertson, and S.&nbsp;G.&nbsp;Parker. 2006.
An evaluation of parallel grid construction for ray tracing dynamic scenes.
<em>IEEE Symposium on Interactive Ray Tracing</em>, 47&ndash;55.
</li>

<li class="bibitem" id="cite:Ize07">Ize, T., P.&nbsp;Shirley, and S.&nbsp;Parker.  2007.
Grid creation strategies for efficient ray tracing.
 In <em>IEEE Symposium on Interactive Ray Tracing</em>, 27&ndash;32.
</li>

<li class="bibitem" id="cite:Jansen86">Jansen, F.&nbsp;W. 1986.
Data structures for ray tracing.
In <em>Data Structures for Raster Graphics, Workshop Proceedings</em>, 57&ndash;73.
New York:  Springer-Verlag.
</li>

<li class="bibitem" id="cite:Jevans89">Jevans, D., and B.&nbsp;Wyvill. 1989.
Adaptive voxel subdivision for ray tracing.
In <em>Proceedings of Graphics Interface 1989</em>, 164&ndash;72.
</li>

<li class="bibitem" id="cite:Kammaje07">Kammaje, R., and B.&nbsp;Mora. 2007.
A study of restricted BSP trees for ray tracing. 
In <em>IEEE Symposium on Interactive Ray Tracing</em>, 55&ndash;62.
</li>

<li class="bibitem" id="cite:Kaplan85">Kaplan, M.&nbsp;R. 1985.
The uses of spatial coherence in ray tracing.
In <em>ACM SIGGRAPH Course Notes 11</em>.
</li>

<li class="bibitem" id="cite:Karras2013">Karras, T., and T.&nbsp;Aila. 2013.
Fast parallel construction of high-quality bounding volume hierarchies.
In <em>Proceedings of High Performance Graphics 2013</em>, 89&ndash;99.
</li>

<li class="bibitem" id="cite:Kay86">Kay, T., and J.&nbsp;Kajiya. 1986.
Ray tracing complex scenes.
In <em>Computer Graphics (SIGGRAPH &rsquo;86 Proceedings)</em>, Volume&nbsp;20,
  269&ndash;78.
</li>

<li class="bibitem" id="cite:Kensler08">Kensler, A. 2008.
Tree rotations for improving bounding volume hierarchies.
In <em>IEEE Symposium on Interactive Ray Tracing</em>, 73&ndash;76.
</li>

<li class="bibitem" id="cite:Kirk88">Kirk, D., and J.&nbsp;Arvo. 1988.
The ray tracing kernel.
In <em>Proceedings of Ausgraph &rsquo;88</em>, 75&ndash;82.
</li>

<li class="bibitem" id="cite:Klimaszewski97">Klimaszewski, K.&nbsp;S., and T.&nbsp;W. Sederberg. 1997.
Faster ray tracing using adaptive grids.
<em>IEEE Computer Graphics and Applications</em>&nbsp;<em>17</em>&thinsp;(1),
  42&ndash;51.
</li>

<li class="bibitem" id="cite:Kopta2012">Kopta, D., T.&nbsp;Ize, J.&nbsp;Spjut, E.&nbsp;Brunvand, A.&nbsp;Davis, and A.&nbsp;Kensler. 2012.
Fast, effective BVH updates for animated scenes.
In <em>Proceedings of the ACM SIGGRAPH Symposium on Interactive 3D Graphics and Games</em>,
197&ndash;204.
</li>

<li class="bibitem" id="cite:Lacewell08">Lacewell, D., B.&nbsp;Burley, S.&nbsp;Boulos, and P.&nbsp;Shirley. 2008.
Raytracing prefiltered occlusion for aggregate geometry.
In <em>IEEE Symposium on Interactive Ray Tracing</em>, 19&ndash;26.
</li>

<li class="bibitem" id="cite:Lagae08a">Lagae, A., and P.&nbsp;Dutr&eacute;.  2008a.
Compact, fast, and robust grids for ray tracing.
<em>Computer Graphics Forum (Proceedings of the 2008 Eurographics Symposium on
Rendering)</em>&nbsp;<em>27</em>&thinsp;(4), 1235&ndash;44.
</li>

<li class="bibitem" id="cite:Lagae08b">Lagae, A., and P.&nbsp;Dutr&eacute;.  2008b.
Accelerating ray tracing using constrained tetrahedralizations.
<em>Computer Graphics Forum (Proceedings of the 2008 Eurographics Symposium on
Rendering)</em>&nbsp;<em>27</em>&thinsp;(4), 1303&ndash;12.
</li>

<li class="bibitem" id="cite:Laine2010">Laine, S. 2010.
Restart trail for stackless BVH traversal. 
In <em>Proceedings of High Performance Graphics 2010</em>, 107&ndash;11.
</li>

<li class="bibitem" id="cite:Lauterbach09">Lauterbach, C., M.&nbsp;Garland, S.&nbsp;Sengupta, D.&nbsp;Luebke, and D.&nbsp;Manocha. 2009.
Fast BVH construction on GPUs.
<em>Computer Graphics Forum (Eurographics 2009 Conference
  Proceedings)</em>&nbsp;<em>28</em>&thinsp;(2), 422&ndash;30.
</li>

<li class="bibitem" id="cite:Lauterbach2006">Lauterbach, C., S.-E.&nbsp;Yoon, D.&nbsp;Tuft, and D.&nbsp;Manocha. 2006.
RT-DEFORM: Interactive ray tracing of dynamic scenes using BVHs.
<em>IEEE Symposium on Interactive Ray Tracing</em>, 39&ndash;46.
</li>

<li class="bibitem" id="cite:Lier2018">Lier, A., M.&nbsp;Martinek, M.&nbsp;Stamminger, and K.&nbsp;Selgrad. 2018a.
A high-resolution compression scheme for ray tracing subdivision surfaces with displacement.
<em>Proceedings of the ACM on Computer Graphics and Interactive
Techniques</em>&nbsp;<em>1</em>&thinsp;(2), 33:1&ndash;17.
</li>

<li class="bibitem" id="cite:Liktor2016">Liktor, G., and K.&nbsp;Vaidyanathan. 2016.
Bandwidth-efficient BVH layout for incremental hardware traversal.
<em>Proceedings of High Performance Graphics (HPG &rsquo;16)</em>, 51&ndash;61.
</li>

<li class="bibitem" id="cite:Lin2019">Lin, D., K.&nbsp;Shkurko, I.&nbsp;Mallett, and C.&nbsp;Yuksel. 2019.
Dual-split trees.
<em>Symposium on Interactive 3D Graphics and Games (I3D 2019)</em>, 3:1&ndash;9.
</li>

<li class="bibitem" id="cite:Muller1999">M&uuml;ller, G., and D.&nbsp;W.&nbsp;Fellner. 1999.
Hybrid scene structuring with application to ray tracing.
<em>Proceedings of the International Conference on Visual Computing (ICVC &rsquo;99)</em>, 19&ndash;26.
</li>

<li class="bibitem" id="cite:MacDonald90">MacDonald, J.&nbsp;D., and K.&nbsp;S. Booth. 1990.
Heuristics for ray tracing using space subdivision.
<em>The Visual Computer</em>&nbsp;<em>6</em>&thinsp;(3), 153&ndash;66.
</li>

<li class="bibitem" id="cite:Masso2003">Mass&oacute;, J.&nbsp;P.&nbsp;M., and P.&nbsp;G.&nbsp;L&oacute;pez. 2003
Automatic hybrid hierarchy creation: A cost-model based approach.
<em>Computer Graphics Forum</em>&nbsp;<em>22</em>&thinsp;(1), 5&ndash;13.
</li>

<li class="bibitem" id="cite:Meister2018b">Meister, D., and J.&nbsp;Bittner, 2018b.
Parallel locally-ordered clustering for bounding volume hierarchy
construction.
<em>IEEE Transactions on Visualization and Computer
Graphics</em>&nbsp;<em>24</em>&thinsp;(3), 1345&ndash;53.
</li>

<li class="bibitem" id="cite:Meister2018a">Meister, D., and J.&nbsp;Bittner. 2018a.
Parallel reinsertion for bounding volume hierarchy optimization.
<em>Computer Graphics Forum</em>&nbsp;<em>37</em>&thinsp;(2), 463&ndash;73.
</li>

<li class="bibitem" id="cite:Meister2021">Meister, D., S.&nbsp;Ogaki, C.&nbsp;Benthin, M.&nbsp;J.&nbsp;Doyle, M.&nbsp;Guthe, and J.&nbsp;Bittner. 2021.
A survey on bounding volume hierarchies for ray tracing.
<em>Computer Graphics Forum (Eurographics State of the Art Report)</em>&nbsp;<em>40</em>&thinsp;(2): 683&ndash;712.
</li>

<li class="bibitem" id="cite:Morton1966">Morton, G.&nbsp;M. 1966.
A computer oriented geodetic data base and a new technique in file
sequencing.
<em>IBM Technical Report</em>.
</li>

<li class="bibitem" id="cite:Moulin2015">Moulin, M., N.&nbsp;Billen, and P.&nbsp;Dutr&eacute;. 2015.
Efficient visibility heuristics for kd-trees using the RTSAH.
<em>Eurographics Symposium on Rendering&ndash;Experimental Ideas &amp;
Implementations</em>, 31&ndash;39.
</li>

<li class="bibitem" id="cite:Naylor93">Naylor, B. 1993.
Constructing good partition trees.
In <em>Proceedings of Graphics Interface 1993</em>, 181&ndash;91.
</li>

<li class="bibitem" id="cite:Ooi87">Ooi, B.&nbsp;C., K.&nbsp;McDonell, and R.&nbsp;Sacks-Davis. 1987.
Spatial kd-tree: A data structure for geographic databases.
In <em>Proceedings of the IEEE COMPSAC Conference</em>.
</li>

<li class="bibitem" id="cite:Pantaleoni2010a">Pantaleoni, J., and D.&nbsp;Luebke. 2010.
HLBVH: Hierarchical LBVH construction for real-time ray tracing of dynamic geometry. 
In <em>Proceedings of the Conference on High Performance Graphics 2010</em>, 87&ndash;95.
</li>

<li class="bibitem" id="cite:Popov06">Popov, S., J.&nbsp;Gunther, H.&nbsp;P. Seidel, and P.&nbsp;Slusallek.  2006.
Experiences with streaming construction of SAH kd-trees.
In <em>IEEE Symposium on Interactive Ray Tracing</em>, 89&ndash;94.
</li>

<li class="bibitem" id="cite:Popov2009">Popov, S., R.&nbsp;Dimov, I.&nbsp;Georgiev, and P.&nbsp;Slusallek. 2009.
Object partitioning considered harmful: Space subdivision for BVHs.
In <em>Proceedings of High Performance Graphics 2009</em>, 15&ndash;22.
</li>

<li class="bibitem" id="cite:Rubin80">Rubin, S.&nbsp;M., and T.&nbsp;Whitted. 1980.
A 3-dimensional representation for fast rendering of complex scenes.
<em>Computer Graphics</em>&nbsp;<em>14</em>&thinsp;(3), 110&ndash;16.
</li>

<li class="bibitem" id="cite:Segovia2010">Segovia, B., and M.&nbsp;Ernst. 2010.
Memory efficient ray tracing with hierarchical mesh quantization.
In <em>Proceedings of Graphics Interface 2010</em>, 153&ndash;60.
</li>

<li class="bibitem" id="cite:Selgrad2017">Selgrad, K., A.&nbsp;Lier, M.&nbsp;Martinek, C.&nbsp;Buchenau, M.&nbsp;Guthe, F.&nbsp;Kranz, H.&nbsp;Sch&auml;fer, and M.&nbsp;Stamminger. 2017.
A compressed representation for ray tracing parametric surfaces.
<em>ACM Transactions on Graphics</em>&nbsp;<em>36</em>&thinsp;(1), 5:1&ndash;13.
</li>

<li class="bibitem" id="cite:Shevtsov07a">Shevtsov, M., A.&nbsp;Soupikov, and A.&nbsp;Kapustin.  2007a.
Ray&ndash;triangle intersection algorithm for modern CPU architectures.
In <em>Proceedings of GraphiCon 2007,</em> 33&ndash;39.
</li>

<li class="bibitem" id="cite:Shevtsov07b">Shevtsov, M., A.&nbsp;Soupikov, and A.&nbsp;Kapustin.  2007b.
Highly parallel fast kd-tree construction for interactive ray tracing of
dynamic scenes.
In <em>Computer Graphics Forum (Proceedings of Eurographics
2007)</em>&nbsp;<em>26</em>&thinsp;(3),  395&ndash;404.
</li>

<li class="bibitem" id="cite:Snyder87">Snyder, J.&nbsp;M., and A.&nbsp;H. Barr. 1987.
Ray tracing complex models containing surface tessellations.
<em>Computer Graphics (SIGGRAPH &rsquo;87 Proceedings)</em>, Volume&nbsp;21, 119&ndash;28.
</li>

<li class="bibitem" id="cite:Soupikov08">Soupikov, A., M.&nbsp;Shevtsov, and A.&nbsp;Kapustin.  2008.
Improving kd-tree quality at a reasonable construction cost. 
In <em>IEEE Symposium on Interactive Ray Tracing</em>, 67&ndash;72.
</li>

<li class="bibitem" id="cite:Stich2009">Stich, M., H.&nbsp;Friedrich, and A.&nbsp;Dietrich. 2009.
Spatial splits in bounding volume hierarchies.
In <em>Proceedings of High Performance Graphics 2009</em>, 7&ndash;14.
</li>

<li class="bibitem" id="cite:Sung92">Sung, K., and P.&nbsp;Shirley. 1992.
Ray tracing with the BSP tree.
In D.&nbsp;Kirk (ed.), <em>Graphics Gems III</em>, 271&ndash;74. San Diego: Academic
  Press.
</li>

<li class="bibitem" id="cite:Vaidyanathan2019">Vaidyanathan, K., C.&nbsp;Benthin, and S.&nbsp;Woop. 2019.
Wide BVH traversal with a short stack.
<em>High Performance Graphics (HPG &rsquo;19)</em>, 15&ndash;19.
</li>

<li class="bibitem" id="cite:Vaidyanathan2016">Vaidyanathan, K., T.&nbsp;Akenine-M&ouml;ller, and M.&nbsp;Salvi. 2016.
Watertight ray traversal with reduced precision.
<em>High Performance Graphics (HPG &rsquo;16)</em>, 33&ndash;40.
</li>

<li class="bibitem" id="cite:Vinkler2017">Vinkler, M., J.&nbsp;Bittner, and V.&nbsp;Havran. 2017.
Extended Morton codes for high-performance bounding volume hierarchy
construction.
<em>High Performance Graphics (HPG &rsquo;17)</em>, 9:1&ndash;8.
</li>

<li class="bibitem" id="cite:Vinkler2012">Vinkler, M., V.&nbsp;Havran, and J.&nbsp;Sochora. 2012.
Visibility driven BVH build up algorithm for ray tracing.
<em>Computers &amp; Graphics</em>&nbsp;<em>36</em>&thinsp;(4), 283&ndash;96.
</li>

<li class="bibitem" id="cite:Wachter2006">W&auml;chter, C.&nbsp;A., and A.&nbsp;Keller. 2006.
Instant ray tracing: The bounding interval hierarchy.
In <em>Rendering Techniques 2006: 17th Eurographics Workshop on
  Rendering</em>, 139&ndash;49.
</li>

<li class="bibitem" id="cite:Wald07">Wald, I. 2007.
On fast construction of SAH-based bounding volume hierarchies. 
In <em>IEEE Symposium on Interactive Ray Tracing</em>, 33&ndash;40.
</li>

<li class="bibitem" id="cite:Wald2012">Wald, I. 2012.
Fast construction of SAH BVHs on the Intel Many Integrated Core (MIC) architecture.
<em>IEEE Transactions on Visualization and Computer
Graphics</em>&nbsp;<em>18</em>&thinsp;(1), 47&ndash;57.
</li>

<li class="bibitem" id="cite:Wald06">Wald, I., and V.&nbsp;Havran. 2006.
On building fast kd-trees for ray tracing and on doing that in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.118ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4356.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper O left-parenthesis n log n right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D442" d="M740 436c0 -239 -223 -458 -435 -458c-144 0 -256 101 -256 267c0 233 220 460 436 460c149 0 255 -108 255 -269zM651 475c0 149 -90 205 -172 205c-79 0 -177 -52 -246 -156c-77 -117 -91 -263 -91 -307c0 -132 70 -213 169 -213c84 0 166 59 214 120 c99 123 126 279 126 351Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6C" d="M255 0l-111 3l-111 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-618c0 -45 11 -45 78 -45v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-67" d="M485 404c0 -23 -19 -30 -29 -30c-16 0 -29 12 -29 29c0 12 5 23 16 27c-3 1 -10 1 -10 1c-18 0 -54 -5 -90 -39c25 -23 41 -60 41 -97c0 -77 -69 -146 -162 -146c-19 0 -60 3 -99 31c-17 -20 -17 -43 -17 -47c0 -32 21 -63 53 -67c7 -1 50 -1 75 -1c61 0 119 0 172 -28 c51 -28 65 -79 65 -114c0 -78 -104 -129 -222 -129c-122 0 -221 55 -221 127c0 40 32 83 92 100c-31 20 -44 58 -44 89c0 35 18 68 31 83c-25 21 -47 59 -47 103c0 77 69 146 162 146c22 0 64 -3 106 -36c42 41 86 47 106 47c39 0 51 -32 51 -49zM309 296 c0 23 0 123 -87 123c-40 0 -63 -28 -71 -40c-15 -25 -16 -57 -16 -84c0 -23 0 -123 87 -123c40 0 63 28 71 40c15 25 16 57 16 84zM419 -79c0 86 -112 86 -198 86h-59c-44 -3 -82 -40 -82 -86c0 -53 69 -104 170 -104c98 0 169 50 169 104Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D442" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="763" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="1153" y="0"></use>
<g transform="translate(1920,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6C"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-67" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="3366" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3966" y="0"></use>
</g>
</svg>. 
In <em>IEEE Symposium on Interactive Ray Tracing</em>, 61&ndash;69.
</li>

<li class="bibitem" id="cite:Wald07a">Wald, I., S.&nbsp;Boulos, and P.&nbsp;Shirley. 2007a.
Ray tracing deformable scenes using dynamic bounding volume hierarchies.
<em>ACM Transactions on Graphics</em>&nbsp;<em>26</em>&thinsp;(1), 6.
</li>

<li class="bibitem" id="cite:Wald2007b">Wald, I., W.&nbsp;Mark, J.&nbsp;G&uuml;nther, S.&nbsp;Boulos, T.&nbsp;Ize, W.&nbsp;Hunt, S.&nbsp;Parker,
and P.&nbsp;Shirley. 2007b.
State of the art in ray tracing animated scenes.
In <em>Eurographics 2007 State of the Art Reports</em>.
</li>

<li class="bibitem" id="cite:Walter08">Walter, B., K.&nbsp;Bala, M.&nbsp;Kilkarni, and K.&nbsp;Pingali.  2008.
Fast agglomerative clustering for rendering.  
In <em>IEEE Symposium on Interactive Ray Tracing</em>, 81&ndash;86.
</li>

<li class="bibitem" id="cite:Weghorst84">Weghorst, H., G.&nbsp;Hooper, and D.&nbsp;P. Greenberg. 1984.
Improved computational methods for ray tracing.
<em>ACM Transactions on Graphics</em>&nbsp;<em>3</em>&thinsp;(1), 52&ndash;69.
</li>

<li class="bibitem" id="cite:Williams05">Williams, A., S.&nbsp;Barrus, R.&nbsp;K. Morley, and P.&nbsp;Shirley. 2005.
An efficient and robust ray&ndash;box intersection algorithm.
<em>Journal of Graphics, GPU, and Game Tools</em>&nbsp;<em>10</em>&thinsp;(4), 49&ndash;54.
</li>

<li class="bibitem" id="cite:Wodniok2016">Wodniok, D., and M.&nbsp;Goesele. 2016.
Recursive SAH-based bounding volume hierarchy construction.
<em>Proceedings of Graphics Interface (GI &rsquo;16)</em>, 101&ndash;7.
</li>

<li class="bibitem" id="cite:Woop2017">Woop, S., A.&nbsp;T.&nbsp;&Aacute;fra, and C.&nbsp;Benthin. 2017.
STBVH: A spatial-temporal BVH for efficient multi-segment motion blur.
<em>Proceedings of High Performance Graphics (HPG &rsquo;17)</em>, 8:1&ndash;8.
</li>

<li class="bibitem" id="cite:Woop2013">Woop, S., C.&nbsp;Benthin, and I.&nbsp;Wald. 2013.
Watertight ray/triangle intersection.
<em>Journal of Computer Graphics Techniques (JCGT)</em>&nbsp;<em>2</em>&thinsp;(1), 
65&ndash;82.
</li>

<li class="bibitem" id="cite:Woop2014">Woop, S., C.&nbsp;Benthin, I.&nbsp;Wald, G.&nbsp;S.&nbsp;Johnson, and E.&nbsp;Tabellion. 2014.
Exploiting local orientation similarity for efficient ray traversal of hair
and fur. 
In <em>Proceedings of High Performance Graphics 2014</em>, 41&ndash;49.
</li>

<li class="bibitem" id="cite:Woop06">Woop, S., G.&nbsp;Marmitt, and P.&nbsp;Slusallek. 2006.
B-kd trees for hardware accelerated ray tracing of dynamic scenes.
In <em>Graphics Hardware 2006: Eurographics Symposium Proceedings</em>, 67&ndash;76.
</li>

<li class="bibitem" id="cite:Wyman2017">Wyman, C., and M.&nbsp;McGuire. 2017.
Hashed alpha testing.
<em>Proceedings of the 21st ACM SIGGRAPH Symposium on Interactive 3D
Graphics and Games (I3D &rsquo;17)</em>.
</li>

<li class="bibitem" id="cite:Ylitie2017">Ylitie, H., T.&nbsp;Karras, and S.&nbsp;Laine. 2017.
Efficient incoherent ray traversal on GPUs through compressed wide BVHs.
<em>High Performance Graphics (HPG &rsquo;17)</em>, 4:1&ndash;13.
</li>

<li class="bibitem" id="cite:Yoon06b">Yoon, S.-E., and D.&nbsp;Manocha. 2006.
Cache-efficient layouts of bounding volume hierarchies.
In <em>Computer Graphics Forum: Proceedings of Eurographics
2006</em>&nbsp;<em>25</em>&thinsp;(3), 507&ndash;16.
</li>

<li class="bibitem" id="cite:Yoon2007">Yoon, S.-E., S.&nbsp;Curtis, and D.&nbsp;Manocha. 2007.
Ray tracing dynamic scenes using selective restructuring.
In <em>Proceedings of the Eurographics Symposium on Rendering</em>, 73&ndash;84.
</li>

<li class="bibitem" id="cite:Zachmann02">Zachmann, G.  2002.
Minimal hierarchical collision detection.
In <em>Proceedings of the ACM Symposium on Virtual Reality Software and
Technology</em>, 121&ndash;28.
</li>

<li class="bibitem" id="cite:Zuniga06">Zuniga, M., and J.&nbsp;Uhlmann.  2006.
Ray queries with wide object isolation and the S-tree.
<em>Journal of Graphics, GPU, and Game Tools</em>&nbsp;<em>11</em>&thinsp;(3), 27&ndash;45.
</li>

</ol>
<p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md bg-light navbar-light">
<div class="container-fluid">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>,<br>
<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">&copy; 2004-2023</a> Matt Pharr, Wenzel Jakob, and Greg Humphreys.
<a href="https://github.com/mmp/pbr-book-website/"><span class="fab fa-github"></span></a><br>
Purchase a printed copy: <a href="https://www.amazon.com/Physically-Based-Rendering-fourth-Implementation/dp/0262048027?keywords=physically+based+rendering+4th+edition&qid=1671730412&sprefix=physically+based%!C(MISSING)aps%!C(MISSING)145&sr=8-1&linkCode=ll1&tag=pharr-20&linkId=81a816d90f0c7e872617f1f930a51fd6&language=en_US&ref_=as_li_ss_tl"><span class="fab fa-amazon"></span></a>
<a href="https://mitpress.mit.edu/9780262048026/physically-based-rendering/"><img src="/mitpress.png" width=10 height=16></a>
</span>
</div>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Primitives_and_Intersection_Acceleration/Exercises.html">Primitives and Intersection Acceleration / Exercises</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
